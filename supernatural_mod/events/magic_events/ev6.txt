namespace = magic_ev6

#Meet Belial again
magic_ev6.1 = {
	title = belial_name
	desc = ev6.1.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		outfit_tags = { military_outfit }
	}

	trigger = {
		is_alive = yes
	}

	option = {
		name = ev6.1.0.a
		trigger_event = magic_ev.22
	}
	option = {
		name = ev6.1.0.b
		trigger_event = magic_ev.24
	}
}

#Meet Lilith again
magic_ev6.2 = {
	title = ev39.0.title
	desc = ev6.2.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	

	trigger = {
		is_alive = yes
	}
	immediate = {
		save_scope_as = this0
		save_scope_as = owner
		scope:demon = {
			save_scope_as = target
		}
	}

	option = {
		name = ev6.2.0.a
		if = {
			limit = {
				OR = {
					AND = {
						is_male = no
						has_sexuality = heterosexual
					}
					AND = {
						is_male = yes
						has_sexuality = homosexual
					}
				}
			}
			set_sexuality = bisexual
		}
		had_sex_with_effect = {
				CHARACTER = scope:target
				PREGNANCY_CHANCE = seduce_pregnancy_chance
		}
		if = {
			limit = {
				NOT = {
					has_character_modifier = joy_with_lilith_modifier
				}
			}
			add_character_modifier = joy_with_lilith_modifier
		}
		set_relation_lover = scope:target
		trigger_event = {
			id = magic_ev.45
			days = { 10 20 }
		}
	}
	option = {
		name = ev6.2.0.b
		trigger_event = magic_ev.43
	}
}
#met Mammon again
magic_ev6.3 = {
	title = mammon_name
	desc = ev6.3.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	

	trigger = {
		is_alive = yes
	}

	option = {
		#my potential
		name = ev38.0.a
		trigger = {
			NOT = { has_trait = intellect_good_3 }
		}
		if = {
			limit = {
				has_trait = intellect_good_2
			}
			hidden_effect = {
				remove_trait = intellect_good_2
			}
			add_trait_force_tooltip = intellect_good_3
		}
		else_if = {
			limit = {
				has_trait = intellect_good_1
			}
			hidden_effect = {
				remove_trait = intellect_good_1
			}
			add_trait_force_tooltip = intellect_good_3
		}
		else = {
			add_trait_force_tooltip = intellect_good_2
		}
		trigger_event = magic_ev.18
	}
	option = {
		#knowledge
		name = ev38.0.b
		trigger = {
			NOT = { has_character_modifier = mammons_knowledge_modifier }
		}
		#add_learning_skill = 2
		#gain_source_ps_effect = yes
		gain_sc_xp2_effect = yes
		if = {
			limit = {
				NOT = {
					has_character_modifier = mammons_knowledge_modifier
				}
			}
			add_character_modifier = {
				modifier = mammons_knowledge_modifier
				years = 2
			}
		}
		else_if = {
			limit = {
				NOT = {
					has_character_modifier = looked_to_the_future
				}
			}
			add_character_modifier = {
				modifier = looked_to_the_future
				years = 3
			}
		}
		else = {
			add_learning_skill = 2
		}
		trigger_event = magic_ev.18
	}
	option = {
		#wealth
		name = ev38.0.c
		
		add_gold = demon_gold_value
		if = {
			limit = {
				NOT = {
					has_character_modifier = financial_knowledge_modifier
				}
			}
			add_character_modifier = {
				modifier = financial_knowledge_modifier
				years = 1
			}
		}
		trigger_event = magic_ev.18
	}

	option = {
		#wealth++
		name = ev38.0.d
		trigger = {
			has_trait = greedy
		}
		
		add_gold = greedy_gold_value
		if = {
			limit = {
				NOT = {
					has_character_modifier = financial_knowledge_modifier
				}
			}
			add_character_modifier = {
				modifier = financial_knowledge_modifier
				years = 2
			}
		}
		trigger_event = magic_ev.18
	}
	option = {
		#protection
		name = ev38.0.e
		trigger = {
			NOT = {
				has_character_modifier = amp_modifier
			}
			has_trait = craven
		}
		trait = craven
		add_character_modifier = {
			modifier = amp_modifier
			years = 15
		}
		stress_impact = {
			craven = medium_stress_loss
			paranoid = medium_stress_loss
		}
		trigger_event = magic_ev.18
	}
}
#met Hecate again
magic_ev6.4 = {
	title = ev4.85.title
	desc = ev6.4.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon

	trigger = {
		is_alive = yes
	}

	option = {
		name = bless_land
		trigger = {
			NOT = {
				has_character_flag = bless_land_flag
			}
		}
		custom_tooltip = ev5.1.0.a_ct
		add_character_flag = bless_land_flag
	}
	option = {
		name = magic_healing
		trigger = {
			NOT = {
				has_character_flag = healing_spell_flag
			}
		}
		custom_tooltip = ev5.1.0.healing_ct
		add_character_flag = healing_spell_flag
	}
	option = {
		name = shadowstep_spell
		trigger = {
			NOT = {
				has_character_flag = shadowstep_flag
			}
		}
		custom_tooltip = ev5.1.0.e_ct
		add_character_flag = shadowstep_flag
	}
	option = {
		name = plague_spell
		trigger = {
			NOT = {
				has_character_flag = plague_spell_flag
			}
		}
		custom_tooltip = ev5.1.0.f_ct
		add_character_flag = plague_spell_flag
	}
	option = {
		name = hipercognition
		trigger = {
			NOT = {
				has_character_flag = hipercognition_flag
			}
		}
		custom_tooltip = ev5.1.0.h_ct
		add_character_flag = hipercognition_flag
	}
	option = {
		name = firestorm_spell
		trigger = {
			NOT = {
				has_character_flag = firestorm_spell_flag
			}
			has_character_flag = hipercognition_flag
			has_character_flag = plague_spell_flag
			has_character_flag = shadowstep_flag
			has_character_flag = healing_spell_flag
			has_character_flag = bless_land_flag
		}
		custom_tooltip = ev5.1.0.k_ct
		add_character_flag = firestorm_spell_flag
	}
	option = {
		name = ev6.4.0.a
		trigger = {
			has_character_flag = healing_spell_flag
			has_character_flag = bless_land_flag
		}
		random_list = {
			1 = {
				trigger = {
					has_trait = archmage
					has_trait_xp = {
						trait = archmage
						track = secret_knowledge
						value < 100
					}
				}
				send_interface_toast = {
					title = hecate_name
					gain_sc_xp2_effect = yes
				}
			}
			1 = {
				trigger = {
					has_trait = archmage
					has_trait_xp = {
						trait = archmage
						track = demonology
						value < 100
					}
				}
				send_interface_toast = {
					title = hecate_name
					gain_demonology_standard_effect = yes
				}
			}
			1 = {
				trigger = {
					has_trait = archmage
					has_trait_xp = {
						trait = archmage
						track = combat_magic
						value < 100
					}
				}
				send_interface_toast = {
					title = hecate_name
					gain_cm_xp5_effect = yes
				}
			}
			1 = {
				trigger = {
					NOT = {
						has_character_modifier = secret_knowledge_modifier
					}
				}
				send_interface_toast = {
					title = hecate_name
					add_character_modifier = {
						modifier = secret_knowledge_modifier
						years = 1
					}
				}
			}
			1 = {
				send_interface_toast = {
					title = hecate_name
					add_learning_skill = 1
				}
			}
		}
	}
	option = {
		name = ev6.4.0.b
		trigger = {
			has_character_flag = healing_spell_flag
			has_character_flag = bless_land_flag
			NOT = {
				has_character_modifier = hecate_support_modifier
			}
		}
		add_character_modifier = {
			modifier = hecate_support_modifier
			years = 4
		}
	}
	after = {
		trigger_event = magic_ev.18
	}
}

#advance summoning with Hells Scepter/max demonology
magic_ev6.5 = {
	title = ev12.0.title
	#desc = ev6.5.desc
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					any_equipped_character_artifact = {	has_variable = magic_scepter	}
				}
				desc = ev6.5.desc
			}
			desc = ev6.5.desc2
		}
	}
	theme = witchcraft
	left_portrait = root
	
	trigger = {
		is_alive = yes
	}
	immediate = {
		save_scope_as = this0
	}

	option = {
		name = minor_demon
		hidden_effect = {
			if = {
				limit = {
					has_character_flag = ms_met_belial
					has_character_flag = ms_met_mammon
				}
				random_list = {
					90 = {
						ms_minor_demon_effect = yes
					}
					10 = {
						trigger = {
							has_character_flag = demon_child_accesible
						}
						ms_child_demon_effect = yes
					}
				}
			}
			else = {
				ms_minor_demon_effect = yes
			}
			
		}
	}
	option = {
		name = ev6.5.0.a
		trigger = {
			NAND = {
				#has_character_flag = ms_met_belial
				#has_character_flag = ms_met_lilith
				#has_character_flag = ms_met_mammon
				#has_character_flag = ms_met_samael
				#has_character_flag = ms_met_hecate
				#has_character_flag = ms_met_nyx
				OR = {
					has_character_flag = ms_met_belial
					NOT = {
						has_character_flag = belial_accesible
					}
				}
				OR = {
					has_character_flag = ms_met_lilith
					NOT = {
						has_character_flag = lilith_accesible
					}
				}
				OR = {
					NOT = {
						has_character_flag = mammon_accesible
					}
					has_character_flag = ms_met_mammon
				}
				OR = {
					NOT = {
						has_character_flag = samael_accesible
					}
					has_character_flag = ms_met_samael
				}
				OR = {
					has_character_flag = ms_met_hecate
					NOT = {
						has_character_flag = hecate_accesible
					}
				}
				OR = {
					has_character_flag = ms_met_nyx
					NOT = {
						has_character_flag = nyx_accesible
					}
				}
				#NOT = {
				#	has_character_flag = demon_child_accesible
				#}
			}
		}
		hidden_effect = {
			random_list = {
				100 = {
					trigger = {
						NOT = {
							has_character_flag = ms_met_belial
						}
						has_character_flag = belial_accesible
					}
					ms_belial_demon_effect = yes
				}
				100 = {
					trigger = {
						NOT = {
							has_character_flag = ms_met_lilith
						}
						has_character_flag = lilith_accesible
					}
					ms_lilith_demon_effect = yes
				}
				100 = {
					trigger = {
						NOT = {
							has_character_flag = ms_met_mammon
						}
						has_character_flag = mammon_accesible
					}
					ms_mammon_demon_effect = yes
				}
				100 = {
					trigger = {
						NOT = {
							has_character_flag = ms_met_samael
						}
						has_character_flag = samael_accesible
					}
					ms_samael_demon_effect = yes
				}
				100 = {
					trigger = {
						NOT = {
							has_character_flag = ms_met_hecate
						}
						has_character_flag = hecate_accesible
					}
					ms_hecate_demon_effect = yes
				}
				100 = {
					trigger = {
						NOT = {
							has_character_flag = ms_met_nyx
						}
						has_character_flag = nyx_accesible
					}
					ms_nyx_demon_effect = yes
				}
				40 = {
					trigger = {
						has_character_flag = demon_child_accesible
					}
					ms_child_demon_effect = yes
				}
				30 = {
					trigger = {
						NOT = {
							has_character_flag = ms_met_moloch
						}
						has_character_flag = moloch_accesible
					}
					ms_moloch_demon_effect = yes
				}
				30 = {
					trigger = {
						NOR = {
							has_character_flag = ms_met_asmodeus
							has_trait = demon
						}
						has_character_flag = asmodeus_accesible
						exists = dynasty
						NOT = {
							dynasty = {
								has_variable = ms_met_asmodeus2
							}
						}
					}
					ms_asmodeus_demon_effect = yes
				}
				1 = {
					hidden_effect = {
						ms_minor_demon_effect = yes
					}
				}
			}
		}
	}
	option = {
		name = belial_name
		trigger = {
			has_character_flag = ms_met_belial
			has_character_flag = belial_accesible
		}
		ms_belial_demon_effect = yes
	}
	option = {
		name = lilith_name
		trigger = {
			has_character_flag = ms_met_lilith
			has_character_flag = lilith_accesible
		}
		ms_lilith_demon_effect = yes
	}
	option = {
		name = mammon_name
		trigger = {
			has_character_flag = ms_met_mammon
			has_character_flag = mammon_accesible
		}
		ms_mammon_demon_effect = yes
	}
	option = {
		name = samael_name
		trigger = {
			has_character_flag = ms_met_samael
			has_character_flag = samael_accesible
		}
		ms_samael_demon_effect = yes
	}
	option = {
		name = hecate_name
		trigger = {
			has_character_flag = ms_met_hecate
			has_character_flag = hecate_accesible
		}
		ms_hecate_demon_effect = yes
	}
	option = {
		name = nyx_name
		trigger = {
			has_character_flag = ms_met_nyx
			has_character_flag = nyx_accesible
		}
		ms_nyx_demon_effect = yes
	}
	after = {
		hidden_effect = {
			if = {
				limit = {
					has_character_flag = belial_accesible
				}
				remove_character_flag = belial_accesible
			}
			if = {
				limit = {
					has_character_flag = lilith_accesible
				}
				remove_character_flag = lilith_accesible
			}
			if = {
				limit = {
					has_character_flag = mammon_accesible
				}
				remove_character_flag = mammon_accesible
			}
			if = {
				limit = {
					has_character_flag = samael_accesible
				}
				remove_character_flag = samael_accesible
			}
			if = {
				limit = {
					has_character_flag = hecate_accesible
				}
				remove_character_flag = hecate_accesible
			}
			if = {
				limit = {
					has_character_flag = nyx_accesible
				}
				remove_character_flag = nyx_accesible
			}
			if = {
				limit = {
					has_character_flag = demon_child_accesible
				}
				remove_character_flag = demon_child_accesible
			}
			if = {
				limit = {
					has_character_flag = moloch_accesible
				}
				remove_character_flag = moloch_accesible
			}
			if = {
				limit = {
					has_character_flag = asmodeus_accesible
				}
				remove_character_flag = asmodeus_accesible
			}
		}
	}
}
#nyx - first summoning
magic_ev6.6 = {
	title = ev6.6.title
	desc = ev6.6.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		animation = spymaster
	}
	trigger = {
		is_alive = yes
	}

	option = {
		#who are you?
		name = ev6.6.0.a
		trigger_event = magic_ev6.7
	}
}
#nyx - conversation
magic_ev6.7 = {
	title = nyx_name
	desc = ev6.7.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	trigger = {
		is_alive = yes
	}

	option = {
		#who are your master?
		name = ev6.7.0.a
		trigger_event = magic_ev6.8
	}
	option = {
		#lets go to busines
		name = ev6.7.0.b
		trigger_event = magic_ev6.9
	}
	option = {
		#dissappear
		name = ev6.7.0.c
		trigger_event = magic_ev.18
	}
	
}
#nyx - conversation2
magic_ev6.8 = {
	title = nyx_name
	desc = ev6.8.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	trigger = {
		is_alive = yes
	}

	option = {
		#okey
		name = ev6.8.0.a
		trigger_event = magic_ev6.9
	}
	option = {
		#dissappear
		name = ev6.8.0.b
		trigger_event = magic_ev.18
	}
}
#nyx - core
magic_ev6.9 = {
	title = nyx_name
	#desc = ev6.9.desc
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_flag = ms_met_nyx2
				}
				desc = ev6.9.desc3
			}
			triggered_desc = {
				trigger = {
					has_character_flag = ms_met_nyx
				}
				desc = ev6.9.desc2
			}
			desc = ev6.9.desc
		}
	}
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	trigger = {
		is_alive = yes
	}
	immediate = {
		if = {
			limit = {
				exists = liege
				NOR = {
					liege = root
					has_claim_on = liege.primary_title
				}
			}
			liege.primary_title = {
				add_to_list = potential_claim_tit
			}
		}
		random_neighboring_and_across_water_top_liege_realm = {
			limit = {
				NOT = {
					any_claimant = {
						this = root
					}
				}
			}
			add_to_list = potential_claim_tit
		}
		random_in_list = {
			list = potential_claim_tit
			save_scope_as = nyx_claim
		}
		if = {
			limit = {
				NOT = {
					exists = scope:nyx_claim
				}
			}
			random_empire = {
				limit = {
					NOT = {
						any_claimant = {
							this = root
						}
						holder = root
					}
				}
				save_scope_as = nyx_claim
			}
		}
		if = {
			limit = {
				NOT = {
					exists = scope:nyx_claim
				}
			}
			random_kingdom = {
				limit = {
					NOT = {
						any_claimant = {
							this = root
						}
						holder = root
					}
				}
				save_scope_as = nyx_claim
			}
		}
	}

	option = {
		#claims
		name = ev6.9.0.a
		add_pressed_claim = scope:nyx_claim
		trigger_event = magic_ev.18
	}
	option = {
		#respect
		name = ev6.9.0.b
		trigger = {
			NOT = {
				has_character_modifier = nyx_blessing_modifier
			}
		}
		add_character_modifier = {
			modifier = nyx_blessing_modifier
			years = 3
		}
		trigger_event = magic_ev.18
	}
	option = {
		#tell me about plots against me
		name = ev6.9.0.c
		custom_tooltip = ev6.9.0.c_ct
		trigger_event = magic_ev6.10
	}
	option = {
		#nice dreams are welcome
		name = ev6.9.0.d
		trigger = {
			NOT = {
				has_character_modifier = peaceful_dreams_modifier
			}
		}
		add_character_modifier = {
			modifier = peaceful_dreams_modifier
			years = 3
		}
		trigger_event = magic_ev.18
	}
	option = {
		#erase my sins
		name = ev6.9.0.e
		trigger = {
			OR = {
				has_trait = murderer
				has_trait = kinslayer_1
				has_trait = kinslayer_2
				has_trait = kinslayer_3
				has_trait = adulterer
				has_trait = fornicator
			}
		}
		if = {
			limit = {
				has_trait = murderer
			}
			remove_trait = murderer
		}
		else_if = {
			limit = {
				has_trait = kinslayer_1
			}
			remove_trait = kinslayer_1
		}
		else_if = {
			limit = {
				has_trait = kinslayer_2
			}
			remove_trait = kinslayer_2
		}
		else_if = {
			limit = {
				has_trait = kinslayer_3
			}
			remove_trait = kinslayer_3
		}
		else_if = {
			limit = {
				has_trait = adulterer
			}
			remove_trait = adulterer
		}
		else_if = {
			limit = {
				has_trait = fornicator
			}
			remove_trait = fornicator
		}
		trigger_event = magic_ev.18
	}
	after = {
		if = {
			limit = {
				NOT = {
					has_character_flag = ms_met_nyx
				}
			}
			add_character_flag = ms_met_nyx
		}
	}
}
#nyx - schemming info
magic_ev6.10 = {
	title = nyx_name
	#desc = ev6.10.desc
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					exists = scope:mscheme
				}
				desc = ev6.10.desc2
			}
			desc = ev6.10.desc
		}
	}
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	lower_right_portrait = {
		trigger = {
			exists = scope:sowner
		}
		character = scope:sowner
	}
	trigger = {
		is_alive = yes
	}
	immediate = {
		random_targeting_scheme = {
			limit = {
				is_scheme_exposed = no
				is_hostile = yes
			}
			save_scope_as = mscheme
		}
		if = {
			limit = {
				NOT = {
					exists = scope:mscheme
				}
			}
			random_targeting_scheme = {
				limit = {
					is_hostile = yes
				}
				save_scope_as = mscheme
			}
		}
		if = {
			limit = {
				exists = scope:mscheme
			}
			scope:mscheme.scheme_owner = {
				save_scope_as = sowner
			}
		}
	}
	option = {
		#I see
		name = ev4.23.0.a
		if = {
			limit = {
				NOT = {
					exists = scope:mscheme
				}
			}
			add_stress = medium_stress_loss
		}
		trigger_event = magic_ev.18
	}
	option = {
		#I expose it
		name = ev6.10.0.a
		trigger = {
			exists = scope:mscheme
			scope:mscheme = {
				is_scheme_exposed = no
			}
		}
		scope:mscheme = {
			expose_scheme = yes
		}
		hidden_effect = {
			scope:mscheme.scheme_target = {
				send_interface_toast = {
					title = spymaster_task.1101.exposure_tt
					add_opinion = {
						target = scope:mscheme.scheme_owner
						modifier = schemed_against_me
					}
				}
			}
		}
		trigger_event = magic_ev.18
	}
}

#mind scan spell
magic_ev6.11 = {
	title = mind_scan
	#desc = ev6.11.desc
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					exists = scope:mscheme
				}
				desc = ev6.11.desc2
			}
			triggered_desc = {
				trigger = {
					exists = scope:mscheme2
				}
				desc = ev6.11.desc3
			}
			triggered_desc = {
				trigger = {
					exists = scope:rsecret
				}
				desc = ev6.11.desc4
			}
			desc = ev6.11.desc
		}
	}
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:recipient
	lower_left_portrait = {
		trigger = {
			exists = scope:mschemeowner2
		}
		character = scope:mschemeowner2
	}
	lower_right_portrait = {
		trigger = {
			exists = scope:mstarget
		}
		character = scope:mstarget
	}
	
	trigger = {
		is_alive = yes
	}
	immediate = {
		hidden_effect = {
			scope:recipient = {
				random_secret = {
					limit = {
						NOT = { is_known_by = root }
					}
					save_scope_as = rsecret
				}
				random_scheme = {
					limit = {
						is_hostile = yes
					}
					save_scope_as = mscheme
					scheme_target = {
						save_scope_as = mstarget
					}
				}
			}
			if = {
				limit = {
					NOT = {
						exists = scope:mscheme
					}
				}
				random_living_character = {
					limit = {
						any_scheme = {
							any_scheme_agent = {
								this = scope:recipient
							}
						}
					}
					save_scope_as = mschemeowner2
					random_scheme = {
						limit = {
							any_scheme_agent = {
								this = scope:recipient
							}
						}
						save_scope_as = mscheme2
						scheme_target = {
							save_scope_as = mstarget
						}
					}
				}
			}
		}
		if = {
			limit = {
				exists = scope:rsecret
			}
			scope:rsecret = {
				reveal_to = root
			}
		}
	}

	option = {
		#I see...
		name = ev4.23.0.a
		hidden_effect = {
			if = {
				limit = {
					exists = scope:mscheme
					scope:mscheme.scheme_target = root
				}
				add_opinion = {
					target = scope:mscheme.scheme_owner
					modifier = schemed_against_me
				}
			}
			else_if = {
				limit = {
					exists = scope:mscheme2
					scope:mscheme2.scheme_target = root
				}
				add_opinion = {
					target = scope:mscheme2.scheme_owner
					modifier = schemed_against_me
				}
			}
		}
	}
	option = {
		#I expose it
		name = ev6.10.0.a
		trigger = {
			exists = scope:mscheme
			scope:mscheme = {
				is_scheme_exposed = no
			}
		}
		scope:mscheme = {
			expose_scheme = yes
		}
		hidden_effect = {
			scope:mscheme.scheme_target = {
				send_interface_toast = {
					title = spymaster_task.1101.exposure_tt
					add_opinion = {
						target = scope:mscheme.scheme_owner
						modifier = schemed_against_me
					}
				}
			}
		}
	}
	option = {
		#I expose it
		name = ev6.10.0.a
		trigger = {
			exists = scope:mscheme2
			scope:mscheme2 = {
				is_scheme_exposed = no
			}
		}
		scope:mscheme2 = {
			expose_scheme = yes
		}
		hidden_effect = {
			scope:mscheme2.scheme_target = {
				send_interface_toast = {
					title = spymaster_task.1101.exposure_tt
					add_opinion = {
						target = scope:mscheme2.scheme_owner
						modifier = schemed_against_me
					}
				}
			}
		}
	}
}
#Asmodeus
magic_ev6.12 = {
	title = ev6.12.title
	desc = ev6.12.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		animation = scheme
		outfit_tags = { ep1_adventurer_cloak }
	}
	
	trigger = {
		is_alive = yes
	}

	option = {
		name = ev6.12.0.a
		trigger_event = magic_ev6.13
	}
}
#Asmodeus 2
magic_ev6.13 = {
	title = ev6.12.title
	desc = ev6.13.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		animation = eyeroll
		outfit_tags = { ep1_adventurer_cloak }
	}
	
	trigger = {
		is_alive = yes
	}
	immediate = {
		add_stress = medium_stress_gain
	}
	option = {
		name = ev6.13.0.a
	}
	option = {
		name = ev6.13.0.b
	}
	after = {
		trigger_event = magic_ev6.14
	}
}
#Asmodeus 3
magic_ev6.14 = {
	title = ev6.12.title
	desc = ev6.14.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		outfit_tags = { ep1_adventurer_cloak }
	}
	trigger = {
		is_alive = yes
	}
	option = {
		#No demon will command me.
		name = ev6.14.0.a
		trigger_event = magic_ev6.15
	}
	option = {
		#Threats are not needed here....
		name = ev6.14.0.b
		trigger_event = magic_ev6.15
	}
	option = {
		#Let it be, I can serve you.
		name = ev6.14.0.c
		trigger_event = magic_ev6.17
	}
}
#Asmodeus 4a
magic_ev6.15 = {
	title = ev6.12.title
	desc = ev6.15.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		animation = disgust
		outfit_tags = { ep1_adventurer_cloak }
	}
	
	trigger = {
		is_alive = yes
	}
	immediate = {
		if = {
			limit = {
				NOR = {
					has_trait = wounded_1
					has_trait = wounded_2
					has_trait = wounded_3
				}
			}
			add_trait = wounded_2
		}
	}
	option = {
		#Never
		name = ev6.15.0.a
		trigger = {
			NOR = {
				has_trait = source3
				has_trait = source4
			}
		}
		custom_tooltip = ev6.15.0.a_ct
		trigger_event = magic_ev6.16
	}
	option = {
		#Never
		name = ev6.15.0.a
		trigger = {
			has_trait = source3
		}
		trait = source3
		custom_tooltip = ev6.15.0.a_ct2
		trigger_event = magic_ev6.19
	}
	option = {
		#Never
		name = ev6.15.0.a
		trigger = {
			OR = {
				has_trait = source4
				has_trait = source
			}
		}
		trait = source
		custom_tooltip = ev6.15.0.a_ct2
		trigger_event = magic_ev6.19
	}
	option = {
		#I surrender
		name = ev6.15.0.b
		trigger_event = magic_ev6.17
	}
}
#Asmodeus 5a
magic_ev6.16 = {
	title = ev6.12.title
	desc = ev6.16.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		animation = scheme
		outfit_tags = { ep1_adventurer_cloak }
	}
	
	trigger = {
		is_alive = yes
	}
	immediate = {
		gain_cm_xp1_effect = yes
	}
	option = {
		#...
		name = harm.0541.a
		trigger_event = magic_ev.18
	}
}
#Asmodeus 4b
magic_ev6.17 = {
	title = ev6.12.title
	desc = ev6.17.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		animation = scheme
		outfit_tags = { ep1_adventurer_cloak }
	}
	
	trigger = {
		is_alive = yes
	}
	immediate = {
		root.player_heir = {
			save_scope_as = hier
		}
		if = {
			limit = {
				NOT = {
					exists = scope:hier
				}
			}
			primary_heir = {
				save_scope_as = hier
			}
		}
	}
	option = {
		#no!
		trigger = {
			NOR = {
				has_trait = source3
				has_trait = source4
			}
		}
		name = ev6.17.0.a
		custom_tooltip = ev6.15.0.a_ct
		trigger_event = magic_ev6.16
	}
	option = {
		#no!
		trigger = {
			has_trait = source3
		}
		trait = source3
		name = ev6.17.0.a
		custom_tooltip = ev6.15.0.a_ct2
		trigger_event = magic_ev6.19
	}
	option = {
		#no!
		trigger = {
			OR = {
				has_trait = source4
				has_trait = source
			}
		}
		trait = source
		name = ev6.17.0.a
		custom_tooltip = ev6.15.0.a_ct2
		trigger_event = magic_ev6.19
	}
	option = {
		#as you wish
		name = ev2.9.a
		scope:hier = {
			death = {
				death_reason = death_murder
				killer = root
			}
		}
		if = {
			limit = {
				NOT = {
					has_trait = kinslayer_3
				}
			}
			add_trait = kinslayer_3
		}
		if = {
			limit = {
				NOT = {
					has_trait = murderer
				}
			}
			add_trait = murderer
		}
		add_tyranny = major_tyranny_gain
		trigger_event = magic_ev6.18
	}
}
#Asmodeus 6
magic_ev6.18 = {
	title = ev6.12.title
	desc = ev6.18.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		animation = disgust
		outfit_tags = { ep1_adventurer_cloak }
	}
	
	trigger = {
		is_alive = yes
	}
	option = {
		#...
		name = harm.0541.a
		trigger_event = magic_ev.18
	}
}
#Asmodeus 7 - source hit
magic_ev6.19 = {
	title = ev6.12.title
	desc = ev6.19.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		animation = admiration
		outfit_tags = { ep1_adventurer_cloak }
	}
	
	trigger = {
		is_alive = yes
	}
	immediate = {
		gain_cm_xp1_effect = yes
	}
	option = {
		#...
		name = harm.0541.a
		trigger_event = magic_ev.18
	}
}
#ring of life special
magic_ev6.20 = {
	title = ev6.20.title
	desc = ev6.20.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:created_witch
		animation = spymaster
		#outfit_tags = { ep1_adventurer_cloak }
	}
	
	trigger = {
		is_alive = yes
		is_imprisoned = no
		is_ai = no
		any_character_artifact = {
			has_variable = magic_ring0
			has_artifact_modifier = artifact_ring_of_life_modifier
		}
		exists = dynasty
		dynasty = {
			NOT = {
				has_variable = ring_of_life_special1
			}
		}
	}
	immediate = {
		hidden_effect = {
			create_character = {
				location = root.location
				template = witchy_template
				name = achoris_name
				gender = male
				culture = culture:egyptian
				faith = root.faith
				random_traits = no
				age = 45
				save_scope_as = created_witch
				after_creation = {
					add_trait = true_witch
					add_character_flag = achoris
					add_diplomacy_skill = 5
					add_learning_skill = 5
					#add_trait = witch
				}
			}
		}
	}
	option = {
		#who are you?
		name = ev6.20.0.a
		trigger_event = magic_ev6.21
	}
	after = {
		hidden_effect = {
			dynasty = {
				set_variable = ring_of_life_special1
			}
		}
	}
}
#ring of life special - Acharis introduction
magic_ev6.21 = {
	title = ev6.20.title
	desc = ev6.21.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:created_witch
		animation = spymaster
		#outfit_tags = { ep1_adventurer_cloak }
	}
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		any_character_artifact = {
			has_variable = magic_ring0
		}
	}
	immediate = {
		hidden_effect = {
			random_character_artifact = {
				limit = {
					has_variable = magic_ring0
				}
				save_scope_as = mring
			}
		}
	}

	option = {
		#nope
		name = ev6.21.0.a
		trigger_event = magic_ev6.22
	}
	option = {
		#Let's talk about the price.
		name = ev6.21.0.b
		trigger_event = magic_ev6.24
	}
}
#ring of life special - persuasion
magic_ev6.22 = {
	title = ev6.20.title
	desc = ev6.22.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:created_witch
		animation = spymaster
		#outfit_tags = { ep1_adventurer_cloak }
	}
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		any_character_artifact = {
			has_variable = magic_ring0
		}
	}

	option = {
		#nope!
		name = ev6.22.0.a
		trigger_event = magic_ev6.23
	}
	option = {
		#okey, I give you the ring...
		name = ev6.22.0.b
		trigger_event = magic_ev6.24
	}
}
#ring of life special - nope&bye
magic_ev6.23 = {
	title = ev6.20.title
	desc = ev6.23.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:created_witch
		animation = spymaster
		#outfit_tags = { ep1_adventurer_cloak }
	}
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		any_character_artifact = {
			has_variable = magic_ring0
		}
	}

	option = {
		#bye bye
		name = ev6.23.0.a
		trigger_event = magic_ev6.25
	}
	after = {
		hidden_effect = {
			random_neighboring_and_across_water_top_liege_realm_owner = {
				add_courtier = scope:created_witch
			}
			scope:created_witch = {
				add_opinion = {
					modifier = refusal_opinion
					target = root
					opinion = -200
				}
			}
		}
	}
}
#ring of life special - sell the ring
magic_ev6.24 = {
	title = ev6.20.title
	desc = ev6.24.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:created_witch
		animation = spymaster
		#outfit_tags = { ep1_adventurer_cloak }
	}
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		any_character_artifact = {
			has_variable = magic_ring0
		}
	}

	option = {
		#ok
		name = ev54.0.a
		add_gold = 600
		if = {
			limit = {
				has_trait = archmage
				has_trait_xp = {
					trait = archmage
					track = secret_knowledge
					value < 100
				}
			}
			add_trait_xp = {
				trait = archmage
				track = secret_knowledge
				value = 2
			}
		}
		else = {
			add_learning_skill = 1
		}
		scope:mring = {
			set_owner = {
				target = scope:created_witch
				history = {
					type = purchased
					actor = root
					recipient = scope:created_witch
					location = root.location
				}
			}
		}
		hidden_effect = {
			random_neighboring_and_across_water_top_liege_realm_owner = {
				add_courtier = scope:created_witch
			}
		}
	}
	option = {
		#nope
		name = ev6.17.0.a
		trigger_event = magic_ev6.23
	}
}
#ring of life special - deactivation
magic_ev6.25 = {
	title = ev6.20.title
	desc = ev6.25.desc
	theme = witchcraft
	left_portrait = root
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		any_character_artifact = {
			has_variable = magic_ring0
		}
	}
	immediate = {
		scope:mring = {
			clear_artifact_modifiers = yes
			add_artifact_modifier = artifact_ring_of_life_modifier0
		}
		
	}
	option = {
		#we should have a chat
		name = ev6.25.0.a
		trigger = {
			has_trait = schemer
		}
		trait = schemer
		custom_tooltip = ev6.25.0.a_ct1
		custom_tooltip = ev6.25.0.a_ct2
		start_scheme = {
			type = abduct
			target = scope:created_witch
		}
	}
	option = {
		#Damn it!
		name = artifact.4050.a
		add_stress = minor_stress_gain
		custom_tooltip = ev6.25.0.a_ct1
		custom_tooltip = ev6.25.0.a_ct2
	}
	option = {
		#I deal with it
		name = ev6.25.0.a
		trigger = {
			is_legendary_mage_trigger = yes
		}
		trait = archmage
		custom_tooltip = ev5.28.0.s1_ct
		scope:mring = {
			clear_artifact_modifiers = yes
			add_artifact_modifier = artifact_ring_of_life_modifier
		}
	}
	option = {
		#I deal with it in other way
		name = ev6.25.0.b
		trigger = {
			has_trait = source3
			can_spend_standard_ps_trigger = yes
		}
		trait = source3
		spend_standard_ps_effect = yes
		scope:mring = {
			clear_artifact_modifiers = yes
			add_artifact_modifier = artifact_ring_of_life_modifier
		}
	}
}

#ring of life special - magic epic 1
magic_ev6.26 = {
	title = ev3.22.title
	desc = ev6.26.desc
	theme = witchcraft
	left_portrait = root
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		is_alive = yes
		is_imprisoned = no
		any_character_artifact = {
			has_variable = magic_ring0
			has_artifact_modifier = artifact_ring_of_life_modifier0
		}
	}
	immediate = {
		hidden_effect = {
			random_character_artifact = {
				limit = {
					has_variable = magic_ring0
					has_artifact_modifier = artifact_ring_of_life_modifier0
				}
				save_scope_as = mring
			}
		}
	}

	option = {
		name = ev6.26.0.a
		trigger_event = {
			id = magic_ev6.27
			months = { 3 6 }
		}
	}
	option = {
		trigger = {
			has_trait = intellect_good_3
		}
		trait = intellect_good_3
		name = ev6.26.0.b
		custom_tooltip = ev3.25.a_ct
		trigger_event = {
			id = magic_ev6.28
			months = { 3 6 }
		}
	}
	option = {
		name = ev6.26.0.c
		trigger = {
			has_trait = grandmaster_coven
		}
		trait = grandmaster_coven
		custom_tooltip = ev3.25.a_ct
		trigger_event = {
			id = magic_ev6.28
			months = { 3 6 }
		}
	}
}
#ring of life special - magic epic 2
magic_ev6.27 = {
	title = ev3.22.title
	desc = ev6.27.desc
	theme = witchcraft
	left_portrait = root
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		is_alive = yes
		is_imprisoned = no
		any_character_artifact = {
			has_variable = magic_ring0
			has_artifact_modifier = artifact_ring_of_life_modifier0
		}
	}

	option = {
		#I can handle it
		name = ev3.26.a
		duel = {
			skill = learning
			value = 25
			5 = {
				desc = ev3.26.a_1
				compare_modifier = {
					value = scope:duel_value
					multiplier = 1
					min = 0
				}
				
				send_interface_toast = {
					title=ev3.26.a_1
					custom_tooltip = ev3.25.a_ct
				}
				trigger_event = {
					id = magic_ev6.28
					months = { 3 5 }
				}
			}
			5 = {
				desc = ev3.26.a_2
				compare_modifier = {
					value = scope:duel_value
					multiplier = -1
					min = 0
				}
				send_interface_toast = {
					title=ev3.26.a_2
					custom_tooltip = ev6.27.0.a_ct
				}
				trigger_event = {
					id = magic_ev6.27
					months = { 3 5 }
				}
			}
		}
	}
	option = {
		#This is the waste of time
		name = ev2.68.b
		custom_tooltip = ev6.27.0.b_ct
	}
}
#ring of life special - magic epic 3
magic_ev6.28 = {
	title = ev3.22.title
	desc = ev3.25.desc
	theme = witchcraft
	left_portrait = root
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		is_alive = yes
		is_imprisoned = no
		any_character_artifact = {
			has_variable = magic_ring0
			has_artifact_modifier = artifact_ring_of_life_modifier0
		}
	}

	option = {
		#I pay
		name = ev3.25.c
		custom_tooltip = ev3.25.a_ct
		stress_impact = {
			greedy = major_stress_gain
		}
		remove_short_term_gold = {
			add = demon_gold_value
		}
		trigger_event = {
			id = magic_ev6.29
			months = { 2 5 }
		}
	}
	option = {
		#I pay half
		name = ev6.28.0.b
		trigger = {
			has_trait = lifestyle_herbalist
		}
		trait = lifestyle_herbalist
		custom_tooltip = ev3.25.a_ct
		stress_impact = {
			greedy = medium_stress_gain
		}
		remove_short_term_gold = {
			add = half_demon_gold_value
		}
		trigger_event = {
			id = magic_ev6.29
			months = { 2 5 }
		}
	}
	option = {
		#This is the waste of time
		name = ev2.68.b
		custom_tooltip = ev6.27.0.b_ct
	}
}
#ring of life special - magic epic 4 - final conclusion
magic_ev6.29 = {
	title = ev3.22.title
	desc = ev6.29.desc
	theme = witchcraft
	left_portrait = root
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		is_alive = yes
		is_imprisoned = no
		any_character_artifact = {
			has_variable = magic_ring0
			has_artifact_modifier = artifact_ring_of_life_modifier0
		}
	}

	option = {
		#At last!
		name = ev2.6.a
		
		if = {
			limit = {
				can_spend_standard_ps_trigger = yes
			}
			spend_standard_ps_effect = yes
		}
		scope:mring = {
			clear_artifact_modifiers = yes
			add_artifact_modifier = artifact_ring_of_life_modifier
		}
		gain_sc_xp5_effect = yes
		custom_tooltip = ev3.28.a_ct
	}
}

#ring of life special - Achoris imprisoned
magic_ev6.30 = {
	title = achoris_name
	desc = ev6.30.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:achoriss
		#animation = spymaster
		#outfit_tags = { ep1_adventurer_cloak }
	}
	artifact = {
        target = scope:mring
        position = lower_left_portrait
    }
	trigger = {
		any_character_artifact = {
			has_variable = magic_ring0
			has_artifact_modifier = artifact_ring_of_life_modifier0
		}
	}
	immediate = {
		hidden_effect = {
			random_character_artifact = {
				limit = {
					has_variable = magic_ring0
					has_artifact_modifier = artifact_ring_of_life_modifier0
				}
				save_scope_as = mring
			}
		}
	}
	option = {
		name = ev6.30.0.a
		scope:mring = {
			clear_artifact_modifiers = yes
			add_artifact_modifier = artifact_ring_of_life_modifier
		}
		scope:achoriss = {
			death = {
				death_reason = death_suicide
			}
		}
	}
}

#special for coven grandmaster - tax the members?
magic_ev6.31 = {
	title = ev6.31.title
	desc = ev6.31.desc
	theme = witchcraft
	left_portrait = root
	trigger = {
		is_imprisoned = no
		has_trait = grandmaster_coven
		exists = house
	}
	
	option = {
		name = ev6.31.0.a
		house = {
			every_house_member = {
				limit = {
					NOT = {
						THIS = ROOT
					}
					is_adult = yes
					OR = {
						has_trait = witch
						has_trait = true_witch
						has_trait = archmage
						any_secret = {
							secret_type = secret_witch
							is_known_by = root
						}
					}
				}
				pay_short_term_gold = {
					target = root
					gold = 5
				}
			}
		}
		
		every_courtier = {
			limit = {
				NOT = {
					THIS = ROOT
				}
				is_lowborn = yes
				is_adult = yes
				OR = {
					has_trait = witch
					has_trait = true_witch
					has_trait = archmage
					any_secret = {
						secret_type = secret_witch
						is_known_by = root
					}
				}
			}
			pay_short_term_gold = {
				target = root
				gold = 5
			}
		}
	}
	option = {
		name = ev6.31.0.b
		if = {
			limit = {
				has_trait = grandmaster_coven
				has_trait_xp = {
					trait = grandmaster_coven
					value < 100
				}
			}
			add_trait_xp = {
				trait = grandmaster_coven
				value = 10
			}
		}
		else = {
			add_prestige = medium_prestige_gain
		}
	}
}

#special for coven grandmaster - hunters attack
magic_ev6.32 = {
	title = ev5.31.title
	desc = ev6.32.desc
	theme = witchcraft
	left_portrait = root
	lower_right_portrait = scope:hunter_vict
	trigger = {
		is_imprisoned = no
		has_trait = grandmaster_coven
		NOT = {
			has_game_rule = low_whunters
		}
		exists = house
		is_ai = no
		house = {
			any_house_member = {
				NOT = {
					THIS = ROOT
				}
				is_adult = yes
				is_ai = yes
				OR = {
					has_trait = witch
					has_trait = true_witch
					any_secret = {
						secret_type = secret_witch
						is_known_by = root
					}
				}
				NOR = {
					has_trait = demon
					has_trait = archmage
					has_relation_rival = root
					has_relation_nemesis = root
				}
			}
		}
		any_living_character = {
			has_character_modifier = inq_modifier
			is_imprisoned = no
		}
	}
	immediate = {
		hidden_effect = {
			house = {
				every_house_member = {
					limit = {
						NOT = {
							THIS = ROOT
						}
						is_adult = yes
						is_ai = yes
						OR = {
							has_trait = witch
							has_trait = true_witch
							any_secret = {
								secret_type = secret_witch
								is_known_by = root
							}
						}
						NOR = {
							has_trait = demon
							has_trait = archmage
							has_relation_rival = root
							has_relation_nemesis = root
						}
					}
					add_to_list = hunter_victs
				}
			}
			
			every_courtier = {
				limit = {
					NOT = {
						THIS = ROOT
					}
					is_lowborn = yes
					is_adult = yes
					OR = {
						has_trait = witch
						has_trait = true_witch
						any_secret = {
							secret_type = secret_witch
							is_known_by = root
						}
					}
					NOR = {
						has_trait = demon
						has_trait = archmage
						has_relation_rival = root
						has_relation_nemesis = root
					}
				}
				add_to_list = hunter_victs
			}
			random_in_list = {
				list = hunter_victs
				save_scope_as = hunter_vict
			}
		}
		scope:hunter_vict = {
			death = {
				death_reason = death_decapitated
			}
		}
	}
	option = {
		name = ev6.32.0.a
		stress_impact = {
			calm = minor_stress_gain
			craven = minor_stress_gain
		}
	}
	option = {
		name = ev6.32.0.b
		stress_impact = {
			wrathful = minor_stress_gain
			craven = minor_stress_gain
			ambitious = minor_stress_gain
			sadistic = minor_stress_loss
		}
	}
	option = {
		name = ev6.32.0.c
		trigger = {
			has_trait = vengeful
		}
		trait = vengeful
		stress_impact = {
			sadistic = minor_stress_loss
			greedy = medium_stress_gain
		}
		remove_short_term_gold = {
			add = half_demon_gold_value
		}
		custom_tooltip = ev6.32.0.c_ct
		hidden_effect = {
			add_character_flag = {
				flag = pay_for_witch_hunters
				years = 10
			}
		}
	}
	option = {
		name = ev6.32.0.d
		trigger = {
			has_trait = schemer
		}
		trait = schemer
		stress_impact = {
			deceitful = minor_stress_loss
		}
		custom_tooltip = ev6.32.0.c_ct
		hidden_effect = {
			add_character_flag = {
				flag = pay_for_witch_hunters
				years = 15
			}
		}
	}
}

#special for coven grandmaster - other coven
magic_ev6.33 = {
	title = ev6.33.title
	desc = ev6.33.desc
	theme = witchcraft
	left_portrait = root
	trigger = {
		is_imprisoned = no
		has_trait = grandmaster_coven
		exists = house
	}
	
	option = {
		name = ev6.33.0.a
		add_tyranny = minor_tyranny_gain
		add_dread = minor_dread_gain
	}
	option = {
		name = ev6.33.0.b
		remove_short_term_gold = {
			add = half_demon_gold_value
		}
	}
	option = {
		name = ev6.33.0.c
		trigger = {
			intrigue > 20
		}
		skill = intrigue
	}
	after = {
		if = {
			limit = {
				has_trait = grandmaster_coven
				has_trait_xp = {
					trait = grandmaster_coven
					value < 100
				}
			}
			add_trait_xp = {
				trait = grandmaster_coven
				value = 5
			}
		}
	}
}

#mage rulership - executions restore power saturation - 1
magic_ev6.34 = {
	hidden = yes
	trigger = {
		exists = scope:killer
		scope:killer = {
			culture = {
				has_cultural_tradition = mage_rulership_tradition
			}
		}
	}
	immediate = {
		save_scope_as = victim
		scope:killer = {
			trigger_event = {
				id = magic_ev6.35
				days = 1
			}
		}
	}
}

#mage rulership - executions restore power saturation - 2
magic_ev6.35 = {
	hidden = yes
	trigger = {
		culture = {
			has_cultural_tradition = mage_rulership_tradition
		}
		scope:victim = {
			OR = {
				death_reason = death_execution
				death_reason = death_execution_blood_eagle
				death_reason = death_execution_blood_eagle_killer
				death_reason = death_execution_blot
				death_reason = death_execution_killer
				death_reason = death_sacrificed_to_gods
				death_reason = death_crucified
				death_reason = death_burned_witch
			}
		}
		
	}
	immediate = {
		if = {
			limit = {
				can_be_power_saturated_trigger = yes
			}
			send_interface_toast = {
				title=mage_rulership_execution
				gain_standard_ps_effect = yes
			}
		}
	}
}

#special for mage rulership - vassal against muggle ruler
magic_ev6.36 = {
	title = ev6.36.title
	desc = ev6.36.desc
	theme = witchcraft
	left_portrait = root
	lower_right_portrait = scope:liege0
	trigger = {
		is_imprisoned = no
		is_landed = yes
		culture = {
			has_cultural_tradition = mage_rulership_tradition
		}
		OR = {
			has_trait = archmage
			has_trait = true_witch
			has_focus = arcane_focus
		}
		exists = liege
		NOT = {
			liege=root
		}
		liege = {
			is_adult = yes
			culture = {
				has_cultural_tradition = mage_rulership_tradition
			}
			NOR = {
				has_trait = archmage
				has_trait = true_witch
				has_focus = arcane_focus
				has_trait = demon
			}
		}
	}
	immediate = {
		hidden_effect = {
			liege = {
				save_scope_as = liege0
			}
		}
	}
	option = {
		name = ev6.36.0.a
		if = {
			limit = {
				NOT = {
					has_claim_on = scope:liege0.primary_title
				}
			}
			add_unpressed_claim = scope:liege0.primary_title
		}
		if = {
			limit = {
				is_ai = yes
			}
			add_opinion = {
				modifier = disgusted_opinion
				target = scope:liege0
				opinion = -50
			}
		}
		if = {
			limit = {
				NOT = {
					has_character_modifier = bp2_yearly_0641_fellow_vassals_modifier
				}
			}
			add_character_modifier = {
				modifier = bp2_yearly_0641_fellow_vassals_modifier
				years = 4
			}
		}
		scope:liege0 = {
			
			if = {
				limit = {
					is_valid_for_legitimacy_change = yes
				}
				add_legitimacy = medium_legitimacy_loss
			}
			else = {
				every_vassal = {
					limit = {
						culture = {
							has_cultural_tradition = mage_rulership_tradition
						}
						is_ai = yes
						OR = {
							has_trait = archmage
							has_trait = true_witch
							has_focus = arcane_focus
						}
						NOT = {
							THIS = ROOT
						}
					}
					add_opinion = {
						modifier = disgusted_opinion
						target = scope:liege0
						opinion = -30
					}
				}
			}
		}
	}
	option = {
		name = ev6.36.0.b
		trigger = {
			NOT = {
				has_hook = scope:liege0
			}
		}
		add_hook = {
			type = threat_hook
			target = scope:liege0
		}
		add_prestige = medium_prestige_gain
	}
	option = {
		name = ev2.2.d
		stress_impact = {
			ambitious = major_stress_gain
			lazy = major_stress_loss
			trusting = minor_stress_loss
			craven = minor_stress_loss
			content = medium_stress_loss
			compassionate = minor_stress_loss
		}
	}
}

#ring of life special - war
magic_ev6.37 = {
	hidden = yes
	trigger = {
		is_ai = yes
		is_imprisoned = no
		OR = {
			highest_held_title_tier = tier_empire
			highest_held_title_tier = tier_kingdom
		}
		any_ruler = {
			is_ai = no
			any_character_artifact = {
				has_variable = magic_ring0
				has_artifact_modifier = artifact_ring_of_life_modifier
			}
		}
	}
	immediate = {
		random_ruler = {
			limit = {
				is_ai = no
				is_at_war = yes
				any_character_artifact = {
					has_variable = magic_ring0
					has_artifact_modifier = artifact_ring_of_life_modifier
				}
			}
			save_scope_as = war_target0
			random_character_artifact = {
				limit = {
					has_variable = magic_ring0
					has_artifact_modifier = artifact_ring_of_life_modifier
				}
				save_scope_as = thering0
			}
		}
		if = {
			limit = {
				in_diplomatic_range = scope:war_target0
				NOT = {
					any_ally = {
						THIS = scope:war_target0
					}
				}
			}
			if = {
				limit = {
					NOT = {
						has_personal_artifact_claim = scope:thering0
					}
				}
				add_personal_artifact_claim = scope:thering0
			}
			if = {
				limit = {
					is_at_war = no
					scope:war_target0 = {
						is_at_war = yes
					}
				}
				start_war = {
					casus_belli = artifact_war
					target = scope:war_target0
					#target_title = scope:kkkingdom
				}
			}
			else_if = {
				limit = {
					is_at_war = no
					max_military_strength > scope:war_target0.max_military_strength
				}
				start_war = {
					casus_belli = artifact_war
					target = scope:war_target0
					#target_title = scope:kkkingdom
				}
			}
			else = {
				start_scheme = {
					type = steal_back_artifact
					target = scope:war_target0
					artifact = scope:thering0
				}
			}
		}
	}
}

#magical threats - 1 - magic flu
magic_ev6.38 = {
	title = ev6.38.title
	desc = ev6.38.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = sick
	}
	trigger = {
		has_trait = archmage
	}
	immediate = {
		add_character_modifier = {
			modifier = magic_flu_modifier
			years = { 2 4 }
		}
	}
	
	option = {
		name = ev6.38.0.a
	}
}

#magical threats - 2 - am I dominated?
magic_ev6.39 = {
	title = ev6.39.title
	desc = ev6.39.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = paranoia
	}
	trigger = {
		has_trait = archmage
		has_full_magic_prot_trigger = no
	}
	
	option = {
		name = ev6.39.0.a
		if = {
			limit = {
				has_trait = paranoid
			}
			stress_impact = {
				paranoid = massive_stress_gain
			}
		}
		else = {
			add_stress = medium_stress_gain
		}
		
		if = {
			limit = {
				NOR = {
					has_trait = paranoid
					has_trait = trusting
				}
			}
			random = {
				chance = 5
				add_trait = paranoid
			}
		}
	}
}

#magical threats - 3 - corruption
magic_ev6.40 = {
	title = ev6.40.title
	desc = ev6.40.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = grief
	}
	trigger = {
		has_trait = archmage
		NOR = {
			has_trait = source
			has_trait = source2
			has_trait = source3
			has_trait = source4
			has_trait = disfigured
			has_trait = demon
		}
	}
	option = {
		name = ev5.28.0.z6
		add_trait = disfigured
		if = {
			limit = {
				NOT = {
					has_trait = corrupted
				}
			}
			add_trait = corrupted
		}
	}
	option = {
		name = ev6.40.0.a
		remove_short_term_gold = {
			add = demon_gold_value
		}
		custom_tooltip = ev6.40.0.a_ct
		hidden_effect = {
			random = {
				chance = 75
				trigger_event = {
					id = magic_ev6.40
					years = { 9 15 }
				}
			}
		}
	}
	option = {
		name = ev6.40.0.b
		trigger = {
			has_trait = compassionate
		}
		trait = compassionate
	}
}

#magical threats - 4 - weak source
magic_ev6.41 = {
	title = ev6.41.title
	desc = ev6.41.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = grief
	}
	trigger = {
		has_trait = archmage
		has_trait = source
		has_trait_xp = {
			trait = archmage
			track = secret_knowledge
			value < 100
		}
	}
	option = {
		name = ev6.41.0.a
		random = {
			chance = 50
			remove_trait = source
		}
	}
	option = {
		name = ev6.40.0.a
		remove_short_term_gold = {
			add = demon_gold_value
		}
		random = {
			chance = 10
			remove_trait = source
		}
	}
	option = {
		name = ev6.41.0.b
		trigger = {
			has_trait = intellect_good_3
			NOT = {
				has_trait = scholar
			}
		}
		trait = intellect_good_3
	}
	option = {
		name = ev6.41.0.b
		trigger = {
			has_trait = scholar
		}
		trait = scholar
	}
	option = {
		name = ev6.41.0.c
		trigger = {
			any_character_artifact = { has_variable = blackgrimoire }
		}
	}
}

#endgame crisis - abdul ahazred
magic_ev6.42 = {
	title = ev6.42.title
	desc = ev6.42.desc
	theme = realm
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:abdul
	}
	trigger = {
		location = capital_province
	}
	immediate = {
		hidden_effect = {
			create_abdul_alhazred_effect = yes
		}
	}
	option = {
		#Hi
		name = ev6.42.0.a
		trigger_event = magic_ev6.43
	}
}
#endgame crisis - abdul ahazred - I am archmage bla bla
magic_ev6.43 = {
	title = ev6.43.title
	desc = ev6.43.desc
	theme = realm
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:abdul
	}
	
	option = {
		#nice to meet you
		name = ev6.43.0.a
		trigger_event = magic_ev6.44
	}
}
#endgame crisis - abdul ahazred - I want your artifacts
magic_ev6.44 = {
	title = ev6.43.title
	desc = ev6.44.desc
	theme = realm
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:abdul
	}
	
	option = {
		#and in return?
		name = ev6.44.0.a
		trigger_event = magic_ev6.45
	}
}
#endgame crisis - abdul ahazred - my friendship ;)
magic_ev6.45 = {
	title = ev6.43.title
	desc = ev6.45.desc
	theme = realm
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:abdul
	}
	
	option = {
		#That doesn't sound very friendly.
		name = ev6.45.0.a
		trigger_event = magic_ev6.46
	}
}
#endgame crisis - abdul ahazred - you are fool
magic_ev6.46 = {
	title = ev6.43.title
	desc = ev6.46.desc
	theme = realm
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:abdul
	}
	
	option = {
		#There is enough room for both of us.
		name = ev6.46.0.a
		trigger_event = magic_ev6.47
	}
	option = {
		#We'll see who the fool is when I'm done with you.
		name = ev6.46.0.b
		trigger_event = magic_ev6.47
	}
}
#endgame crisis - abdul ahazred - you have one month
magic_ev6.47 = {
	title = ev6.43.title
	desc = ev6.47.desc
	theme = realm
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:abdul
	}
	
	option = {
		#well...
		name = ev6.47.0.a
		progress_towards_rival_effect = {
			CHARACTER = scope:abdul
			OPINION = 0
			REASON = rival_random_m1
		}
	}
	after = {
		hidden_effect = {
			save_scope_as = player_mage
			dynasty = {
				set_variable = legion2
			}
			trigger_event = {
				id = magic_ev6.48
				months = 1
			}
			scope:abdul = {
				trigger_event = {
					id = magic_ev6.51
					months = 2
				}
				add_character_flag = {
					flag = not_ready_for_duel_yet
					months = 3
				}
			}
			trigger_event = {
				id = magic_ev6.53
				months = 3
			}
			trigger_event = {
				id = magic_ev6.55
				months = { 4 5 }
			}
			trigger_event = {
				id = magic_ev6.56
				months = 6
			}
			trigger_event = {
				id = magic_ev6.65
				months = 9
			}
			random_neighboring_and_across_water_top_liege_realm_owner = {
				add_courtier = scope:abdul
				add_opinion = {
					modifier = disgusted_opinion
					target = root
					opinion = -200
				}
				add_opinion = {
					modifier = respect_opinion
					target = scope:abdul
					opinion = 200
				}
				save_scope_as = ruler0
			}
			if = {
				limit = {
					has_hook = scope:ruler0
				}
				remove_hook = {
					target = scope:ruler0
				}
			}
			scope:abdul = {
				add_opinion = {
					modifier = rival_magic_modifier
					target = root
				}
			}
		}
	}
}
#endgame crisis - summoned demon
magic_ev6.48 = {
	title = witch.3003.t
	desc = ev6.48.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:demona
	}
	trigger = {
		any_living_character = {
			has_character_flag = abdul_dude
			is_imprisoned = no
		}
	}
	immediate = {
		hidden_effect = {
			create_character = {
				location = root.location
				faith = root.faith
				culture = root.culture
				gender_female_chance = 30
				template = generic_demon_character
				save_scope_as = demona
				after_creation = {
					set_sexuality = bisexual
					give_witch_secret_or_trait_effect = yes
					add_trait_xp = {
						trait = demon
						value = 60
					}
					add_character_flag = summoned_by_abdul_flag
				}
			}
		}
	}
	
	option = {
		name = ev5.60.0.a
		trigger_event = magic_ev6.49
	}
}
#endgame crisis - summoned demon2
magic_ev6.49 = {
	title = witch.3003.t
	desc = ev6.49.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:demona
	}
	
	
	option = {
		name = ev6.49.0.a
		custom_tooltip = start_duel_ct
		configure_start_mage_duel_effect = {
			MD_ATTACKER = root
			MD_DEFENDER = scope:demona
		}
	}
	option = {
		name = ev6.49.0.b
		trigger = {
			any_character_artifact = {
				has_variable = blackgrimoire
			}
			can_spend_standard_ps_trigger = yes
		}
		custom_tooltip = ev6.49.0.b_ct
		show_as_tooltip = {
			spend_standard_ps_effect = yes
		}
		trigger_event = magic_ev6.50
	}
}
#endgame crisis - summoned demon3
magic_ev6.50 = {
	title = witch.3003.t
	desc = ev6.50.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:demona
	}
	
	
	option = {
		name = ev4.36.0.a
		custom_tooltip = start_duel_ct
		configure_start_mage_duel_effect = {
			MD_ATTACKER = root
			MD_DEFENDER = scope:demona
		}
	}
}

#al-hazred as ruler
magic_ev6.51 = {
	hidden = yes
	trigger = {
		is_alive = yes
	}
	immediate = {
		if = {
			limit = {
				is_imprisoned = yes
			}
			release_from_prison = yes
		}
		random_ruler = {
			limit = {
				any_held_title = {
					tier = tier_empire
					is_titular = no
				}
				is_ai = yes
				NOR = {
					has_trait = archmage
					has_trait = demon
				}
			}
			save_scope_as = atarget
		}
		if = {
			limit = {
				NOT = {
					exists = scope:atarget
				}
			}
			random_ruler = {
				limit = {
					any_held_title = {
						tier = tier_kingdom
						is_titular = no
					}
					is_ai = yes
					NOR = {
						has_trait = archmage
						has_trait = demon
					}
				}
				save_scope_as = atarget
			}
		}
		if = {
			limit = {
				NOT = {
					exists = scope:atarget
				}
			}
			random_ruler = {
				limit = {
					any_held_title = {
						is_titular = no
					}
					is_ai = yes
					NOR = {
						has_trait = archmage
						has_trait = demon
					}
				}
				save_scope_as = atarget
			}
		}
		scope:atarget = {
			primary_title = {
				save_scope_as = emp_tit
			}
		}
		scope:atarget = {
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = title_change
				add_claim_on_loss = yes
			}
			every_held_title = {
				limit = {
					is_titular = no
					is_leased_out = no
					is_head_of_faith = no
					tier >= tier_county
				}
				change_title_holder_include_vassals = {
					holder = root
					change = scope:title_change
				}
			}
			resolve_title_and_vassal_change = scope:title_change
		}
		every_vassal = {
			limit = {
				is_ai = yes
			}
			set_relation_mmaster = scope:abdul
			scope:abdul = {
				add_hook = {
					type = magic_domination_hook
					target = PREV
				}
			}
		}
		every_courtier = {
			set_relation_mmaster = scope:abdul
			scope:abdul = {
				add_hook = {
					type = magic_domination_hook
					target = PREV
				}
			}
		}
		add_gold = 20000
		add_prestige_level = 3
		create_artifact = {	
			name = pot2
			description = pot2_desc
			template=general_unique_template
			type = miscellaneous
			visuals = flask
			modifier = elixir_modifier
			rarity=illustrious
			decaying = no
			save_scope_as = newly_created_artifact2
		}
		scope:newly_created_artifact2={
			set_variable=pot2
		}
		spawn_army = {
			name = undead_army_loc
			men_at_arms = {
				type = skeletons
				stacks = 250
			}
			inheritable = no
			uses_supply = no
			location = root.capital_province
		}
		create_ancient_singularity_v2_effect = { OWNER = root }
		set_character_faith = scope:atarget.faith
		

		trigger_event = {
			id = magic_ev6.52
			months = 3
		}
		primary_title = {
			set_title_name = alhazred_house
		}
		scope:newly_created_artifact = {
			equip_artifact_to_owner_replace = yes
		}
		scope:atarget = {
			death = natural
		}
		add_opinion = {
			target = scope:player_mage
			modifier = rival_magic_modifier
			years = 100
		}
	}
}

#al-hazred management
magic_ev6.52 = {
	hidden = yes
	trigger = {
		is_alive = yes
	}
	immediate = {
		if = {
			limit = {
				is_imprisoned = no
				is_landed = yes
			}
			random_neighboring_and_across_water_top_liege_realm_owner = {
				limit = {
					primary_title = {
						is_titular = no
					}
				}
				primary_title = {
					save_scope_as = titi
				}
				save_scope_as = sruler
			}
			if = {
				limit = {
					OR = {
						scope:sruler = {
							is_ai = no
						}
						scope:titi = {
							tier = tier_empire
						}
					}
				}
				if = {
					limit = {
						NOT = {
							has_claim_on = scope:titi
						}
					}
					add_pressed_claim = scope:titi
				}
			}
			else_if = {
				limit = {
					scope:sruler = {
						has_full_magic_prot_trigger = no
						NOT = {
							is_at_war_with = root
						}
					}
				}
				create_title_and_vassal_change = {
					type = swear_fealty
					save_scope_as = change
				}
				scope:sruler = {
					change_liege = {
						liege = root
						change = scope:change
					}
					add_opinion = {
						modifier = became_vassal
						target = root
						opinion = 10
					}
				}
				resolve_title_and_vassal_change = scope:change
				scope:sruler = {
					set_relation_mmaster = root
				}
				
				add_hook = {
					type = magic_domination_hook
					target = scope:sruler
				}
			}
			
			if = {
				limit = {
					can_be_power_saturated_trigger = yes
				}
				gain_standard_ps_effect = yes
			}
			every_character_war = {
				limit = {
					OR = {
						primary_attacker = root
						primary_defender = root
					}
				}
				if = {
					limit = {
						primary_attacker = root
						NOT = {
							any_war_defender = {
								is_ai = no
							}
						}
					}
					end_war = attacker
				}
				else_if = {
					limit = {
						primary_defender = root
						NOT = {
							any_war_attacker = {
								is_ai = no
							}
						}
					}
					end_war = defender
				}
			}
			
			massive_kill_player_dynasty = yes
			random = {
				chance = 10
				spawn_army = {
					name = undead_army_loc
					men_at_arms = {
						type = skeletons
						stacks = 10
					}
					inheritable = no
					uses_supply = no
					location = root.capital_province
				}
			}
			if = {
				limit = {
					has_trait = wounded_1
				}
				remove_trait = wounded_1
			}
			if = {
				limit = {
					has_trait = wounded_2
				}
				remove_trait = wounded_2
			}
			if = {
				limit = {
					has_trait = wounded_3
				}
				remove_trait = wounded_3
			}
			if = {
				limit = {
					NOR = {
						any_relation = {
							type = rival
							has_trait = archmage
						}
						any_relation = {
							type = nemesis
							has_trait = archmage
						}
					}
				}
				if = {
					limit = {
						any_ruler = {
							has_trait = archmage
							NOT = {
								THIS = ROOT
							}
						}
					}
					random_ruler = {
						limit = {
							has_trait = archmage
							NOT = {
								THIS = ROOT
							}
						}
						save_scope_as = new_mage
					}
					set_relation_rival = scope:new_mage
				}
			}
		}
		if = {
			limit = {
				is_imprisoned = no
			}
			every_targeting_scheme = {
				limit = {
					is_hostile = yes
				}
				save_scope_as = sssheme
				scheme_owner = {
					trigger_event = {
						id = magic_ev6.54
						days = { 2 6 }
					}
				}
			}
		}
		
		trigger_event = {
			id = magic_ev6.52
			months = { 8 9 }
		}
	}
}

#endgame crisis - letter from Al-Hazred
magic_ev6.53 = {
	type = letter_event
	opening = ev6.53.opening
	desc = ev6.53.desc
	sender = scope:abdul

	trigger = {
		any_living_character = {
			has_character_flag = abdul_dude
			is_imprisoned = no
		}
	}
	immediate = {
		random_living_character = {
			limit = {
				has_character_flag = abdul_dude
				is_imprisoned = no
			}
			save_scope_as = abdul
		}
		
	}

	option = {
		name = ev6.53.0.a
		
	}
}

#Al-Hazred removes schemes
magic_ev6.54 = {
	type = letter_event
	opening = ev6.53.opening
	desc = ev6.54.desc
	sender = scope:abdul

	trigger = {
		any_living_character = {
			has_character_flag = abdul_dude
			is_imprisoned = no
		}
	}
	

	option = {
		#Damn it!
		name = artifact.4050.a
		scope:sssheme = {
			end_scheme = yes
		}
	}
}

#endgame crisis - curse your heir
magic_ev6.55 = {
	title = cursed_modifier
	desc = ev6.55.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = player_heir
	}
	trigger = {
		any_living_character = {
			has_character_flag = abdul_dude
			is_imprisoned = no
		}
		exists = player_heir
	}
	immediate = {
		player_heir = {
			if = {
				limit = {
					NOR = {
						has_trait = wounded_3
						has_trait = wounded_2
						has_trait = wounded_1
					}
				}
				add_trait = wounded_2
			}
			if = {
				limit = {
					NOT = {
						has_trait = incapable
					}
				}
				add_trait = incapable
			}
			if = {
				limit = {
					NOT = {
						has_trait = lunatic_genetic
					}
				}
				add_trait = lunatic_genetic
			}
			if = {
				limit = {
					NOT = {
						has_character_modifier = cursed_modifier
					}
				}
				add_character_modifier = {
					modifier = cursed_modifier
					years = 2
				}
			}
		}
	}
	
	option = {
		name = ev6.55.0.a
		add_stress = medium_stress_gain
		if = {
			limit = {
				NOR = {
					has_relation_nemesis = scope:abdul
					has_relation_rival = scope:abdul
				}
			}
			set_relation_rival = scope:abdul
		}
	}
}

#endgame crisis - Duplicate
magic_ev6.56 = {
	title = ev6.56.title
	desc = ev6.56.desc
	theme = realm
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:rconc
		animation = shock
	}
	trigger = {
		any_living_character = {
			has_character_flag = abdul_dude
			is_imprisoned = no
		}
		any_councillor = {
			is_imprisoned = no
		}
		is_imprisoned = no
	}
	immediate = {
		hidden_effect = {
			random_councillor = {
				limit = {
					is_imprisoned = no
				}
				save_scope_as = rconc
			}
		}
	}
		
	option = {
		name = ev6.56.0.a
		custom_tooltip = ev6.56.0.a_ct
		trigger_event = magic_ev6.57
	}
}
#endgame crisis - Duplicate2
magic_ev6.57 = {
	title = ev6.56.title
	desc = ev6.57.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = root
	}
			
	option = {
		#who the hell are you?
		name = ev5.34.0.a
		trigger_event = magic_ev6.58
	}
}
#endgame crisis - Duplicate3 - I helped you...
magic_ev6.58= {
	title = ev6.43.title
	desc = ev6.58.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:abdul
	}
	
	immediate = {
		hidden_effect = {
			random_living_character = {
				limit = {
					has_character_flag = abdul_dude
				}
				save_scope_as = abdul
			}
		}
	}
		
	option = {
		#Bastard! What have you done?!
		name = court.4701.b
		trigger_event = magic_ev6.59
	}
}
#endgame crisis - Duplicate4A - vassals
magic_ev6.59= {
	title = ev6.43.title
	desc = ev6.59.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = disgust
	}
	right_portrait = {
		character = scope:abdul
		animation = scheme
	}
	immediate = {
		every_vassal = {
			limit = {
				is_powerful_vassal = yes
			}
			add_opinion = {
				modifier = insult_opinion
				target = root
				opinion = -100
			}
		}
	}
		
	option = {
		#...
		#name = ev6.59.0.a
		name = harm.0541.a
		trigger_event = magic_ev6.60
	}
}
#endgame crisis - Duplicate4B - gold
magic_ev6.60= {
	title = ev6.43.title
	desc = ev6.60.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = anger
	}
	right_portrait = {
		character = scope:abdul
		animation = scheme
	}
	immediate = {
		if = {
			limit = {
				gold > 0
			}
			remove_short_term_gold = {
				add = gold
			}
		}
		else = {
			remove_short_term_gold = {
				add = 500
			}
		}
	}
		
	option = {
		#...!
		name = ev6.60.0.a
		trigger_event = magic_ev6.61
	}
}
#endgame crisis - Duplicate4C - tyranny
magic_ev6.61= {
	title = ev6.43.title
	desc = ev6.61.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = anger
	}
	right_portrait = {
		character = scope:abdul
		animation = eyeroll
	}
	immediate = {
		add_tyranny = massive_tyranny_gain
		add_piety_level = -1
		stress_impact = {
			compassionate = major_stress_gain
		}
		if = {
			limit = {
				NOT = {
					has_character_modifier = intrigue_horrifying_executions_modifier
				}
			}
			add_character_modifier = {
				modifier = intrigue_horrifying_executions_modifier
				years = 4
			}
		}
	}
		
	option = {
		#You... you...
		name = ev6.61.0.a
		trigger = {
			OR = {
				exists = primary_spouse
				exists = primary_partner
			}
		}
		trigger_event = magic_ev6.62
		
	}
	option = {
		#That's enough - die!
		name = ev6.61.0.b
		trigger = {
			NOR = {
				exists = primary_spouse
				exists = primary_partner
			}
		}
		custom_tooltip = ev6.61.0.b_ct
		trigger_event = magic_ev6.63
	}
}
#endgame crisis - Duplicate4D - wife
magic_ev6.62= {
	title = ev6.43.title
	desc = ev6.62.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = rage
	}
	right_portrait = {
		character = scope:abdul
		animation = toast_goblet
	}
	lower_right_portrait = scope:target
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					exists = primary_spouse
				}
				primary_spouse = {
					save_scope_as = target
				}
			}
			else_if = {
				limit = {
					exists = primary_partner
				}
				primary_partner = {
					save_scope_as = target
				}
			}
		}
		scope:abdul = {
			had_sex_with_effect = {
				CHARACTER = scope:target
				PREGNANCY_CHANCE = seduce_pregnancy_chance
			}
		}
	}
	option = {
		#That's enough - die!
		name = ev6.61.0.b
		custom_tooltip = ev6.61.0.b_ct
		trigger_event = magic_ev6.63
	}
}
#endgame crisis - Duplicate5 - final
magic_ev6.63= {
	title = ev6.43.title
	desc = ev6.63.desc
	theme = witchcraft
	left_portrait = {
		character = root
		animation = anger
	}
	#right_portrait = {
	#	character = scope:abdul
		#animation = toast
	#}
	immediate = {
		scope:abdul = {
			if = {
				limit = {
					NOR = {
						has_trait = wounded_3
						has_trait = wounded_2
						has_trait = wounded_1
					}
				}
				add_trait = wounded_1
			}
		}
	}
	
	option = {
		#You will pay
		name = ev6.63.0.a
		set_relation_nemesis = scope:abdul
	}
}

#ancient singularity - retaliation from Al-Hazred
magic_ev6.64 = {
	title = ev6.64.title
	desc = ev6.64.desc
	theme = realm
	left_portrait = {
		character = root
		animation = shock
	}
	trigger = {
		is_alive = yes
	}
	immediate = {
		every_living_character = {
			limit = {
				exists = location
				location = root.location
				has_full_magic_prot_trigger = no
				NOT = {
					THIS = ROOT
				}
			}
			random_list = {
				80 = {
					death = {
						death_reason = death_murder
						killer = scope:recipient
					}
				}
				5 = {
					add_trait = incapable
				}
				5 = {
					add_trait = cancer
					add_trait = wounded_2
					add_trait = infertile
				}
				3 = {
					add_trait = cancer
					add_trait = wounded_1
					add_trait = disfigured
					add_trait = infertile
				}
				2 = {
					add_trait = cancer
					add_trait = wounded_1
					add_trait = lunatic_1
					add_trait = infertile
				}
				5 = {
					add_trait = cancer
					add_trait = wounded_1
					add_trait = blind
					add_trait = infertile
				}
			}
		}
		location = {
			add_province_modifier = {
				modifier = magical_radiation_modifier
				years = 50
			}
			county = {
				change_development_level = -50
			}
		}
	}
	
	option = {
		name = ev37.0.a
		if = {
			limit = {
				has_full_magic_prot_trigger = no
			}
			death = {
				death_reason = death_murder
				killer = scope:recipient
			}
		}
	}
}

#endgame crisis - more assasins
magic_ev6.65 = {
	title = ev6.65.title
	desc = ev6.65.desc
	theme = realm
	left_portrait = {
		character = root
	}
	right_portrait = {
		character = scope:rconc
		animation = shock
	}
	trigger = {
		any_living_character = {
			has_character_flag = abdul_dude
			is_imprisoned = no
		}
		any_councillor = {
			is_imprisoned = no
		}
		is_imprisoned = no
	}
	immediate = {
		hidden_effect = {
			random_councillor = {
				limit = {
					is_imprisoned = no
				}
				save_scope_as = rconc
			}
			random_child = {
				save_scope_as = child0
			}
			random_ruler = {
				limit = {
					is_ai = yes
					in_diplomatic_range = root
					has_trait = schemer
				}
				start_scheme = {
					type = murder
					target = scope:child0
				}
			}
		}
	}
		
	option = {
		name = ev6.65.0.a
		house = {
			add_house_modifier = {
				modifier = bounty_for_head_modifier
				years = 10
			}
		}
	}
}

#consume child interaction - people get suspicious
magic_ev6.66 = {
	title = ev6.66.title
	desc = ev6.66.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	trigger = {
		is_imprisoned = no
	}
	immediate = {
		every_vassal = {
			limit = {
				is_ai = yes
				NOR = {
					has_trait = cannibal
					any_secret = {
						secret_type = secret_cannibal
					}
					has_trait = true_witch
				}
			}
			add_opinion = {
				target = ROOT
				modifier = suspicion_opinion
				opinion = -40
			}
		}
		every_courtier = {
			limit = {
				is_ai = yes
				NOR = {
					has_trait = cannibal
					any_secret = {
						secret_type = secret_cannibal
					}
					has_trait = true_witch
				}
			}
			add_opinion = {
				target = ROOT
				modifier = suspicion_opinion
				opinion = -40
			}
		}
		every_neighboring_and_across_water_realm_same_rank_owner = {
			limit = {
				is_ai = yes
				NOR = {
					has_trait = cannibal
					any_secret = {
						secret_type = secret_cannibal
					}
					has_trait = true_witch
				}
			}
			add_opinion = {
				target = ROOT
				modifier = suspicion_opinion
				opinion = -40
			}
		}
		if = {
			limit = {
				exists = liege
				NOT = {
					liege = root
				}
			}
			liege = {
				add_opinion = {
					target = ROOT
					modifier = suspicion_opinion
					opinion = -40
				}
			}
		}
	}
		
	option = {
		name = ev6.66.0.a
	}
}

#complications with DarkBlade
magic_ev6.67 = {
	title = dark_blade
	desc = ev6.67.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	trigger = {
		is_imprisoned = no
		any_courtier_or_guest = {
			is_adult = yes
			NOR = {
				has_character_flag = special_magic_character
				has_trait = demon
			}
			count > 4
		}
	}
	immediate = {
		hidden_effect = {
			random_courtier_or_guest = {
				limit = {
					is_adult = yes
					NOR = {
						has_character_flag = special_magic_character
						has_trait = demon
					}
				}
				save_scope_as = rc1
			}
			random_courtier_or_guest = {
				limit = {
					is_adult = yes
					NOR = {
						has_character_flag = special_magic_character
						has_trait = demon
					}
				}
				save_scope_as = rc2
			}
			random_secret = {
				limit = {
					secret_type = secret_murder
					secret_target = scope:recipient
				}
				save_scope_as = sec
			}
		}
		
	}
		
	option = {
		#I'm going to try to sneak out
		name = ev5.31.0.b
		duel = {
			skill = intrigue
			value = 20
			5 = {
				desc = ev3.52.a_1
				compare_modifier = {
					value = scope:duel_value
					multiplier = 2
					min = 0
				}
				
				send_interface_toast = {
					title=ev3.52.a_1
				}
			}
			5 = {
				desc = ev3.52.a_2
				compare_modifier = {
					value = scope:duel_value
					multiplier = -2
					min = 0
				}
				send_interface_toast = {
					title=ev3.52.a_2
					scope:sec = {
						expose_secret = scope:rc1
					}
				}
			}
		}
	}
	option = {
		#If they start asking questions, I'll kill them too.
		name = ev6.67.0.a
		stress_impact = {
			compassionate = massive_stress_gain
			just = major_stress_gain
			sadistic = minor_stress_loss
		}
		if = {
			limit = {
				scope:rc1=scope:rc2
			}
			scope:rc1 = {
				death = {
					death_reason = death_murder
					killer = root
				}
			}
			hidden_effect = {
				add_secret = {
					type = secret_murder
					target = scope:rc1
				}
			}
		}
		else = {
			scope:rc1 = {
				death = {
					death_reason = death_murder
					killer = root
				}
			}
			hidden_effect = {
				add_secret = {
					type = secret_murder
					target = scope:rc1
				}
			}
			scope:rc2 = {
				death = {
					death_reason = death_murder
					killer = root
				}
			}
			hidden_effect = {
				add_secret = {
					type = secret_murder
					target = scope:rc2
				}
			}
		}
		dark_blade_grows_stronger = yes
		hidden_effect = {
			random = {
				chance = 90
				trigger_event = magic_ev6.68
			}
		}
	}
	option = {
		#I'm not going to keep it a secret anyway.
		name = ev6.67.0.b
		stress_impact = {
			honest = medium_stress_loss
			deceitful = medium_stress_gain
		}
		add_dread = medium_dread_gain
		scope:sec = {
			expose_secret = root
		}
	}
	option = {
		#It's my business what I do in my dungeons.
		name = ev6.67.0.c
		trigger = {
			has_trait = overseer
			NOT = {
				has_trait = torturer
			}
		}
		trait = overseer
		add_tyranny = minor_tyranny_gain
	}
	option = {
		#It's my business what I do in my dungeons.
		name = ev6.67.0.c
		trigger = {
			has_trait = torturer
		}
		trait = torturer
		add_tyranny = minor_tyranny_gain
		add_dread = minor_dread_gain
	}
}
#complications with DarkBlade - 2
magic_ev6.68 = {
	title = dark_blade
	desc = ev6.68.desc
	theme = witchcraft
	left_portrait = {
		character = root
	}
	trigger = {
		is_imprisoned = no
		any_courtier_or_guest = {
			is_adult = yes
			NOR = {
				has_character_flag = special_magic_character
				has_trait = demon
			}
			count > 4
		}
	}
	immediate = {
		hidden_effect = {
			random_courtier_or_guest = {
				limit = {
					is_adult = yes
					NOR = {
						has_character_flag = special_magic_character
						has_trait = demon
					}
				}
				add_to_list = vics
			}
			random_courtier_or_guest = {
				limit = {
					is_adult = yes
					NOR = {
						has_character_flag = special_magic_character
						has_trait = demon
					}
				}
				add_to_list = vics
			}
			random_courtier_or_guest = {
				limit = {
					is_adult = yes
					NOR = {
						has_character_flag = special_magic_character
						has_trait = demon
					}
				}
				add_to_list = vics
			}
		}
		
	}
		
	option = {
		#Well, they will also die.
		name = ev6.68.0.a
		stress_impact = {
			compassionate = massive_stress_gain
			just = major_stress_gain
			sadistic = minor_stress_loss
		}
		every_in_list = {
			list = vics
			death = {
				death_reason = death_murder
				killer = root
			}
			save_scope_as = vic
			hidden_effect = {
				ROOT = {
					add_secret = {
						type = secret_murder
						target = scope:vic
					}
				}
			}
		}
		dark_blade_grows_stronger = yes
		every_vassal = {
			limit = {
				is_ai = yes
			}
			add_opinion = {
				target = ROOT
				modifier = suspicion_opinion
				opinion = -40
			}
		}
		if = {
			limit = {
				exists = liege
				NOT = {
					liege = root
				}
			}
			liege = {
				add_opinion = {
					target = ROOT
					modifier = suspicion_opinion
					opinion = -40
				}
			}
		}
	}
	option = {
		#I confess
		name = ev6.68.0.b
		add_dread = massive_dread_gain
		stress_impact = {
			honest = medium_stress_loss
			deceitful = medium_stress_gain
		}
		every_secret = {
			limit = {
				secret_type = secret_murder
			}
			expose_secret = root
		}
	}
}

#nickname
magic_ev6.69 = {
	hidden = yes
	trigger = {
		has_trait = archmage
		is_ai = no
		NOR = {
			has_character_flag = special_magic_character
			has_nickname = mage_nickname
			has_nickname = mage2_nickname
			has_nickname = mage3_nickname
			has_nickname = mage4m_nickname
			has_nickname = mage5m_nickname
			has_nickname = mage6m_nickname
			has_nickname = mage4f_nickname
			has_nickname = mage5f_nickname
			has_nickname = demonslayer_nickname
		}
	}
	immediate = {
		if = {
			limit = {
				OR = {
					has_bad_nickname = yes
					has_any_nickname = no
				}
			}
			if = {
				limit = {
					is_male = yes
				}
				random_list = {
					1 = { give_nickname = mage_nickname }
					1 = { give_nickname = mage2_nickname }
					1 = { give_nickname = mage3_nickname }
					1 = {
						trigger = {
							OR = {
								highest_held_title_tier = tier_empire
								highest_held_title_tier = tier_kingdom
							}
						}
						give_nickname = mage4m_nickname
					}
					1 = { give_nickname = mage5m_nickname }
					2 = {
						trigger = {
							any_held_county = {
								exists = title_province
								title_province = {
									has_building_or_higher = mage_tower_02
								}
							}
						}
						give_nickname = mage6m_nickname
					}
				}
			}
			else = {
				random_list = {
					1 = { give_nickname = mage_nickname }
					1 = { give_nickname = mage2_nickname }
					1 = { give_nickname = mage3_nickname }
					1 = {
						trigger = {
							OR = {
								highest_held_title_tier = tier_empire
								highest_held_title_tier = tier_kingdom
							}
						}
						give_nickname = mage4f_nickname
					}
					1 = { give_nickname = mage5f_nickname }
				}
			}
			
		}
		else = {
			random = {
				chance = 1
				if = {
					limit = {
						is_male = yes
					}
					random_list = {
						1 = { give_nickname = mage_nickname }
						1 = { give_nickname = mage2_nickname }
						1 = { give_nickname = mage3_nickname }
						1 = {
							trigger = {
								OR = {
									highest_held_title_tier = tier_empire
									highest_held_title_tier = tier_kingdom
								}
							}
							give_nickname = mage4m_nickname
						}
						1 = { give_nickname = mage5m_nickname }
						2 = {
							trigger = {
								any_held_county = {
									exists = title_province
									title_province = {
										has_building_or_higher = mage_tower_02
									}
								}
							}
							give_nickname = mage6m_nickname
						}
					}
				}
				else = {
					random_list = {
						1 = { give_nickname = mage_nickname }
						1 = { give_nickname = mage2_nickname }
						1 = { give_nickname = mage3_nickname }
						1 = {
							trigger = {
								OR = {
									highest_held_title_tier = tier_empire
									highest_held_title_tier = tier_kingdom
								}
							}
							give_nickname = mage4f_nickname
						}
						1 = { give_nickname = mage5f_nickname }
					}
				}
			}
		}
	}
}

#Samael vs Al-Hazred
magic_ev6.70 = {
	title = ev3.1.title
	desc = ev6.70.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
	}

	trigger = {
		is_alive = yes
	}

	option = {
		#What can you offer me?
		name = ev3.102.a
		trigger_event = magic_ev3.3
	}
	option = {
		#fulfil my will!
		name = ev6.70.0.a
		trigger_event = magic_ev3.4
	}
}

#Mage Tower selection
magic_ev6.71 = {
	title = building_mage_tower_01
	desc = ev6.71.desc
	theme = witchcraft
	left_portrait = root

	trigger = {
		is_alive = yes
		is_landed = yes
		NOT = {
			any_held_county = {
				exists = title_province
				title_province = {
					OR = {
						has_building_or_higher = mage_tower_02
						has_variable = prepared_for_tower_constr
					}
					
				}
			}
		}
	}
	immediate = {
		hidden_effect = {
			random_held_county = {
				limit = {
					title_province = {
						has_special_building_slot = no
					}
				}
				if = {
					limit = {
						exists = this
					}
					title_province = {
						save_scope_as = place1
					}
				}
			}
			if = {
				limit = {
					exists = scope:place1
				}
				random_held_county = {
					limit = {
						title_province = {
							has_special_building_slot = no
							NOT = {
								THIS = scope:place1
							}
						}
					}
					if = {
						limit = {
							exists = this
						}
						title_province = {
							save_scope_as = place2
						}
					}
				}
			}
			
		}
	}

	option = {
		name = ev6.71.0.b
		trigger = {
			exists = scope:place1
		}
		scope:place1 = {
			add_special_building_slot = mage_tower_02
			set_variable = prepared_for_tower_constr
		}
	}
	option = {
		name = ev6.71.0.c
		trigger = {
			exists = scope:place2
		}
		scope:place2 = {
			add_special_building_slot = mage_tower_02
			set_variable = prepared_for_tower_constr
		}
		
	}
	option = {
		name = ev6.71.0.d
		add_character_modifier = {
			modifier = magic_lab_modifier
		}
	}
	option = {
		name = ev6.71.0.e
		custom_tooltip = ev6.71.0.e_ct
		trigger_event = {
			id = magic_ev6.71
			years = 10
		}
	}
}

#Belial bad ending 2
magic_ev6.72 = {
	title = ev15.0.title
	desc = ev6.72.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:belial
	
	option = {
		name = ev27.0.a
		add_stress = minor_stress_gain
	}
	after = {
		hidden_effect = {
			scope:belial = {
				death = natural
			}
		}
		clear_saved_scope = belial
	}
}

#nickname from magic epic
magic_ev6.73 = {
	title = ev3.22.title
	desc = ev6.73.desc
	theme = realm
	left_portrait = root
	right_portrait = scope:rconc
	trigger = {
		has_trait = archmage
		is_ai = no
		is_imprisoned = no
		NOR = {
			has_character_flag = special_magic_character
			has_character_flag = has_nickname_from_mresearch
			has_nickname = mage_nickname
			has_nickname = mage2_nickname
			has_nickname = mage3_nickname
			has_nickname = mage4m_nickname
			has_nickname = mage5m_nickname
			has_nickname = mage6m_nickname
			has_nickname = mage4f_nickname
			has_nickname = mage5f_nickname
			has_nickname = demonslayer_nickname
		}
		OR = {
			has_character_flag = magic_epic_book
			has_character_flag = magic_epic_magic
			has_character_flag = magic_epic_project
		}
		any_councillor = {
			is_imprisoned = no
			is_ai = yes
		}
		is_imprisoned = no
	}
	immediate = {
		hidden_effect = {
			random_councillor = {
				limit = {
					is_imprisoned = no
					is_ai = yes
				}
				save_scope_as = rconc
			}
		}
	}
	
	option = {
		name = ev6.73.0.a
		give_nickname = mage_nickname
		stress_impact = {
			arrogant = minor_stress_loss
			eccentric = minor_stress_loss
			temperate = minor_stress_loss
		}
		if = {
			limit = {
				trait_is_criminal_in_faith_trigger = { TRAIT = witch FAITH = root.faith GENDER_CHARACTER = root }
			}
			add_piety = -500
		}
		else = {
			add_prestige = minor_prestige_gain
		}
	}
	option = {
		name = ev6.73.0.b
		give_nickname = mage2_nickname
		every_councillor = {
			limit = {
				is_imprisoned = no
				is_ai = yes
			}
			add_opinion = {
				target = ROOT
				modifier = disappointed_opinion
				opinion = -10
			}
		}
		stress_impact = {
			gregarious = medium_stress_gain
			paranoid = medium_stress_loss
			shy = medium_stress_loss
		}
	}
	option = {
		name = ev6.73.0.c
		trigger = {
			has_trait = scholar
		}
		trait = scholar
		stress_impact = {
			gregarious = medium_stress_loss
			shy = major_stress_gain
			scholar = medium_stress_loss
			trusting = minor_stress_loss
			paranoid = major_stress_gain
			honest = minor_stress_loss
			contrite = minor_stress_loss
		}
		give_nickname = mage3_nickname
		every_councillor = {
			limit = {
				is_imprisoned = no
				is_ai = yes
			}
			add_opinion = {
				target = ROOT
				modifier = pleased_opinion
				opinion = 10
			}
		}
		if = {
			limit = {
				any_secret = {
					secret_type = secret_witch
				}
			}
			random_secret = {
				limit = {
					secret_type = secret_witch
				}
				expose_secret = ROOT
			}
			if = {
				limit = {
					NOT = {
						has_trait = witch
					}
				}
				add_trait = witch
			}
		}
	}
	option = {
		name = ev6.73.0.d
		add_prestige = medium_prestige_gain
		stress_impact = {
			ambitious = medium_stress_loss
			august = medium_stress_loss
			arrogant = medium_stress_loss
			humble = minor_stress_gain
		}
		every_councillor = {
			limit = {
				is_imprisoned = no
				is_ai = yes
			}
			add_opinion = {
				target = ROOT
				modifier = disappointed_opinion
				opinion = -5
			}
		}
	}
	after = {
		hidden_effect = {
			add_character_flag = has_nickname_from_mresearch
		}
	}
}

#summoning demon with hell's scepter - additional event for performance reasons
magic_ev6.74 = {
	hidden = yes
	
	immediate = {
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = belial
					}
				}
			}
			add_character_flag = belial_accesible
		}
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = lilith
					}
				}
			}
			add_character_flag = lilith_accesible
		}
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = mammon
					}
				}
			}
			add_character_flag = mammon_accesible
		}
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = samael
					}
				}
			}
			add_character_flag = samael_accesible
		}
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = hecate
					}
				}
				OR = {
					NOT = {
						has_character_flag = no_soul
					}
					has_character_flag = ms_met_hecate
				}
				is_ai = no
			}
			add_character_flag = hecate_accesible
		}
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = nyx
					}
				}
				NOT = {
					has_character_flag = nyx_no_more_flag
				}
			}
			add_character_flag = nyx_accesible
		}
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = demon_child
					}
				}
			}
			add_character_flag = demon_child_accesible
		}
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = moloch
					}
				}
			}
			add_character_flag = moloch_accesible
		}
		if = {
			limit = {
				NOT = {
					any_living_character = {
						has_character_flag = asmodeus
					}
				}
			}
			add_character_flag = asmodeus_accesible
		}

		trigger_event = magic_ev6.5
	}
}

#Al-Hazred died
magic_ev6.75 = {
	hidden = yes
	trigger = {
		has_character_flag = abdul_dude
	}

	immediate = {
		random_artifact = {
			limit = {
				has_variable=singularity2
				NOR = {
					has_variable=singularity
					has_variable=singularity_sleeping
				}
			}
			destroy_artifact = this
		}
		if = {
			limit = {
				any_ruler = {
					is_ai = no
					is_legendary_mage_trigger = yes
				}
			}
			random_ruler = {
				limit = {
					is_ai = no
					is_legendary_mage_trigger = yes
				}
				#give_nickname = archmage_nickname
				send_interface_toast = {
					title = ev6.75.title
					custom_tooltip = ev6.75.ct
					add_prestige = massive_prestige_gain
					if = {
						limit = {
							exists = dynasty
						}
						dynasty = {
							add_dynasty_prestige = compensate_dynast_prest_value
						}
					}
				}
			}
		}
	}
}