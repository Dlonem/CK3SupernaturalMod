namespace = magic_ev
magic_ev.99 = {
	hidden = yes
	#type = empty
	scope = none
	trigger = {
		NAND = {
			any_artifact = { has_variable = blackgrimoire }
			any_artifact = { has_variable = catalyst }
			any_artifact = { has_variable = magic_ring0 }
			any_artifact = { has_variable = singularity }
			any_artifact = { has_variable = dark_blade }
			any_artifact = { has_variable = dragon_scales }
			any_artifact = { has_variable = magic_scepter }
			any_artifact = { has_variable = magic_crown }
		}
	}
	immediate = {
		random_ruler = {
			limit = {
				is_ai = no
			}
			save_scope_as = player0
		}
		if = {
			limit = {
				has_game_rule = user_magic_arts
				any_ruler = {
					is_ai = no
					NOT = {
						any_character_artifact = { has_variable = magic1 }
					}
				}
			}
			random_ruler = {
				limit = {
					is_ai = no
					NOT = {
						any_character_artifact = { has_variable = magic1 }
					}
				}
				random_list = {
					#necro
					1 = {
						trigger = {
							NOT = { any_artifact = { has_variable = blackgrimoire } }
						}
						
						trigger_event = magic_ev.57
						trigger_event = magic_ev.1
					}
					#ring
					1 = {
						trigger = {
							NOT = { any_artifact = { has_variable = magic_ring0 } }
						}
						trigger_event = magic_ev.97
						trigger_event = {
							id = magic_ev.57
							years = { 90 100 }
						}
					}
					#catalyst
					1 = {
						trigger = {
							NOT = { any_artifact = { has_variable = catalyst } }
						}
						trigger_event = magic_ev.98
					}
					#singularity
					1 = {
						trigger = {
							NOT = { any_artifact = { has_variable = singularity } }
						}
						trigger_event = magic_ev.96
					}
					#dark blade
					1 = {
						trigger = {
							NOT = { any_artifact = { has_variable = dark_blade } }
						}
						trigger_event = magic_ev.95
					}
					#dragon scales
					1 = {
						trigger = {
							NOT = { any_artifact = { has_variable = dragon_scales } }
						}
						trigger_event = magic_ev.94
					}
					#hells scepter
					1 = {
						trigger = {
							NOT = { any_artifact = { has_variable = magic_scepter } }
						}
						trigger_event = magic_ev.93
					}
					#magic crown
					1 = {
						trigger = {
							NOT = { any_artifact = { has_variable = magic_crown } }
						}
						trigger_event = magic_ev.92
					}
				}
			}
		}
		else = {
			if = {
				limit = {
					OR = {
						has_game_rule = user_magic_arts
						has_game_rule = eu_magic_arts
					}
				}
				random_ruler = {
					limit = {
						is_landed = yes	
						primary_title = { is_mercenary_company = no }	
						highest_held_title_tier>1
						exists = dynasty		
						dynasty={
							NOT={
								has_variable=ev1used
							}
						}
						any_ruler = {
							is_ai = no
							NOT = { THIS = PREV }
							in_diplomatic_range = PREV
						}
					}
					random_list = {
						#necro
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = blackgrimoire } }
							}
							
							trigger_event = magic_ev.57
							trigger_event = magic_ev.1
						}
						#ring
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = magic_ring0 } }
							}
							trigger_event = magic_ev.97
							trigger_event = {
								id = magic_ev.57
								years = { 90 100 }
							}
						}
						#catalyst
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = catalyst } }
							}
							trigger_event = magic_ev.98
						}
						#singularity
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = singularity } }
							}
							trigger_event = magic_ev.96
						}
						#dark blade
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = dark_blade } }
							}
							trigger_event = magic_ev.95
						}
						#dragon scales
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = dragon_scales } }
							}
							trigger_event = magic_ev.94
						}
						#hells scepter
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = magic_scepter } }
							}
							trigger_event = magic_ev.93
						}
						#magic crown
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = magic_crown } }
							}
							trigger_event = magic_ev.92
						}
					}
				}
			}
			else = {
				random_ruler = {
					limit = {
						is_landed = yes	
						primary_title = { is_mercenary_company = no }	
						highest_held_title_tier>1
						exists = dynasty		
						dynasty={
							NOT={
								has_variable=ev1used
							}
						}
					}
					random_list = {
						#Grimoire
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = blackgrimoire } }
							}
							
							trigger_event = magic_ev.57
							trigger_event = magic_ev.1
						}
						#ring
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = magic_ring0 } }
							}
							trigger_event = magic_ev.97
							trigger_event = {
								id = magic_ev.57
								years = { 90 100 }
							}
						}
						#catalyst
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = catalyst } }
							}
							trigger_event = magic_ev.98
						}
						#singularity
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = singularity } }
							}
							trigger_event = magic_ev.96
						}
						#dark blade
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = dark_blade } }
							}
							trigger_event = magic_ev.95
						}
						#dragon scales
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = dragon_scales } }
							}
							trigger_event = magic_ev.94
						}
						#hells scepter
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = magic_scepter } }
							}
							trigger_event = magic_ev.93
						}
						#magic crown
						1 = {
							trigger = {
								NOT = { any_artifact = { has_variable = magic_crown } }
							}
							trigger_event = magic_ev.92
						}
					}
				}
			}
		}
	}
}

#blackgrimoire
magic_ev.1 = {
	title = ev1.1.title
	desc = ev1.1.desc
	theme =  secret
	
	left_portrait = {
		character = root
		animation = paranoia
	}
	option = {
		name = ev1.1.a
		create_blackgrimoire_artifact_effect = { OWNER = root }
	}	
	after={
		dynasty={
			set_variable=ev1used
		}
		if = {
			limit = {
				is_ai = yes
			}
			give_witch_secret_or_trait_effect = yes
		}
		hidden_effect = {
			#fake magic sword trigger
			if = {
				limit = {
					any_ruler = {
						is_ai = no
						exists = dynasty
						dynasty={
							NOT={
								has_variable=fake_artif
							}
						}
						any_courtier_or_guest = {
							is_foreign_court_or_pool_guest = yes
						}
					}
				}
				random_ruler = {
					limit = {
							exists = dynasty
							dynasty={
								NOT={
									has_variable=fake_artif
								}
							}
							is_ai = no
							any_courtier_or_guest = {
								is_foreign_court_or_pool_guest = yes
							}
					}
					trigger_event = {
						id = magic_ev2.2
						years = { 2 14 }
					}
				}
			}
		}
	}	
}

#immortality ring
magic_ev.97 = {
	title = ev97.1.title
	desc = ev97.1.desc
	theme =  secret
	left_portrait = {
		character = root
		animation = paranoia
	}	
	option = {
		name = ev97.1.a
		create_immortality_ring_artifact_effect = { OWNER = root }
	}	
	after={
		dynasty={
			set_variable=ev1used
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						any_living_character = {
							has_character_flag = merlin_dude
						}
					}
				}
				if = {
					limit = {
						any_province = {
							geographical_region = world_europe_west_britannia
						}
					}
					random_ruler = {
						limit = {
							is_landed = yes
							
							capital_province = {
								#geographical_region = dlc_ep1_arthurian_heartlands_region
								geographical_region = world_europe_west_britannia
							}
						}
						create_merlin_effect = yes
					}
				}
				else = {
					random_ruler = {
						limit = {
							is_landed = yes
						}
						create_merlin_effect = yes
					}
				}
				
			}
		}
	}	
}

#magic catalyst
magic_ev.98 = {
	title = ev98.1.title
	desc = ev98.1.desc
	theme =  secret
	left_portrait = {
		character = root
		animation = paranoia
	}
	option = {
		name = ev98.1.a
		create_magic_catalyst_artifact_effect = { OWNER = root }
	}	
	after={
		dynasty={
			set_variable=ev1used
		}
		if = {
			limit = {
				is_ai = yes
			}
			add_secret = {
				type = secret_witch
				target = root
			}
		}
		#YAGA
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						any_county = {
							exists = title_province
							title_province = {
								has_building_or_higher = witch_house
							}
						}
					}
				}
				if = {
					limit = {
						any_ruler = {
							is_ai = no
							trait_is_criminal_in_faith_trigger = { TRAIT = witch FAITH = this.faith GENDER_CHARACTER = this }
						}
					}
					if = {
						limit = {
							any_province = {
								geographical_region = world_europe_east
							}
						}
						create_yaga_family_effect2 = yes
					}
					else = {
						create_yaga_family_effect2AR = yes
					}
				}
				else = {
					#create_yaga_family_effect = yes
					if = {
						limit = {
							any_province = {
								geographical_region = world_europe_east
							}
						}
						create_yaga_family_effect = yes
					}
					else = {
						create_yaga_family_effectAR = yes
					}
				}
			}
		}
	}	
}

magic_ev.96 = {
	title = ev96.1.title
	desc = ev96.1.desc
	theme =  secret
	left_portrait = {
		character = root
		animation = paranoia
	}
	option = {
		name = ev96.1.a
		create_ancient_singularity_effect = { OWNER = root }
	}	
	after={
		dynasty={
			set_variable=ev1used
		}
		if = {
			limit = {
				is_ai = yes
			}
			add_secret = {
				type = secret_witch
				target = root
			}
		}
		if = {
			limit = {
				NOT = {
					any_county = {
						exists = title_province
						title_province = {
							has_building_or_higher = mage_house
						}
					}
				}
			}
			create_magic_academy = yes
		}
		
	}	
}
#Crown of Shadows
magic_ev.92 = {
	title = ev92.1.title
	desc = ev92.1.desc
	theme =  secret
	left_portrait = {
		character = root
		animation = paranoia
	}
	option = {
		name = ev98.1.a
		create_crown_shadows_artifact_effect = { OWNER = root }
	}	
	after={
		dynasty={
			set_variable=ev1used
		}
		
		if = {
			limit = {
				NOT = {
					any_county = {
						exists = title_province
						title_province = {
							has_building_or_higher = houska
						}
					}
				}
			}
			create_houska = yes
		}
		create_extra_coven = yes
	}	
}
#hells scepter
magic_ev.93 = {
	title = ev93.1.title
	desc = ev93.1.desc
	theme =  secret
	left_portrait = {
		character = root
		animation = paranoia
	}
	option = {
		name = ev98.1.a
		create_hells_scepter_artifact_effect = { OWNER = root }
	}	
	after={
		dynasty={
			set_variable=ev1used
		}
			
	}	
}
#dragonscales
magic_ev.94 = {
	title = ev94.1.title
	desc = ev94.1.desc
	theme =  secret
	left_portrait = {
		character = root
		animation = paranoia
	}
	option = {
		name = ev98.1.a
		create_dragon_scales_artifact_effect = { OWNER = root }
	}	
	after={
		hidden_effect = {
			if = {
				limit = {
					is_ai = yes
				}
				add_secret = {
					type = secret_witch
					target = root
				}
			}
			if = {
				limit = {
					NOT = {
						any_living_character = {
							has_character_flag = mefisto_devil
						}
					}
				}
				create_mefisto_effect = yes
			}
		}
		dynasty={
			set_variable=ev1used
		}
			
	}	
}
#darkblade
magic_ev.95 = {
	title = ev95.1.title
	desc = ev95.1.desc
	theme =  secret
	left_portrait = {
		character = root
		animation = paranoia
	}
	option = {
		name = ev98.1.a
		create_dark_blade_artifact_effect = { OWNER = root }
	}	
	after={
		dynasty={
			set_variable=ev1used
		}
		if = {
			limit = {
				is_ai = yes
			}
			add_secret = {
				type = secret_witch
				target = root
			}
		}
		if = {
			limit = {
				NOT = {
					any_county = {
						exists = title_province
						title_province = {
							has_building_or_higher = horned_god_house
						}
					}
				}
			}
			create_dark_temple = yes
		}
		
	}	
}

#wisdom_of_nature_perk
magic_ev.2 = {
	title = ev2.1.title
	desc = ev2.1.desc
	theme =  learning
	left_portrait = root
	trigger = {
		NOT = {
			has_character_modifier = yaga_modifier
		}
	}
	option = {
		name = ev2.1.a
		if = {
			limit = {
				has_trait = lifestyle_mystic
			}
			add_trait_xp = {
				trait = lifestyle_mystic
				value = 60
			}
		}
		else = {
			add_trait_force_tooltip=lifestyle_mystic
			add_trait_xp = {
				trait = lifestyle_mystic
				value = 20
			}
		}
		custom_tooltip = ev2.1.a_ct
		hidden_effect = {
			random_list = {
				20 = {
					trigger_event = {
						id = magic_ev2.7
						years = { 15 20 }
					}
				}
				20 = {
					trigger_event = {
						id = magic_ev2.75
						years = { 3 9 }
					}
				}
				20 = {
					trigger_event = {
						id = magic_ev4.84
						years = { 9 15 }
					}
				}
				40 = {
					
				}
			}
		}
	}
	option = {
		name = ev2.1.c
		trigger={
			NOT={ has_trait=lifestyle_herbalist }
		}
		add_trait=lifestyle_herbalist
		custom_tooltip = ev2.1.c_ct
	}
	option={
		name = ev2.1.g
		trigger={
			exists = dynasty
			NOR={
				has_trait = heresiarch
				has_trait = cynical
			}
		}
		add_trait = heresiarch
		custom_tooltip = ev2.1.g_ct
		custom_tooltip = ev2.1.g_ct2
		hidden_effect = {
			save_scope_as = dpriest
			house = {
				every_house_member = {
					limit = {
						is_ai = yes
						NOR = {
							THIS = ROOT
							has_trait = witch
							has_trait = witch_hunter
							any_secret = { secret_type = secret_witch }
							has_relation_rival = root
							has_relation_nemesis = root
						}
					}
					random = {
						chance = dark_priest_pers
						trigger_event = {
							id = magic_ev4.49
							days = { 1 666 }
						}
					}
				}
			}
			random = {
				chance = dark_priest_pers
				trigger_event = {
					id = magic_ev4.56
					days = { 1 666 }
				}
			}
		}
	}
	option={
		name = ev2.1.e
		trigger={
			NOR={
				has_trait=cannibal
				any_secret = {
					secret_type = secret_cannibal
				}
			}
		}
		stress_impact = {
			compassionate = medium_stress_gain
		}
		give_cannibal_secret_or_trait_effect = yes
		#add_secret = {
		#	type = secret_cannibal
		#}
		custom_tooltip = ev2.1.e_ct
	}
	option={
		name = ev2.1.f
		custom_tooltip = ev2.1.f_ct
		add_learning_skill = 1
		trigger_event = {
			id = magic_ev.2
			years = 10
		}
	}
}

#cast a curse
magic_ev.3 = {
	title = ev3.0.title
	desc = ev3.0.desc
	theme =  mental_health
	left_portrait = root
	
	option = {
		name = ev3.0.a
		if = {
			limit = {
				scope:actor = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = witchcraft_legacy_4
					}
				}
			}
			random_list = {
				1 = {
					desc = ev3.1.a
					send_interface_toast = {
						title=ev3.2.a_repelled
					}
					scope:magic_user = {
						send_interface_toast = {
							title=ev3.2.a_repelled
						}
					}
				}
				99 = {
					desc = ev3.2.a
					hidden_effect = {
						if = {
							limit = {	has_character_modifier = cursed_modifier	}
							remove_character_modifier = cursed_modifier
						}
					}
					add_character_modifier = { modifier = cursed_modifier years = 6 }
					send_interface_toast = {
						title=ev3.2.a_cursed
					}
					scope:magic_user = {
						send_interface_toast = {
							title=ev3.2.a_cursed
						}
					}
				}
			}
		}
		else = {
			random_list = {
				40 = {
					desc = ev3.1.a
					send_interface_toast = {
						title=ev3.2.a_repelled
					}
					scope:magic_user = {
						send_interface_toast = {
							title=ev3.2.a_repelled
						}
					}
				}
				60 = {
					desc = ev3.2.a
					hidden_effect = {
						if = {
							limit = {	has_character_modifier = cursed_modifier	}
							remove_character_modifier = cursed_modifier
						}
					}
					add_character_modifier = { modifier = cursed_modifier years = 6 }
					send_interface_toast = {
						title=ev3.2.a_cursed
					}
					scope:magic_user = {
						send_interface_toast = {
							title=ev3.2.a_cursed
						}
					}
				}
			}
		}
	}
	option = {
		name = ev3.0.b
		
		trigger={
			has_trait=lifestyle_mystic
		}
		
		trait=lifestyle_mystic
		random_list = {
			60 = {
				desc = ev3.1.a
				send_interface_toast = {
					title=ev3.2.a_repelled
				}
				scope:magic_user = {
					send_interface_toast = {
						title=ev3.2.a_repelled
					}
				}
			}
			40 = {
				desc = ev3.2.a
				hidden_effect = {
					if = {
						limit = {	has_character_modifier = cursed_modifier	}
						remove_character_modifier = cursed_modifier
					}
				}
				add_character_modifier = { modifier = cursed_modifier years = 6 }
				send_interface_toast = {
					title=ev3.2.a_cursed
				}
				scope:magic_user = {
					send_interface_toast = {
						title=ev3.2.a_cursed
					}
				}
			}
		}
	}
	option = {
		name = ev3.0.b
		
		trigger={
			AND = { NOT = { has_trait=lifestyle_mystic }
				has_trait = witch
			}
		}
		
		trait = witch
		random_list = {
			70 = {
				desc = ev3.1.a
				send_interface_toast = {
					title=ev3.2.a_repelled
				}
				scope:magic_user = {
					send_interface_toast = {
						title=ev3.2.a_repelled
					}
				}
			}
			30 = {
				desc = ev3.2.a
				hidden_effect = {
					if = {
						limit = {	has_character_modifier = cursed_modifier	}
						remove_character_modifier = cursed_modifier
					}
				}
				add_character_modifier = { modifier = cursed_modifier years = 6 }
				send_interface_toast = {
					title=ev3.2.a_cursed
				}
				scope:magic_user = {
					send_interface_toast = {
						title=ev3.2.a_cursed
					}
				}
			}
		}
	}
}

#for magic sense
magic_ev.4 = {
	title = ev4.0.title
	desc = ev4.0.desc
	theme =  mental_health
	left_portrait = root
	trigger = {
		NOT = {
			has_character_flag = senses_overload3
		}
	}
	immediate = {
		save_scope_as = watcher
		#hidden_effect = {
		#	if = {
		#		limit = {
		#			NOT = {
		#				has_character_flag = senses_overload
		#			}
		#		}
		#		add_character_flag = {
		#			flag = senses_overload
		#			days = { 80 120 }
		#		}
		#	}
		#	else_if = {
		#		limit = {
		#			NOT = {
		#				has_character_flag = senses_overload2
		#			}
		#		}
		#		add_character_flag = {
		#			flag = senses_overload2
		#			days = { 80 120 }
		#		}
		#	}
		#	else = {
		#		add_character_flag = {
		#			flag = senses_overload3
		#			years = 10
		#		}
		#	}
		#}
		
	}
	option = {
		name = ev4.0.a
		ai_chance = {
			base = 10
		}
	}
	option = {
		name = ev4.0.b
		trigger = {
			has_trait = archmage
			exists = scope:magic_user
			NOT = {
				scope:magic_user = ROOT
			}
		}
		trait = archmage
		custom_tooltip = ev4.0.b_ct
		trigger_event = magic_ev.44
		ai_chance = {
			base = 20
		}
	}
	option = {
		name = ev4.0.e
		#trigger = {
		#	has_character_flag = senses_overload
		#}
		custom_tooltip = ev4.0.e_ct
		add_character_flag = {
			flag = senses_overload3
			years = 10
		}
		ai_chance = {
			base = 1
		}
	}
	option = {
		name = ev4.0.c
		trigger = {
			has_trait = witch_hunter
			exists = scope:magic_user
			scope:magic_user = {
				NOT = {
					has_strong_hook = ROOT
				}
			}
			NOT = {
				scope:magic_user = ROOT
			}
		}
		trait = witch_hunter
		custom_tooltip = ev4.0.b_ct
		add_trait_xp = {
			trait = supernatural_hunter
			track = witch_hunting
			value = 5
		}
		trigger_event = magic_ev.44
		ai_chance = {
			base = 200
			modifier = {
				add = -197
				OR = {
					has_trait = lazy
					has_trait = craven
					scope:magic_user = {
						dread >95
					}
				}
			}
		}
	}
	option = {
		name = ev4.0.d
		trigger = {
			has_court_position = mage_court_position
			#NOT = { liege = scope:magic_user }
			liege = {
				NOT = {
					this = scope:magic_user
				}
			}
		}
		liege = {
			add_opinion = {
				target = root
				modifier = magic_warning_modifier
			}
			show_as_tooltip = {
				add_character_modifier = {
					modifier = more_vigilant_recistance_modifier
					years = 1
				}
			}
			trigger_event = magic_ev2.53
		}
		
		ai_chance = {
			base = 10
		}
	}
	#after = {
	#	if = {
	#		limit = {
	#			NOT = {
	#				has_character_flag = senses_overload
	#			}
	#		}
	#		add_character_flag = {
	#			flag = senses_overload
	#			days = { 80 120 }
	#		}
	#	}
	#}
}

#for magic sense 'ev.4b'
magic_ev.44 = {
	title = ev4b.0.title
	desc = ev4b.0.desc
	theme =  mental_health
	left_portrait = root
	right_portrait = scope:magic_user
	option = {
		name = ev4b.0.a
		scope:magic_user = {
			every_secret = {
				limit = {
					secret_type = secret_witch
					NOT = {
						is_known_by = root
					}
				}
				reveal_to = root
			}
		}
		clear_saved_scope = magic_user
		ai_chance = {
			base = 1
		}
	}
	option = {
		name = ev4b.0.c
		trigger = {
			has_court_position = mage_court_position
			NOT = { liege = scope:magic_user }
		}
		scope:magic_user = {
			every_secret = {
				limit = {
					secret_type = secret_witch
					NOT = {
						is_known_by = root
					}
				}
				reveal_to = root
			}
		}
		show_as_tooltip = {
			liege = {
				save_scope_as = lliege
				scope:magic_user = {
					every_secret = {
						limit = {
							secret_type = secret_witch
						}
						reveal_to = scope:lliege
					}
				}
			}
		}
		liege = {
			add_opinion = {
				target = root
				modifier = magic_warning_modifier
				years = 1
			}
			trigger_event = magic_ev2.54
		}
		ai_chance = {
			base = 5
		}
	}
	option = {
		name = ev4b.0.b
		trigger = {
			has_trait = witch_hunter
		}
		trait = witch_hunter
		scope:magic_user = {
			every_secret = {
				limit = {
					secret_type = secret_witch
					NOT = {
						is_known_by = root
					}
				}
				reveal_to = root
			}
		}
		if = {
			limit = {
				NOR = {
					any_scheme = {
						scheme_type = murder
					}
					any_scheme = {
						scheme_type = abduct
					}
				}
			}
			if = {
				limit = {
					is_landed = yes
				}
				start_scheme = {
					type = abduct
					target = scope:magic_user
				}
			}
			else = {
				start_scheme = {
					type = murder
					target = scope:magic_user
				}
			}
			
		}
		clear_saved_scope = magic_user
		ai_chance = {
			base = 50
		}
	}
	option = {
		name = ev4b.0.d
		trigger = {
			NOT = {
				has_trait = supernatural_hunter
			}
			scope:magic_user = {
				has_character_flag = black_magic_caster_flag
			}
			has_character_flag = forbidden_black_magic_flag
		}
		scope:magic_user = {
			every_secret = {
				limit = {
					secret_type = secret_witch
					NOT = {
						is_known_by = root
					}
				}
				reveal_to = root
			}
			if = {
				limit = {
					is_landed = yes
				}
				primary_title = {
					save_scope_as = ptitle
				}
			}
		}
		if = {
			limit = {
				exists = scope:ptitle
				NOT = {
					has_claim_on = scope:ptitle
				}
			}
			add_unpressed_claim = scope:ptitle
		}
		every_living_character = {
			limit = {
				has_character_flag = forbidden_black_magic_flag
				NOR = {
					has_opinion_modifier = {
						modifier = use_black_magic_opinion
						target = root
					}
					THIS = scope:magic_user
				}
			}
			add_opinion = {
				target = scope:magic_user
				modifier = use_black_magic_opinion
				opinion = -50
			}
		}
		clear_saved_scope = magic_user
		ai_chance = {
			base = 1
			modifier = {
				add = 10
				has_trait = just
			}
			modifier = {
				add = -10
				has_trait = arbitrary
			}
			modifier = {
				add = 10
				scope:magic_user = {
					is_landed = yes
				}
				OR = {
					has_trait = greedy
					has_trait = ambitious
				}
			}
		}
	}
}

#lifestealing
magic_ev.5 = {
	title = ev5.0.title
	desc = ev5.0.desc
	theme =  mental_health
	left_portrait = root
	
	right_portrait = scope:potential_sacrifice
	trigger = {
		OR = {
			any_child = {
				count > 0
			}
			any_spouse ={
				count > 0
			}
			any_relation ={
				type = friend
				count > 0
			}
			any_relation ={
				type = best_friend
				count > 0
			}
			any_relation ={
				type = lover
				count > 0
			}
			any_relation ={
				type = soulmate
				count > 0
			}
		}
	}
	immediate = {
		save_scope_as = player
		random_child = {
			add_to_list = potential_sacrifices
		}
		random_spouse = {
			add_to_list = potential_sacrifices
		}
		random_relation ={
			type = friend
			add_to_list = potential_sacrifices
		}
		random_relation ={
			type = best_friend
			add_to_list = potential_sacrifices
		}
		random_relation ={
			type = lover
			add_to_list = potential_sacrifices
		}
		random_relation ={
			type = soulmate
			add_to_list = potential_sacrifices
		}
		random_in_list = {
			list = potential_sacrifices
			save_scope_as = potential_sacrifice
		}
		
	}
	option = {
		name = ev5.0.a
		save_scope_as = magic_user
		#add_character_flag = {
		#		flag = magic_user
		#		years = 5
		#}
		stress_impact = {
			compassionate = major_stress_gain
			ambitious = minor_stress_loss
			callous = medium_stress_loss
		}
		add_character_modifier = lifestealer_modifier
		scope:potential_sacrifice = {
			add_character_modifier = lifestolen_modifier
		}
		send_message_4_magic_sense_effect =yes
		ai_chance = {
			base = 100
			modifier = {
				add = -50
				scope:potential_sacrifice = {
					NOT = {
						has_relation_soulmate = root
					}
				}
			}
			modifier = {
				add = -50
				scope:potential_sacrifice = {
					NOT = {
						has_relation_best_friend = root
					}
				}
			}
			modifier = {
				add = -50
				has_trait = compassionate
			}
			modifier = {
				add = -50
				has_trait = just
			}
			modifier = {
				add = -1000
				has_character_modifier = yaga_modifier
			}
		}
	}
	option = {
		name = ev7.19.0.e
		trigger = {
			has_trait = compassionate
		}
		stress_impact = {
			compassionate = massive_stress_loss
		}
		add_character_modifier = lifestolen_modifier
		scope:potential_sacrifice = {
			add_character_modifier = lifestealer_modifier
		}
		add_piety = major_piety_gain
		ai_chance = {
			base = 0
		}
	}
	option = {
		name = ev5.0.b
		add_stress = medium_stress_loss
		add_piety = medium_piety_gain
		stress_impact = {
			ambitious = minor_stress_gain
		}
		ai_chance = {
			base = 50
		}
	}
	
}

magic_ev.6 = {
	hidden = yes
	immediate = {
		scope:this0 = {
		random_list = {
			50 = {
				trigger = {
					OR = {
						any_child = {
							count > 0
						}
						any_relation ={
							type = friend
							is_ruler = no
							NOT = { has_trait = demon }
							count > 0
						}
						any_relation ={
							type = best_friend
							is_ruler = no
							NOT = { has_trait = demon }
							count > 0
						}
						any_relation ={
							type = lover
							is_ruler = no
							NOT = { has_trait = demon }
							count > 0
						}	
						any_relation ={
							type = soulmate
							is_ruler = no
							NOT = { has_trait = demon }
							count > 0
						}
					}
				}
				trigger_event = magic_ev.7
			}
			50 = {
				trigger = { always = yes }
				trigger_event = magic_ev.8
			}
			40 = {
				trigger_event = magic_ev.81
			}
		}
		}
	}
}

#forbidden ritual pay the price 1.
magic_ev.7 = {
	title = ev7.0.title
	desc = ev7.0.desc
	theme = witchcraft
	left_portrait = root
	
	right_portrait = scope:potential_sacrifice
	lower_right_portrait = scope:potential_sacrifice2
	
	immediate = {
		save_scope_as = player
		random_child = {
			add_to_list = potential_sacrifices
		}
		random_relation ={
			limit = { is_ruler = no NOT = { has_trait = demon } }
			type = friend
			add_to_list = potential_sacrifices
		}
		random_relation ={
			limit = { is_ruler = no NOT = { has_trait = demon } }
			type = best_friend
			add_to_list = potential_sacrifices
		}
		random_relation ={
			limit = { is_ruler = no NOT = { has_trait = demon } }
			type = lover
			add_to_list = potential_sacrifices
		}
		random_relation ={
			limit = { is_ruler = no NOT = { has_trait = demon } }
			type = soulmate
			add_to_list = potential_sacrifices
		}
		random_in_list = {
			list = potential_sacrifices
			save_scope_as = potential_sacrifice
		}
		random_child = {
			add_to_list = potential_sacrifices2
		}
		random_relation ={
			limit = { is_ruler = no NOT = { has_trait = demon } }
			type = friend
			add_to_list = potential_sacrifices2
		}
		random_relation ={
			limit = { is_ruler = no NOT = { has_trait = demon } }
			type = best_friend
			add_to_list = potential_sacrifices2
		}
		random_relation ={
			limit = { is_ruler = no NOT = { has_trait = demon } }
			type = lover
			add_to_list = potential_sacrifices2
		}
		random_relation ={
			limit = { is_ruler = no NOT = { has_trait = demon } }
			type = soulmate
			add_to_list = potential_sacrifices2
		}
		random_in_list = {
			limit = {
				NOT = {
					this = scope:potential_sacrifice
				}
			}
			list = potential_sacrifices2
			save_scope_as = potential_sacrifice2
		}
	}
	option = {
		name = ev7.0.a
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		
		scope:potential_sacrifice = {
			death = {
				death_reason = death_murder
				killer = scope:player
			}
		}
		add_secret = {
			type = secret_murder
			target = scope:potential_sacrifice
		}
		send_message_4_magic_sense_effect =yes
		stress_impact = {
			just = medium_stress_gain
			compassionate = medium_stress_gain
			sadistic = minor_stress_loss
		}
		ai_chance = {
			base = 100
			modifier = {
				add = -100
				scope:potential_sacrifice = {
					NOT = {
						is_primary_heir_of = root
					}
				}
			}
			modifier = {
				add = -50
				scope:potential_sacrifice = {
					NOT = {
						has_relation_soulmate = root
					}
				}
			}
			modifier = {
				add = -50
				scope:potential_sacrifice = {
					NOT = {
						has_relation_best_friend = root
					}
				}
			}
			modifier = {
				add = -50
				has_trait = compassionate
			}
			modifier = {
				add = -50
				has_trait = just
			}
		}
	}
	option = {
		name = ev7.0.c
		
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		trigger = {
			exists = scope:potential_sacrifice2
			NOT = { scope:potential_sacrifice2 = scope:potential_sacrifice }
		}
		scope:potential_sacrifice2 = {
			death = {
				death_reason = death_murder
				killer = scope:player
			}
		}
		add_secret = {
			type = secret_murder
			target = scope:potential_sacrifice2
		}
		send_message_4_magic_sense_effect =yes
		stress_impact = {
			just = medium_stress_gain
			compassionate = medium_stress_gain
			sadistic = minor_stress_loss
		}
		ai_chance = {
			base = 100
			modifier = {
				add = -100
				scope:potential_sacrifice = {
					NOT = {
						is_primary_heir_of = root
					}
				}
			}
			modifier = {
				add = -50
				scope:potential_sacrifice = {
					NOT = {
						has_relation_soulmate = root
					}
				}
			}
			modifier = {
				add = -50
				scope:potential_sacrifice = {
					NOT = {
						has_relation_best_friend = root
					}
				}
			}
			modifier = {
				add = -50
				has_trait = compassionate
			}
			modifier = {
				add = -50
				has_trait = just
			}
		}
	}
	option = {
		trigger = {
			faith = { has_doctrine_parameter = human_sacrifice_active }
			any_prisoner = {
				count > 5
			}
		}
		name = ev7.0.d
		every_prisoner = {
			death = {
				death_reason = death_sacrificed_to_gods
				killer = root
			}
		}
		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		stress_impact = {
			callous = minor_stress_impact_loss
			sadistic = medium_stress_impact_loss
			compassionate = medium_stress_impact_gain
		}
		stress_impact = {
			compassionate = minor_stress_gain
			sadistic = minor_stress_loss
		}
		ai_chance = {
			base = 60
			modifier = {
				add = -50
				has_trait = compassionate
			}
		}
	}
	option = {
		trigger = {
			learning > 25
		}
		skill = learning
		name = ev7.0.d12
		
		random_list = {
			9 = {
				send_interface_toast = {
					title=ev7.0.title
					gain_standard_ps_effect = yes
				}
			}
			1 = {
				send_interface_toast = {
					title=ev7.0.title
					if = {
						limit = {
							NOT = {
								has_trait = maimed
							}
						}
						add_trait = maimed
					}
					else = {
						add_trait = incapable
					}
				}
			}
		}
		stress_impact = {
			craven = medium_stress_gain
		}
		ai_chance = {
			base = 0
		}
	}
	option = {
		name = ev7.0.b
		stress_impact = {
			compassionate = minor_stress_loss
			sadistic = minor_stress_gain
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 50
				has_trait = compassionate
			}
			modifier = {
				add = 50
				has_trait = just
			}
		}
		
	}
	
}

#forbidden ritual pay the price 2.
magic_ev.8 = {
	title = ev7.0.title
	desc = ev81.0.desc
	theme = witchcraft
	left_portrait = root

	#trigger = {
	#	
	#}
	#immediate = {
	#	
	#	
	#}
	option = {
		name = ev8.0.a
		save_scope_as = magic_user
		trigger = {
			NAND = {
				OR = {
					has_trait = wounded_3
					has_trait = wounded_2
					has_trait = wounded_1 
				}
				has_trait = consumption
				has_trait = disfigured
			}
		}
		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		random_list = {
			80 = {
				trigger = {
						AND = {
							NOT = { has_trait = wounded_3 }
							NOT = { has_trait = wounded_2 }
				 		}
				}
				if = { limit = { NOT = { has_trait = wounded_1 }  }
					#send_interface_toast = {
					#	title = ev8.cost_magic
					#	add_trait = wounded_1
					#}
					add_trait = wounded_1
				}
				else = {
					hidden_effect = {
						remove_trait = wounded_1
					}
					
					#send_interface_toast = {
					#	title = ev8.cost_magic
					#	add_trait_force_tooltip =  wounded_2
					#}
					add_trait_force_tooltip =  wounded_2
				}
			}
			10 = {
				trigger = { NOT = { has_trait = consumption } }
				#send_interface_toast = {
				#	title = ev8.cost_magic
				#	add_trait = consumption
				#}
				add_trait = consumption
			}
			10 = {
				trigger = { NOT = { has_trait = disfigured } }
				#send_interface_toast = {
				#	title = ev8.cost_magic
				#	add_trait = disfigured
				#}
				add_trait = disfigured
			}
		}

		send_message_4_magic_sense_effect = yes
		ai_chance = {
			base = 20
		}
	}
	option = {
		name = ev8.0.b
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		random_list = {
			50 = {
				add_stress = 200
			}
			30 = {
				trigger = { learning > 8 }
				
				send_interface_toast = {
					title = ev8.cost_magic
					add_learning_skill = -1
					add_stress = 50
				}
			}
			10 = {
				trigger = { NOR = { has_trait = lunatic_genetic has_trait = lunatic_1 } }
				add_trait = lunatic_genetic
				add_stress = 50
			}
			10 = {
				trigger = { NOR = { has_trait = possessed_1 has_trait = possessed_genetic } }
				add_trait = possessed_1
				add_stress = 50
			}
		}

		send_message_4_magic_sense_effect =yes
		ai_chance = {
			base = 10
			modifier = {
				add = 20
				stress_level = 0
			}
		}
	}
	option = {
		name = ev8.0.e
		trigger = {
			has_trait = pregnant
		}
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		remove_trait = pregnant

		send_message_4_magic_sense_effect =yes
		ai_chance = {
			base = 5
			modifier = {
				add = 20
				any_child = {
					count > 1
				}
			}
		}
	}
	option = {
		name = ev8.0.d
		trigger = {
			has_trait = archmage
			has_trait = greedy
			NOR = {
				has_trait = ambitious
				has_trait = blind
			}
		}
		trait = greedy
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_huge_ps_effect = yes
		}
		#random_list = {
		#	99 = {
		#		add_trait = blind
		#	}
		#	1 = {
		#		trigger = {
		#			NOR = {
		#				has_trait = source
		#				has_trait = source2
		#			}
		#		}
		#		add_trait = source
		#	}
		#}
		add_trait = blind
		send_message_4_magic_sense_effect =yes
		ai_chance = {
			base = 1
		}
	}
	option = {
		name = ev8.0.d
		trigger = {
			has_trait = archmage
			has_trait = ambitious
			NOT = {
				has_trait = blind
			}
		}
		trait = ambitious
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_huge_ps_effect = yes
		}
		#random_list = {
		#	99 = {
		#		add_trait = blind
		#	}
		#	1 = {
		#		trigger = {
		#			NOR = {
		#				has_trait = source
		#				has_trait = source2
		#			}
		#		}
		#		add_trait = source
		#	}
		#}
		add_trait = blind
		send_message_4_magic_sense_effect =yes
		ai_chance = {
			base = 1
		}
	}
	
	option = {
		name = ev8.0.c
		trigger = {
			NOT = { has_character_flag = no_soul }
		}
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_huge_ps_effect = yes
		}
		add_character_flag = no_soul
		if = {
			limit = {
				NOT = {
					has_trait = corrupted
				}
			}
			add_trait = corrupted
		}
		custom_tooltip = no_soul_custom_tooltip
		send_message_4_magic_sense_effect =yes
		trigger_event = {
			id = magic_ev2.11
			years = { 18 22 }
		}
		ai_chance = {
			base = 0
		}
	}

	option = {
		name = ev7.0.b
		ai_chance = {
			base = 1
		}
	}
	
}

#forbidden ritual pay the price 3.
magic_ev.81 = {
	title = ev7.0.title
	desc = ev81.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:recipient
	immediate = {
		if = {
			limit = {
				any_prisoner = {
					is_adult = yes
					root = {
						has_execute_reason = PREV
					}
				}
			}
			random_prisoner = {
				limit = {
					is_adult = yes
					root = {
						has_execute_reason = PREV
					}
				}
				save_scope_as = recipient
			}
		}
		else_if = {
			limit = {
				any_prisoner = {
					is_adult = yes
				}
			}
			random_prisoner = {
				limit = {
					is_adult = yes
				}
				save_scope_as = recipient
			}
		}
	}

	option = {
		name = ev81.0.a
		trigger = {
			root.capital_county.development_level > 0
		}
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		stress_impact = {
			compassionate = medium_stress_gain
			sadistic = medium_stress_loss
		}

		root.capital_county = {
			#change_development_progress = medium_development_progress_loss
			#change_development_progress = -10
			change_development_level = -7
		}

		send_message_4_magic_sense_effect = yes
		ai_chance = {
			base = 20
		}
	}
	option = {
		name = ev81.0.b
		save_scope_as = magic_user
		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		stress_impact = {
			compassionate = medium_stress_gain
			sadistic = medium_stress_loss
		}
		add_dread = medium_dread_gain
		add_tyranny = major_tyranny_gain
		if = {
			limit = {
				NOT = {
					has_trait = murderer
				}
			}
			add_trait = murderer
		}
		send_message_4_magic_sense_effect = yes
		ai_chance = {
			base = 20
		}
	}
	option = {
		name = ev81.0.c
		trigger = {
			any_prisoner = {
				is_adult = yes
			}
			exists = scope:recipient
		}
		save_scope_as = magic_user
		save_scope_as = actor

		stress_impact = {
			compassionate = medium_stress_gain
			sadistic = medium_stress_loss
		}

		send_interface_toast = {
			title=ev7.0.title
			gain_standard_ps_effect = yes
		}
		add_dread = minor_dread_gain
		if = {
			limit = {
				NOT = {
					has_execute_reason = scope:recipient
				}
			}
			add_tyranny = execution_tyranny_gain
		}
		if = {
			limit = {
				NOT = {
					has_character_modifier = intrigue_horrifying_executions_modifier
				}
			}
			add_character_modifier = {
				modifier = intrigue_horrifying_executions_modifier
				years = 1
			}
		}
		add_kinslayer_trait_or_nothing_effect = { VICTIM = scope:recipient }
		execute_opinion_effect = { VICTIM = scope:recipient EXECUTIONER = scope:actor }
		scope:recipient = {
			death = {
				death_reason = death_execution
				killer = scope:actor
			}
		}
		
		send_message_4_magic_sense_effect = yes
		ai_chance = {
			base = 20
		}
	}

	option = {
		name = ev7.0.b
		ai_chance = {
			base = 1
		}
	}
	
}

#magic triangulation
magic_ev.9 = {
	title = ev9.0.title
	desc = ev9.0.desc
	theme =  witchcraft
	left_portrait = root
	right_portrait = scope:potential_magician
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					has_variable = last_ttarget
				}
				var:last_ttarget = {
					save_scope_as = last_ttarget0
				}
				if = {
					limit = {
						NOT = {
							exists = scope:artif
						}
					}
					random_artifact = {
						limit = {
							has_variable = magic1
							NOR = {
								artifact_owner = root
								artifact_owner = scope:last_ttarget0
							}
						}
						save_scope_as = artif
					}
				}
				scope:artif.artifact_owner = {
					save_scope_as = potential_magician
				}
			}
			else = {
				if = {
					limit = {
						NOT = {
							exists = scope:artif
						}
					}
					random_artifact = {
						limit = {
							has_variable = magic1
							NOT = {
								artifact_owner = root
							}
						}
						save_scope_as = artif
					}
				}
				
				scope:artif.artifact_owner = {
					save_scope_as = potential_magician
				}
			}

			#if = {
			#	limit = {
			#		has_variable = last_ttarget
			#	}
			#	random_living_character = {
			#		limit = {
			#			NOT = { this = root }
			#			NOT = {	this = var:last_ttarget	}
			#			any_character_artifact = { has_variable = magic1 }
			#		}
			#		save_scope_as = potential_magician
			#	}
			#	if = {
			#		limit = {
			#			NOT = {
			#				exists = scope:potential_magician
			#			}
			#		}
			#		random_living_character = {
			#			limit = {
			#				NOT = { this = root }
			#				any_character_artifact = { has_variable = magic1 }
			#			}
			#			save_scope_as = potential_magician
			#		}
			#	}
			#}
			#else = {
			#	random_living_character = {
			#		limit = {
			#			NOT = { this = root }
			#			any_character_artifact = { has_variable = magic1 }
			#			in_diplomatic_range = root
			#		}
			#		save_scope_as = potential_magician
			#	}
			#	if = {
			#		limit = {
			#			NOT = {
			#				exists = scope:potential_magician
			#			}
			#		}
			#		random_living_character = {
			#			limit = {
			#				NOT = { this = root }
			#				any_character_artifact = { has_variable = magic1 }
			#			}
			#			save_scope_as = potential_magician
			#		}
			#	}
			#}

			#scope:potential_magician = {
			#	random_character_artifact = { 
			#		limit = { has_variable = magic1 }
			#		save_scope_as = artif
			#	}
			#}
			
			set_variable = {
				name = last_ttarget
				value = scope:potential_magician
			}
		}
		
	}
	
	option = {
		name = ev9.0.a
		#if = {
		#	limit = {
		#		NOR = {
		#			has_relation_rival = scope:potential_magician
		#			has_relation_nemesis = scope:potential_magician
		#		}
		#	}
		#	progress_towards_rival_effect = {
		#		CHARACTER = scope:potential_magician
		#		OPINION = 0
		#		REASON = rival_random_m1
		#	}
		#}
		
		ai_chance = {
			base = 10
		}
	}
	option = {
		name = ev9.0.b
		trigger = {
			has_trait = greedy
			NOT = { has_character_flag = claimviatriang }
		}
		trait = greedy
		if = {
			limit = {
				NOR = {
					has_relation_rival = scope:potential_magician
					has_relation_nemesis = scope:potential_magician
				}
			}
			set_relation_rival = scope:potential_magician
		}
		
		add_personal_artifact_claim = scope:artif
		add_character_flag = claimviatriang
		start_scheme = {
			type = steal_back_artifact
			target = scope:potential_magician
			artifact = scope:artif
		}
		ai_chance = {
			base = 90
		}
	}

	option = {
		name = ev9.0.b
		trigger = {
			NOT = { has_trait = greedy }
			has_trait = ambitious
			NOT = { has_character_flag = claimviatriang }
		}
		trait = ambitious
		if = {
			limit = {
				NOR = {
					has_relation_rival = scope:potential_magician
					has_relation_nemesis = scope:potential_magician
				}
			}
			set_relation_rival = scope:potential_magician
			#set_random_rivalry_reason = { TARGET = scope:potential_magician }
		}
		add_personal_artifact_claim = scope:artif
		add_character_flag = claimviatriang
		ai_chance = {
			base = 90
		}
	}

	option = {
		name = ev9.0.c
		trigger = {
			has_trait = paranoid
			NOT = {
				any_scheme = {
					scheme_type = murder
				}
			}
		}
		trait = paranoid
		#if = {
		#	limit = {
		#		NOR = {
		#			has_relation_rival = scope:potential_magician
		#			has_relation_nemesis = scope:potential_magician
		#		}
		#	}
		#	progress_towards_rival_effect = {
		#		CHARACTER = scope:potential_magician
		#		OPINION = 0
		#		REASON = rival_random_m1
		#	}
		#}
		start_scheme = {
			type = murder
			target = scope:potential_magician
		}
		ai_chance = {
			base = 90
		}
	}
	option = {
		name = ev9.0.d
		trigger = {
			has_trait = gregarious
			NOR = {
				has_relation_rival = scope:potential_magician
				has_relation_nemesis = scope:potential_magician
				has_relation_potential_rival = scope:potential_magician
			}
		}
		trait = gregarious
		if = {
			limit = {
				NOR = {
					has_relation_potential_friend = scope:potential_magician
					has_relation_friend = scope:potential_magician
					has_relation_best_friend = scope:potential_magician
				}
			}
			progress_towards_friend_effect = {
				CHARACTER = scope:potential_magician
				OPINION = 0
				REASON = friend_random_m1
			}
		}
		else_if = {
			limit = {
				has_relation_potential_friend = scope:potential_magician
				NOT = {
					any_scheme = {
						scheme_type = befriend
						scheme_target = scope:potential_magician
					}
				}
			}
			start_scheme = {
				type = befriend
				target = scope:potential_magician
			}
		}
		ai_chance = {
			base = 90
		}
	}
	#after = {
	#	metamagic_effect = yes
	#}
}

#powerfull curse
magic_ev.10 = {
	title = ev10.0.title
	desc = ev10.0.desc
	theme =  witchcraft
	left_portrait = root
	right_portrait = scope:reci
	
	#immediate = {
	#
	#}
	option = {
		name = ev10.0.f
		trigger = {
			has_trait = yaga
			exists = scope:reci.house
			scope:reci.house = {
				NOR = {
					has_house_modifier = cursed_house
					any_house_member = {
						OR = {
							has_perk = protective_runes_perk
							has_perk = mage_tower_p2_perk
							has_trait = demon
						}
					}
				}
			}
		}
		trait = yaga
		scope:reci.house = {
			add_house_modifier = {
				modifier = cursed_house
			}
		}
		ai_chance = {
			base = 0
		}
	}
	option = {
		name = ev10.0.a
		if = {
			limit = {	NOT = {	has_trait = yaga	}	}
			spend_standard_ps_effect = yes
		}
		scope:reci = {
			random_list = {
				60 = { 
					#trigger = {
					#	NOT = { has_trait = demon }
					#}
					send_interface_toast = {
						title = you_are_cursed
						death = {
							death_reason = death_murder
							killer = root
						}
					}
					
				}
				20 = { trigger = {
						NOT = { has_trait = wounded_1 }
						NOT = { has_trait = wounded_2 }
						NOT = { has_trait = wounded_3 }
						NOT = { has_trait = disfigured }
					}
					send_interface_toast = {
						title = you_are_cursed
						add_trait = wounded_3
						add_trait = disfigured
					}
					
					add_character_modifier = { modifier = cursed_modifier years = 4 }
				}
				20 = { trigger = {
						NOT = { has_trait = maimed }
						NOT = { has_trait = disfigured }
					}
					send_interface_toast = {
						title = you_are_cursed
						add_trait = maimed
						add_trait = disfigured
					}
					
					add_character_modifier = { modifier = cursed_modifier years = 4 }
				}
				#50 = { 
				#	trigger = {
				#		has_trait = demon
				#	}
				#	if = {
				#		limit = {
				#			NOT = { has_trait = incapable }
				#		}
				#		add_trait = incapable
				#		add_diplomacy_skill = -5
				#		add_martial_skill = -5
				#		add_stewardship_skill = -5
				#		add_intrigue_skill = -5
				#		add_learning_skill = -5
				#	}
				#	else = {
				#		add_diplomacy_skill = -25
				#		add_martial_skill = -25
				#		add_stewardship_skill = -25
				#		add_intrigue_skill = -25
				#		add_learning_skill = -25
				#	}
				#	add_character_modifier = { modifier = cursed_modifier years = 4 }
				#}
			}
		}
		gain_sc_xp1_effect = yes
		if = {
			limit = {	NOT = {	has_trait = yaga	}	}
			metamagic_effect = yes
		}
		
		ai_chance = {
			base = 50
		}
	}
	option = {
		name = ev10.0.b
		if = {
			limit = {	NOT = {	has_trait = yaga	}	}
			spend_standard_ps_effect = yes
			metamagic_effect = yes
		}
		scope:reci = {
			add_trait = depressed_genetic
			add_character_modifier = { modifier = cursed_modifier years = 4 }
			random_list = {
				25 = { trigger = {
						NOT = { has_trait = leper }
					}
					send_interface_toast = {
						title = you_are_cursed
						add_trait = leper
					}
				}
				25 = { trigger = {
						NOT = { has_trait = consumption }
					}
					send_interface_toast = {
						title = you_are_cursed
						add_trait = consumption
					}
				}
				25 = { trigger = {
						NOT = { has_trait = cancer }
					}
					send_interface_toast = {
						title = you_are_cursed
						add_trait = cancer
					}
				}
				25 = { trigger = {
						NOT = { has_trait = typhus }
					}
					send_interface_toast = {
						title = you_are_cursed
						add_trait = typhus
					}
				}
			}
		}
		if = {
			limit = {
				OR = {
					has_relation_rival = scope:reci
					has_relation_nemesis = scope:reci
				}
			}
			add_stress = medium_stress_loss
		}
		gain_sc_xp1_effect = yes
		metamagic_effect = yes
		ai_chance = {
			base = 40
		}
	}
	option = {
		name = ev10.0.c
		trigger = {
			scope:reci = {
				NOT = { has_trait = lunatic_1 }
				NOT = { has_trait = depressed_1 }
			}
		}
		if = {
			limit = {	NOT = {	has_trait = yaga	}	}
			spend_standard_ps_effect = yes
			metamagic_effect = yes
		}
		scope:reci = {
			add_character_modifier = { modifier = cursed_modifier years = 4 }
			
			send_interface_toast = {
				title = you_are_cursed
				add_trait = lunatic_1
				add_trait = depressed_1
			}
			add_stress = 200
			if = {
				limit = {
					NOT = {
						has_trait = incapable
					}
				}
				random = {
					chance = 50
					add_trait = incapable
				}
			}
		}
		gain_sc_xp1_effect = yes
		metamagic_effect = yes
		ai_chance = {
			base = 30
		}
	}
	option = {
		name = ev10.0.d
		trigger = {
			NOT = { has_trait = infertile }
		}
		if = {
			limit = {	NOT = {	has_trait = yaga	}	}
			spend_standard_ps_effect = yes
			metamagic_effect = yes
		}
		scope:reci = {
			add_character_modifier = { modifier = cursed_modifier years = 4 }
			if = { limit = { has_trait = fecund }
				remove_trait = fecund
			}
			send_interface_toast = {
				title = you_are_cursed
				add_trait = infertile
			}
			add_character_modifier = infertile_modifier
		}
		gain_sc_xp1_effect = yes
		
		ai_chance = {
			base = 10
		}
	}
	option = {
		name = ev10.0.e
		ai_chance = {
			base = 0
		}
	}
}

#source
magic_ev.11 = {
	title = ev11.0.title
	desc = ev11.0.desc
	theme =  mental_health
	left_portrait = root

	trigger = {
		OR = {
			has_trait = source
			has_trait = source2
			has_trait = source3
			has_trait = source4
		}
		
		can_be_power_saturated_trigger = yes
		NOT = {
			has_character_modifier = magic_flu_modifier
		}
	}

	immediate = {
		random_list = {
			70 = {
				gain_source_ps_effect = yes
			}
			20 = {
				gain_standard_ps_effect = yes
			}
			10 = {
				gain_huge_ps_effect = yes
			}
		}
		
	}
	option = {
		name = ev11.0.a
		trait = source
		trigger = {
			NOR = {
				has_trait = source2
				has_trait = source3
				has_trait = source4
			}
		}
		add_stress = minor_stress_loss
	}
	option = {
		name = ev11.0.a
		trait = source2
		trigger = {
			has_trait = source2
			NOR = {
				has_trait = source
				has_trait = source3
				has_trait = source4
			}
		}
		add_stress = minor_stress_loss
	}
	option = {
		name = ev11.0.a
		trait = source4
		trigger = {
			has_trait = source4
			NOR = {
				has_trait = source
				has_trait = source2
				has_trait = source3
			}
		}
	}
	option = {
		name = ev11.0.a
		trait = source3
		trigger = {
			has_trait = source3
		}
		exclusive = yes
		add_stress = minor_stress_loss
		gain_sc_xp1_effect = yes
		gain_cm_xp1_effect = yes
		if = {
			limit = {
				is_ai = yes
				OR = {
					has_focus = witch_focus
					has_focus = arcane_focus
				}
			}
			add_magic_lifestyle_perk_points = 1
		}
	}
}

#summon demon confirmation
magic_ev.12 = {
	title = ev12.0.title
	desc = ev12.0.desc
	theme = witchcraft
	
	left_portrait = root


	immediate = {
		save_scope_as = this0
		save_scope_as = magic_user
	}

	option = {
		name = ev12.0.a
		trigger = {
			NOR = {
				any_equipped_character_artifact = {	has_variable = magic_scepter	}
				AND = {
					has_trait = archmage
					has_trait_xp = {
						trait = archmage
						track = demonology
						value > 99
					}
				}
			}
		}
		spend_standard_ps_effect = yes
		if = {
			limit = {
				NOT = {
					AND = {
						has_trait = archmage
						has_trait_xp = {
							trait = archmage
							track = demonology
							value > 34
						}
					}
				}
			}
			add_stress = minor_stress_gain
		}
		
		send_message_4_magic_sense_effect =yes
		clear_saved_scope = magic_user
		random_list = {
			90 = {
				#success
				desc = ev12.1.a
				custom_tooltip = ev12.1.a_ct
				if = {
					limit = {
						has_trait = grandmaster_coven
					}
					add_trait_xp = {
						trait = grandmaster_coven
						value = 10
					}
				}
				hidden_effect = {
					if = {
						limit = {
							has_trait = archmage
							has_trait_xp = {
								trait = archmage
								track = demonology
								value > 34
							}
						}
						random_list = {
							3 = { trigger_event = magic_ev.13 }
							97 = { 
								add_character_flag = no_complications
								trigger_event = magic_ev.14
							}
						}
					}
					else = {
						random_list = {
							30 = { trigger_event = magic_ev.13 }
							70 = { 
								add_character_flag = no_complications
								trigger_event = magic_ev.14
							}
						}
					}
					
				}
				send_interface_toast = {
					title = ev12.1.a
					#gain_sc_xp1_effect = yes
					gain_demonology_or_sc_standard_effect = yes
				}
			}
			5 = {
				#ritual failed
				desc = ev12.2.a
				send_interface_toast = {
					title = ev12.2.a
				}
				
			}
			4 = {
				#demon escape
				desc = ev12.3.a
				trigger_event = magic_ev.19
				custom_tooltip = ev12.3.a_ct
				send_interface_toast = {
					title = ev12.3.a
					#gain_sc_xp1_effect = yes
					gain_demonology_or_sc_standard_effect = yes
				}
			}
			1 = {
				#demon escape and hurt me
				#desc = ev12.4.a
				desc = ev12.3.a
				trigger = {
					NOT = {
						AND = {
							has_trait = archmage
							has_trait_xp = {
								trait = archmage
								track = demonology
								value > 34
							}
						}
					}
				}
				trigger_event = magic_ev.19
				custom_tooltip = ev12.3.a_ct
				send_interface_toast = {
					title = ev12.3.a
					if = {
						limit = {
							NOR = {
								has_trait = wounded_1
								has_trait = wounded_2
								has_trait = wounded_3
							}
						}
						add_trait = wounded_3
						gain_demonology_or_sc_standard_effect = yes
					}
					else = {
						death = natural
					}
				}
				#death = natural
			}
		}
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = ev12.0.c
		trigger = {
			OR = {
				any_equipped_character_artifact = {	has_variable = magic_scepter	}
				AND = {
					has_trait = archmage
					has_trait_xp = {
						trait = archmage
						track = demonology
						value > 99
					}
				}
			}
		}
		add_internal_flag = special
		spend_standard_ps_effect = yes
		gain_demonology_or_sc_standard_effect = yes
		custom_tooltip = ev12.1.a_ct
		if = {
			limit = {
				any_equipped_character_artifact = {	has_variable = magic_scepter	}
				NOT = {
					AND = {
						has_trait = archmage
						has_trait_xp = {
							trait = archmage
							track = demonology
							value > 99
						}
					}
				}
			}
			custom_tooltip = ev12.0.c_ct
		}
		
		#trigger_event = magic_ev6.5
		metamagic_effect = yes
		trigger_event = magic_ev6.74 
		ai_chance = {
			base = 100
		}
	}
	option = {
		name = ev12.0.b
		ai_chance = {
			base = 1
		}
	}
}


#summon demon complications
magic_ev.13 = {
	title = ev13.0.title
	desc = ev13.0.desc
	theme = witchcraft
	left_portrait = root

	immediate = {
		save_scope_as = this0
	}

	option = {
		name = ev13.0.a
		add_stress = medium_stress_gain
		random_list = {
			70 = {
				#success
				desc = ev13.1.a
				custom_tooltip = ev13.1.a_ct
				trigger_event = magic_ev.14
			}
			20 = {
				#demon escapes
				desc = ev12.3.a
				trigger_event = magic_ev.19
				custom_tooltip = ev12.3.a_ct
				send_interface_toast = {
					title = ev12.3.a
				}
			}
			10 = {
				#demon escape and kill me
				desc = ev13.2.a
				death = natural
			}
		}
		ai_chance = {
			base = 10
		}
	}
	option = {
		name = ev13.0.b
		add_stress = minor_stress_gain
		duel = {
			skill = learning
			value = 14
			7 = {
				desc = ev13.1.b
				compare_modifier = {
					value = scope:duel_value
					multiplier = 3
					min = 0
				}
				trigger_event = magic_ev.14
				custom_tooltip = ev13.1.a_ct
				
			}
			2 = {
				desc = ev12.3.a
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
					min = 0
				}
				
				trigger_event = magic_ev.19
				custom_tooltip = ev12.3.a_ct
				send_interface_toast = {
					title = ev12.3.a
				}
			}
			1 = {
				desc = ev13.2.a
				compare_modifier = {
					value = scope:duel_value
					multiplier = -3
					min = 0
				}
				
				death = natural
			}
		}
		ai_chance = {
			base = 10
		}
	}
	option = {
		name = ev13.0.c
		trigger_event = magic_ev.18
		custom_tooltip = ev13.0.c_ct
		ai_chance = {
			base = 100
		}
	}
}

#summon demon ritual draw
magic_ev.14 = {
	hidden = yes
	immediate = {
		scope:this0 = {
			random_list = {
				18 = {
					#minor demon
					ms_minor_demon_effect = yes
				}
				13 = {
					#Belial Instruments of iniquity and wrath
					trigger = {
						NOT = {
							any_living_character = {
								has_character_flag = belial
							}
						}
						has_character_flag = no_complications
					}
					ms_belial_demon_effect = yes
				}
				10 = {
					#Lilith
					trigger = {
						any_living_character = {
							has_character_flag = lilith
							count = 0
						}
						has_character_flag = no_complications
					}
					ms_lilith_demon_effect = yes
				}
				13 = {
					#Mammon greed
					trigger = {
						any_living_character = {
							has_character_flag = mammon
							count = 0
						}
						has_character_flag = no_complications
					}
					ms_mammon_demon_effect = yes
				}
				10 = {
					#Samael - death
					trigger = {
						any_living_character = {
							has_character_flag = samael
							count = 0
						}
						has_character_flag = no_complications
					}
					ms_samael_demon_effect = yes
				}
				4 = {
					#Moloch - rage
					trigger = {
						any_living_character = {
							has_character_flag = moloch
							count = 0
						}
						has_character_flag = no_complications
					}
					ms_moloch_demon_effect = yes
				}
				4 = {
					#child?
					trigger = {
						any_living_character = {
							has_character_flag = demon_child
							count = 0
						}
						has_character_flag = no_complications
					}
					ms_child_demon_effect = yes
				}
				10 = {
					#Hecate - magic
					trigger = {
						is_ai = no
						any_living_character = {
							has_character_flag = hecate
							count = 0
						}
						has_character_flag = no_complications
						OR = {
							NOT = {
								has_character_flag = ms_met_hecate
								has_character_flag = no_soul
							}
							AND = {
								has_character_flag = ms_met_hecate
								has_trait = archmage
							}
						}
					}
					ms_hecate_demon_effect = yes
				}
				10 = {
					#Nyx dreams
					trigger = {
						any_living_character = {
							has_character_flag = nyx
							count = 0
						}
						has_character_flag = no_complications
						NOT = {
							has_character_flag = nyx_no_more_flag
						}
					}
					ms_nyx_demon_effect = yes
				}
				4 = {
					#Asmodeus - ...
					trigger = {
						has_character_flag = no_complications
						any_living_character = {
							has_character_flag = asmodeus
							count = 0
						}
						NOR = {
							has_character_flag = ms_met_asmodeus
							has_trait = demon
						}
						exists = dynasty
						NOT = {
							dynasty = {
								has_variable = ms_met_asmodeus2
							}
						}
					}
					ms_asmodeus_demon_effect = yes
				}
			}
		}
	}
}


#minor demon // casual negotiations
magic_ev.15 = {
	title = ev15.0.title

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {

				}
				desc = ev15.0.desc
			}
			triggered_desc = {
				trigger = {

				}
				desc = ev15.0.desc
			}
			desc = ev15.0.desc
		}
	}
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		name = ev15.0.a
		trigger_event = magic_ev.16
	}
	option = {
		name = ev15.0.b
		trigger_event = magic_ev.17
	}
	option = {
		name = ev15.0.d
		trigger = {
			OR =  {
				has_trait = lunatic_1
				has_trait = lunatic_genetic
			}
		}
		if = {
			limit = { NOT = { has_trait = demon } }
			random_list = {
				10 = {
					desc = ev15.1.d
					send_interface_toast = {
						title = ev15.1.d
						set_relation_friend = scope:demon
						#set_random_friendship_reason = { TARGET = scope:demon }
					}
				}
				20 = {
					desc = ev15.2.d
					send_interface_toast = {
						title = ev15.2.d
						death = {
							death_reason = death_murder
							killer = scope:demon
						}
					}
					hidden_effect = {
						scope:demon = {
							death = natural
						}
					}
				}
			}
		}
		else = {
			random_list = {
				10 = {
					set_relation_friend = scope:demon
				}
				10 = {
					set_relation_rival = scope:demon
				}
			}
		}
		
	}
	option = {
		name = ev15.0.e
		trigger = {
			any_equipped_character_artifact = {
				has_variable = magic_scepter
			}
		}
		add_internal_flag = special
		custom_tooltip = ev12.0.c_ct
		show_as_tooltip = {
			add_courtier = scope:demon
		}
		scope:demon = {
			add_opinion = {
				target = ROOT
				modifier = respect_opinion
				opinion = 200
			}
			hidden_effect = {
				add_character_flag = special_magic_character
			}
		}
	}
	option = {
		name = ev15.0.c
		add_stress = -30
		trigger_event = magic_ev.18
	}
}

#demon casual negotiations 2 power
magic_ev.16 = {
	title = ev16.0.title

	desc = ev16.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon

	option = {
		name = ev16.0.a
		random_list = {
			10 = {
				send_interface_toast = {
					title = ev16.t.a
					add_diplomacy_skill = 1
				}
				hidden_effect = {
					if = {
						limit = {
							NAND = {
								has_trait = diplomat
								has_trait = august
								has_trait = family_first
							}
						}
						random = {
							chance = 75
							add_diplomacy_lifestyle_perk_points = 1
						}
						
					}
				}
			}
			10 = {
				send_interface_toast = {
					title = ev16.t.a
					add_martial_skill = 1
				}
				hidden_effect = {
					if = {
						limit = {
							NAND = {
								has_trait = strategist
								has_trait = overseer
								has_trait = gallant
							}
						}
						random = {
							chance = 75
							add_martial_lifestyle_perk_points =  1
						}
						
					}
				}
			}
			10 = {
				send_interface_toast = {
					title = ev16.t.a
					add_stewardship_skill = 1
				}
				hidden_effect = {
					if = {
						limit = {
							NAND = {
								has_trait = avaricious
								has_trait = architect
								has_trait = administrator
							}
						}
						random = {
							chance = 75
							add_stewardship_lifestyle_perk_points = 1
						}
						
					}
				}
			}
			10 = {
				send_interface_toast = {
					title = ev16.t.a
					add_intrigue_skill = 1
				}
				hidden_effect = {
					if = {
						limit = {
							NAND = {
								has_trait = schemer
								has_trait = seducer
								has_trait = torturer
							}
						}
						random = {
							chance = 75
							add_intrigue_lifestyle_perk_points = 1
						}
						
					}
				}
			}
			10 = {
				send_interface_toast = {
					title = ev16.t.a
					add_learning_skill = 1
				}
				hidden_effect = {
					if = {
						limit = {
							NAND = {
								has_trait = whole_of_body
								has_trait = scholar
								has_trait = theologian
							}
						}
						random = {
							chance = 75
							add_learning_lifestyle_perk_points = 1
						}
					}
				}
			}
			10 = {
				trigger = {
					has_trait = archmage
					has_trait_xp = {
						trait = archmage
						track = secret_knowledge
						value < 100
					}
				}
				send_interface_toast = {
					title = ev16.t.a
					gain_sc_xp1_effect = yes
					gain_cm_xp1_effect = yes
				}
			}
			#10 = { add_martial_skill = 3 }
			#10 = { add_stewardship_skill = 3 }
			#10 = { add_intrigue_skill = 3 }
			#10 = { add_learning_skill = 3 }
		}
		custom_tooltip = ev16.0.a_ct
		
		trigger_event = magic_ev.18
	}
	option = {
		name = ev16.0.b
		if = {
			limit = {
				NOT = {
					has_trait = necromancer
				}
			}
			add_trait = necromancer
		}
		#spawn_army = {
		#	levies = {
		#		add = max_military_strength
		#		multiply = 0.25
		#	}
		#	location = root.capital_province
		#	name = undead_army_loc
		#	inheritable = no
		#	uses_supply = no
		#}
		if = {
			limit = {
				max_military_strength < 1000
			}
			spawn_army = {
				name = undead_army_loc
				men_at_arms = {
					type = skeletons
					stacks = 1
				}
				inheritable = no
				uses_supply = no
				location = root.capital_province
			}
		}
		else_if = {
			limit = {
				max_military_strength < 2000
			}
			spawn_army = {
				name = undead_army_loc
				men_at_arms = {
					type = skeletons
					stacks = 2
				}
				inheritable = no
				uses_supply = no
				location = root.capital_province
			}
		}
		else_if = {
			limit = {
				max_military_strength < 3000
			}
			spawn_army = {
				name = undead_army_loc
				men_at_arms = {
					type = skeletons
					stacks = 3
				}
				inheritable = no
				uses_supply = no
				location = root.capital_province
			}
		}
		else_if = {
			limit = {
				max_military_strength < 4000
			}
			spawn_army = {
				name = undead_army_loc
				men_at_arms = {
					type = skeletons
					stacks = 4
				}
				inheritable = no
				uses_supply = no
				location = root.capital_province
			}
		}
		else = {
			spawn_army = {
				name = undead_army_loc
				men_at_arms = {
					type = skeletons
					stacks = 5
				}
				inheritable = no
				uses_supply = no
				location = root.capital_province
			}
		}
		

		trigger_event = magic_ev.18

	}

	option = {
		name = ev16.0.c
		trigger = {
			NOT = {	has_character_modifier = gift_from_hell_modifier	}
		}
		add_character_modifier = gift_from_hell_modifier
		trigger_event = magic_ev.18

	}
}

#demon casual negotiations 2 wealthy
magic_ev.17 = {
	title = ev17.0.title

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {

				}
				desc = ev17.0.desc
			}
			triggered_desc = {
				trigger = {

				}
				desc = ev17.0.desc
			}
			desc = ev17.0.desc
		}
	}
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon

	option = {
		name = ev17.0.a
		add_gold = demon_gold_value
		trigger_event = magic_ev.18
	}
	
	option = {
		name = ev17.0.b
		custom_tooltip = ev17.0.b_ct
		hidden_effect = {
			set_artifact_rarity_famed = yes
		random_list = {
			2 = {
				create_artifact_weapon_effect = {
					OWNER = scope:this0
					CREATOR = scope:demon
					SET_WEAPON_TYPE = flag:no
				}
				scope:newly_created_artifact = {
					set_artifact_rarity = famed
					set_artifact_feature_group = decoration_material_wire
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prowess_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_combat_effect = yes
						}
						10 = {
							add_2_scaled_artifact_modifier_combat_effect = yes
						}
					}
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prestige_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_combat_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prowess_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_dynasty_prestige_effect = yes
						}
					}
					
				}
			}
			2 = {
				create_artifact_armor_effect = {
					OWNER = scope:this0
					CREATOR = scope:demon
					SET_ARMOR_TYPE = flag:no
				}
				scope:newly_created_artifact = {
					set_artifact_rarity = famed
					set_artifact_feature_group = decoration_material_wire
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_combat_effect = yes
						}
						10 = {
							add_2_scaled_artifact_modifier_combat_effect = yes
						}
					}
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prestige_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_combat_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_grandeur_big_effect = yes
						}
					}
				}
			}
			2 = {
				create_artifact_regalia_effect = {
					OWNER = scope:this0
					SMITH = scope:demon
				}
				scope:newly_created_artifact = {
					set_artifact_rarity = famed
					set_artifact_feature_group = decoration_material_wire
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prestige_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_grandeur_big_effect = yes
						}
						10 = {
							add_2_scaled_artifact_modifier_rulership_effect = yes
						}
					}
					random_list = {
						10 = {
							add_scaled_artifact_modifier_grandeur_small_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_dynasty_prestige_effect = yes
						}
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_rulership_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_intrigue_effect  = yes
						}
					}
				}
			}
		}
		trigger_event = magic_ev.18
		}

	}

	option = {
		name = ev17.0.c
		trigger = {
			has_trait = greedy
		}
		trait = greedy
		add_gold = demon_gold_value
		custom_tooltip = ev17.0.b_ct

		hidden_effect = {
		random_list = {
			2 = {
				create_artifact_weapon_effect = {
					OWNER = scope:this0
					CREATOR = scope:demon
					SET_WEAPON_TYPE = flag:no
				}
				scope:newly_created_artifact = {
					set_artifact_rarity = famed
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prowess_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_combat_effect = yes
						}
						10 = {
							add_2_scaled_artifact_modifier_combat_effect = yes
						}
					}
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prestige_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_combat_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prowess_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_dynasty_prestige_effect = yes
						}
					}
					
				}
			}
			2 = {
				create_artifact_armor_effect = {
					OWNER = scope:this0
					CREATOR = scope:demon
					SET_ARMOR_TYPE = flag:no
				}
				scope:newly_created_artifact = {
					set_artifact_rarity = famed
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_combat_effect = yes
						}
						10 = {
							add_2_scaled_artifact_modifier_combat_effect = yes
						}
					}
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prestige_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_combat_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_grandeur_big_effect = yes
						}
					}
				}
			}
			2 = {
				create_artifact_regalia_effect = {
					OWNER = scope:this0
					SMITH = scope:demon
				}
				scope:newly_created_artifact = {
					set_artifact_rarity = famed
					random_list = {
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_prestige_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_grandeur_big_effect = yes
						}
						10 = {
							add_2_scaled_artifact_modifier_rulership_effect = yes
						}
					}
					random_list = {
						10 = {
							add_scaled_artifact_modifier_grandeur_small_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_dynasty_prestige_effect = yes
						}
						10 = {
							add_2_scaled_artifact_modifier_majesty_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_rulership_effect = yes
						}
						10 = {
							add_scaled_artifact_modifier_intrigue_effect  = yes
						}
					}
				}
			}
		}
		trigger_event = magic_ev.18
		}
	}
}

#negotiations ends
magic_ev.18 = {
	title = ev18.0.title

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {

				}
				desc = ev18.0.desc
			}
			triggered_desc = {
				trigger = {

				}
				desc = ev18.0.desc
			}
			desc = ev18.0.desc
		}
	}
	theme = witchcraft
	left_portrait = root

	option = {
		name = ev18.0.a
		add_stress = -5
		#add_character_modifier = power_saturated2
		if = { limit = { has_character_flag = no_complications }
			remove_character_flag = no_complications
		}
	}
	after = {
		hidden_effect = {
			if = {
				limit = {
					exists = scope:demon
				}
				scope:demon = {
					death = natural
				}
			}
			if = {
				limit = {
					exists = scope:demon_child
				}
				scope:demon_child = {
					death = natural
				}
			}
		}
		metamagic_effect = yes
	}
}

#demon escaped
magic_ev.19 = {
	hidden = yes
	immediate = {
		scope:this0 = {
			if = { limit = { is_independent_ruler = yes }
				random_ruler = {
					limit = {
						NOT = { this = scope:this0 }
						any_held_title = { is_neighbor_to_realm = scope:this0 }
						is_ai = yes
						is_landed = yes
					}
					save_scope_as = target
				}
				
			}
			else = {
				liege = {
					if = {
						limit = {
							is_ai = yes
						}
						save_scope_as = target
					}
					else = {
						random_vassal = {
							limit = {
								is_ai = yes
							}
							save_scope_as = target
						}
					}
				}
			}
			if = {
				limit = {
					NOT = {
						exists = scope:target
					}
				}
				random_ruler = {
					limit = {
						NOT = { this = scope:this0 }
						is_ai = yes
						is_landed = yes
					}
					save_scope_as = target
				}
			}
		}
		create_character = {
			employer = scope:target
			gender_female_chance = 30
			#location = scope:target
			template = generic_demon_character
			save_scope_as = demon
		}
		scope:demon = {
			set_relation_nemesis = scope:this0
			#set_relation_rival = scope:heir0
			if = {
				limit = {
					exists = primary_heir
				}
				set_random_rivalry_reason = { TARGET = primary_heir }
			}
			
			set_relation_mminion = scope:target
			add_trait_xp = {
				trait = demon
				value = { 25 50 }
			}
			if = {
				limit = {
					NOT = {
						has_perk = a_job_done_right_perk
					}
				}
				random = {
					chance = 90
					add_perk = a_job_done_right_perk
				}
			}
			add_character_modifier = demonic_charm_modifier
			gain_source_ps_effect = yes
			add_gold = 250
			random = {
				chance = 50
				add_character_modifier = {
					modifier = oneiromancy_modifier
					years = 5
				}
			}
			random = {
				chance = 50
				add_character_modifier = {
					modifier = preparation_for_strike_modifier
					years = 5
				}
			}
			random = {
				chance = 50
				add_character_modifier = mind_reader_modifier
			}
			add_hook = {
				type = magic_domination_hook
				target = scope:target
			}
			start_scheme = {
				type = murder
				target = scope:this0
			}
		}
		scope:target = {
			set_relation_rival = scope:this0
			#set_random_rivalry_reason = { TARGET = scope:this0 }
			add_character_modifier = {
				modifier = masters_orders_modifier
				years = 5
			}
			add_opinion = {
				target = scope:this0
				modifier = rival_my_master_opinion_modifier
			}
			if = {
				limit = {
					exists = cp:councillor_spymaster
				}
				fire_councillor = cp:councillor_spymaster
			}
			
			assign_councillor_type = {
				type = councillor_spymaster
				target = scope:demon
			}
			start_scheme = {
				type = abduct
				target = scope:this0
			}
		}
	}
}

#Belial introduction
magic_ev.20 = {
	title = ev15.0.title

	desc = ev20.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		outfit_tags = { military_outfit }
	}

	option = {
		name = ev20.0.a
		trigger_event = magic_ev.22
	}
	option = {
		name = ev20.0.b
		trigger_event = magic_ev.21
		#set_character_flag = demon_insult
	}
	option = {
		name = ev20.0.c
		add_stress = -30
		trigger_event = magic_ev.18
	}
}

#Belial insulted
magic_ev.21 = {
	title = ev15.0.title

	desc = ev21.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		outfit_tags = { military_outfit }
	}

	option = {
		name = ev21.0.a
		trigger_event = {
			id = magic_ev.24
			days = 1
		}
	}
	option = {
		name = ev21.0.b
		trigger_event = magic_ev.22
	}
	option = {
		name = ev21.0.c
		add_stress = -30
		if = {
			limit = {
				NOT = { has_character_modifier = contempt_for_belial }
			}
			add_character_modifier = contempt_for_belial
		}
		
		trigger_event = magic_ev.18
	}
}

#Belial guidance
magic_ev.22 = {
	title = ev15.0.title

	desc = ev22.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		outfit_tags = { military_outfit }
	}

	option = {
		name = ev22.0.a
		trigger_event = magic_ev.23
		custom_tooltip = ev22.0.a_ct
	}
	option = {
		name = ev22.0.b
		trigger = {
			NOT = { has_character_modifier = strength_ohm_modifier }
		}
		
		add_character_modifier = strength_ohm_modifier
		if = {
			limit = {
				has_trait = weak
			}
			remove_trait = weak
		}
		if = {
			limit = {
				has_trait = physique_bad_3
			}
			remove_trait = physique_bad_3
		}
		else_if = {
			limit = {
				has_trait = physique_bad_2
			}
			remove_trait = physique_bad_2
		}
		else_if = {
			limit = {
				has_trait = physique_bad_1
			}
			remove_trait = physique_bad_1
		}

		if = {
			limit = {
				NOT = { has_trait = strong }
			}
			add_trait = strong
		}
		trigger_event = magic_ev.18
	}
	option = {
		name = ev22.0.c
		trigger = {
			NOT = { has_character_modifier = demonic_charm_modifier }
		}
		add_character_modifier = demonic_charm_modifier
		trigger_event = magic_ev.18
	}
}

#Belial general?
magic_ev.23 = {
	title = ev15.0.title

	desc = ev23.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		outfit_tags = { military_outfit }
	}
	immediate = {
		save_scope_as = this0
	}

	option = {
		name = ev23.0.a
		if = {
			limit = {
				exists = cp:councillor_marshal
			}
			fire_councillor = cp:councillor_marshal
		}
		assign_councillor_type = {
			type = councillor_marshal
			target = scope:demon
		}
		set_relation_mminion = scope:demon
		
		if = {
			limit = {
				NOT = { has_character_modifier = belial_blessing_modifier }
			}
			add_character_modifier = {
				modifier = belial_blessing_modifier
				years = 10
			}
		}
		spawn_army = {
			name = demonic_knights
			men_at_arms = {
				type = demonic_knights
				stacks = 1
			}
			levies = {
				add = 400
			}
			inheritable = no
			uses_supply = no
			location = root.location
		}
		scope:demon = {
			save_scope_as = belial
		}
		trigger_event = {
			id = magic_ev.25
			years = 10
			#days = 10
		}
		ai_chance = {
			base = 1
		}
	}

	option = {
		name = ev23.0.b
		trigger_event = magic_ev.18
		if = {
			limit = {
				NOT = { has_character_modifier = belial_blessing_modifier }
			}
			add_character_modifier = {
				modifier = belial_blessing_modifier
				years = 10
			}
		}
		else = {
			add_martial_skill=3
		}
		ai_chance = {
			base = 100
		}
	}

	option = {
		name = ev23.0.c
		trigger_event = magic_ev.18
		trigger = {
			martial > 20
			NOT = { has_character_modifier = more_knights_modifier }
		}
		skill = martial
		add_character_modifier = {
			modifier = more_knights_modifier
		}
		if = {
			limit = {
				NOT = { has_character_modifier = belial_blessing_modifier }
			}
			add_character_modifier = {
				modifier = belial_blessing_modifier
				years = 10
			}
		}
		else = {
			add_martial_skill=3
		}
		ai_chance = {
			base = 300
		}
	}
	
}

#one wish from Belial
magic_ev.24 = {
	title = ev15.0.title

	desc = ev24.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = {
		character = scope:demon
		outfit_tags = { military_outfit }
	}
	immediate = {
		random_relation ={
			limit = {
				NOR = {
					has_character_flag = abdul_dude
					has_character_flag = bael_flag
					has_character_flag = merlin_dude
				}
				is_ai = yes
			}
			type = rival
			
			add_to_list = potential_targets
		}
		random_relation ={
			limit = {
				NOR = {
					has_character_flag = abdul_dude
					has_character_flag = bael_flag
					has_character_flag = merlin_dude
				}
				is_ai = yes
			}
			type = nemesis
			add_to_list = potential_targets
		}
		random_in_list = {
			list = potential_targets
			save_scope_as = potential_target
		}
	}

	option = {
		name = ev24.0.a
		trigger_event = magic_ev.18
		trigger = {
			exists = scope:potential_target
		}
		scope:potential_target = {
			death = natural
		}


	}

	option = {
		name = ev24.0.b
		trigger_event = magic_ev.18
		random_list = {
			1 = {
				add_diplomacy_skill=1
				add_martial_skill=1
				add_stewardship_skill=1
				add_intrigue_skill=1
				add_learning_skill=1
			}
			1 = {
				trigger = {
					has_trait = archmage
					is_legendary_mage_trigger = no
				}
				gain_sc_xp2_effect = yes
			}
		}
		
		
	}

	option = {
		name = ev24.0.c
		trigger_event = magic_ev.18
		trigger = {
			OR = {
				has_trait = physique_bad_3
				has_trait = physique_bad_2
				has_trait = physique_bad_1
				has_trait = pregnant
				has_trait = disfigured
				has_trait = beauty_bad_1
				has_trait = beauty_bad_2
				has_trait = beauty_bad_3
				has_trait = clubfooted
				has_trait = hunchbacked
				has_trait = lisping
				has_trait = stuttering
				has_trait = inbred
				has_trait = weak
				has_trait = impotent
				has_trait = scaly
				has_trait = bleeder
				has_trait = infertile
				has_character_modifier = infertile_modifier
			}
		}
		if = {
			limit = {
				has_character_modifier = infertile_modifier
			}
			remove_character_modifier = infertile_modifier
		}
		if = {
			limit = {
				has_trait = infertile
			}
			remove_trait = infertile
		}
		if = {
			limit = {
				has_trait = bleeder
			}
			remove_trait = bleeder
		}
		if = {
			limit = {
				has_trait = physique_bad_3
			}
			remove_trait = physique_bad_3
		}
		if = {
			limit = {
				has_trait = physique_bad_2
			}
			remove_trait = physique_bad_2
		}
		if = {
			limit = {
				has_trait = physique_bad_1
			}
			remove_trait = physique_bad_1
		}
		if = {
			limit = {
				has_trait = pregnant
			}
			remove_trait = pregnant
		}
		if = {
			limit = {
				has_trait = disfigured
			}
			remove_trait = disfigured
		}
		if = {
			limit = {
				has_trait = beauty_bad_1
			}
			remove_trait = beauty_bad_1
		}
		if = {
			limit = {
				has_trait = beauty_bad_2
			}
			remove_trait = beauty_bad_2
		}
		if = {
			limit = {
				has_trait = beauty_bad_3
			}
			remove_trait = beauty_bad_3
		}
		if = {
			limit = {
				has_trait = clubfooted
			}
			remove_trait = clubfooted
		}
		if = {
			limit = {
				has_trait = hunchbacked
			}
			remove_trait = hunchbacked
		}
		if = {
			limit = {
				has_trait = lisping
			}
			remove_trait = lisping
		}
		if = {
			limit = {
				has_trait = stuttering
			}
			remove_trait = stuttering
		}
		if = {
			limit = {
				has_trait = inbred
			}
			remove_trait = inbred
		}
		if = {
			limit = {
				has_trait = weak
			}
			remove_trait = weak
		}
		if = {
			limit = {
				has_trait = impotent
			}
			remove_trait = impotent
		}
		if = {
			limit = {
				has_trait = scaly
			}
			remove_trait = scaly
		}

		random = {
			chance = 10
			add_trait = pure_blooded
		}
	}

	option = {
		name = ev24.0.d
		trigger_event = magic_ev.18
		trigger = {
			NOR = {
				has_trait = physique_good_3
				has_trait = physique_bad_3
				has_trait = physique_bad_2
				has_trait = physique_bad_1
			}
		}
		if = {
			limit = { has_trait = physique_good_1 }
			hidden_effect = {
				remove_trait = physique_good_1
			}
			custom_tooltip = ev24.0.d_ct
			add_trait_force_tooltip = physique_good_3
		}
		else_if = {
			limit = { has_trait = physique_good_2 }
			hidden_effect = {
				remove_trait = physique_good_2
			}
			custom_tooltip = ev24.0.d_ct
			add_trait_force_tooltip = physique_good_3
		}
		else = {
			add_trait_force_tooltip = physique_good_2
		}
	}
	after = {
		clear_saved_scope = potential_target
	}
	
}

#Belial 10 years later
magic_ev.25 = {
	hidden = yes
	#type = empty
	scope = none
	trigger = {
		scope:this0 = {
			is_alive = yes
			is_imprisoned = no
			is_landed = yes
		}
		scope:belial = {
			is_alive = yes
			is_imprisoned = no
		}
	}
	on_trigger_fail = {
		trigger_event = magic_ev.26
	}
	immediate = {
		scope:this0 = {
			if = {
				limit = {
					OR = {
						has_relation_best_friend = scope:belial
						has_relation_friend = scope:belial
						has_relation_lover = scope:belial
						has_relation_soulmate = scope:belial
					}
				}
				trigger_event = magic_ev.27
			}
			else = {
				trigger_event = magic_ev.28
			}
		}
	}
}

#Belial 10 years later (canceling)
magic_ev.26 = {
	hidden = yes
	#type = empty
	scope = none
	trigger = {
		OR = {
			scope:this0 = {
				OR = {
					is_alive = no
					is_imprisoned = yes
				}
			}
			scope:belial = {
				OR = {
					is_alive = no
					is_imprisoned = yes
				}
			}
		}
	}
	immediate = {
		scope:belial = {
			if = { limit = { is_alive = yes }
				death = natural
			}
		}
	}
}

#Belial happy ending
magic_ev.27 = {
	title = ev15.0.title

	desc = ev27.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:belial
	immediate = {
		save_scope_as = this0
	}

	option = {
		name = ev27.0.a
		hidden_effect = {
			scope:belial = {
				death = natural
			}
		}
	}
	
}

#Belial bad ending
magic_ev.28 = {
	title = ev15.0.title

	desc = ev28.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:belial
	immediate = {
		save_scope_as = this0
		remove_relation_mminion = scope:belial
		if = {
			limit = {
				is_independent_ruler = no
			}
			liege = {
				save_scope_as = liege0
			}
		}
		
	}

	option = {
		name = ev28.0.a
		scope:belial = {
			hidden_effect = {
				add_character_modifier = belial_blessing_modifier
				add_perk = protective_runes_perk
			}
		}
		set_relation_mmaster = scope:belial
		
		if = {
			limit = { highest_held_title_tier = tier_county }
		
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = title_change
				add_claim_on_loss = no
			}

			every_held_title = {
				limit = {
					NOT = { this = root.capital_county }
					#is_capital_barony = no
					#is_county_capital = no
				}
			
				change_title_holder_include_vassals = {
					holder = scope:belial
					change = scope:title_change
				}
			
			}
			resolve_title_and_vassal_change = scope:title_change
			if = {
				limit = {
					exists = scope:liege0
				}
				scope:belial = {
					create_title_and_vassal_change = {
						type = granted
						save_scope_as = title_change2
						add_claim_on_loss = no
					}
					change_liege = {
						liege = scope:liege0
						change = scope:title_change2
					}
					resolve_title_and_vassal_change = scope:title_change2
				}
				
			}
		}
		else = {
			create_title_and_vassal_change = {
				type = granted
				save_scope_as = title_change
				add_claim_on_loss = yes
			}

			every_held_title = {
				limit = {
					NOT = { this = root.capital_county }
					#is_capital_barony = no
					#is_county_capital = no
				}
			
				change_title_holder_include_vassals = {
					holder = scope:belial
					change = scope:title_change
				}
			
			}
			change_liege = {
				liege = scope:belial
				change = scope:title_change
			}
			resolve_title_and_vassal_change = scope:title_change
			if = {
				limit = {
					exists = scope:liege0
				}
				scope:belial = {
					create_title_and_vassal_change = {
						type = granted
						save_scope_as = title_change2
						add_claim_on_loss = no
					}
					change_liege = {
						liege = scope:liege0
						change = scope:title_change2
					}
					resolve_title_and_vassal_change = scope:title_change2
				}
			}
		}
		#create_alliance = {
		#	target = scope:belial
		#	allied_through_owner = scope:this0
		#	allied_through_target = scope:belial
		#}
		#trigger_event = magic_ev.29
		clear_saved_scope = belial
	}
	
	option = {
		name = ev28.0.b
		custom_tooltip = start_duel_ct
		scope:this0 = {
			save_scope_as = actor
		}
		if = {
			limit = {
				has_trait = archmage
			}
			configure_start_mage_duel_effect = {
				MD_ATTACKER = scope:this0
				MD_DEFENDER = scope:belial
			}
		}
		else = {
			configure_start_single_combat_effect = {
				SC_INITIATOR = scope:this0
				SC_ATTACKER = scope:this0
				SC_DEFENDER = scope:belial
				FATALITY = always
				FIXED = no
				LOCALE = throne_room
				OUTPUT_EVENT = fp1_tbc.0011
				INVALIDATION_EVENT = fp1_tbc.0021
			}
		}
		hidden_effect = {
			every_held_title = {
				add_to_list = personally_held_counties_list2
			}
			every_in_list = {
				list = personally_held_counties_list2
				add_pressed_claim = scope:belial
			}
		}
		
		clear_saved_scope = belial
	}

	option = {
		name = ev2.11.d2
		trigger = {
			has_trait = archmage
			#any_character_artifact = { has_variable = blackgrimoire }
			can_use_banish_spell = yes
		}
		trait = archmage
		custom_tooltip = banish_demon_ct
		hidden_effect = {
			scope:belial = {
				death = natural
			}
		}
		clear_saved_scope = belial
	}
	option = {
		name = ev28.0.c
		trigger = {
			any_character_artifact = { has_variable = magic_scepter }
			diplomacy > 16
		}
		skill = diplomacy
		add_prestige = minor_prestige_gain
		trigger_event = magic_ev6.72
	}

	#after = {
		#scope:belial = {
		#	create_alliance = root
		#}
	#}
}

#mammon says hello
magic_ev.30 = {
	title = ev30.0.title

	desc = ev30.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		name = ev30.0.a
		trigger_event = magic_ev.31
	}
}

#mammon strange conversation
magic_ev.31 = {
	title = ev30.0.title

	desc = ev31.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		name = ev31.0.a
		trigger_event = magic_ev.32
	}
	option = {
		name = ev31.0.b
		trigger_event = magic_ev.32
	}
	option = {
		name = ev31.0.c
		trigger_event = magic_ev.32
	}
	option = {
		name = ev31.0.d
		trigger_event = magic_ev.32
	}
}

#mammon why am I here?
magic_ev.32 = {
	title = ev30.0.title

	desc = ev32.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		#I want you to do something for me.
		name = ev32.0.a
		trigger_event = magic_ev.33
	}
	option = {
		#I'm not sure.
		name = ev32.0.b
		trigger_event = magic_ev.36
	}
	option = {
		#Disappear.
		name = ev32.0.c
		add_stress = -30
		trigger_event = magic_ev.18
	}
}

#mammon numbers
magic_ev.33 = {
	title = ev30.0.title

	desc = ev33.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		#I want you to do something for me.
		name = ev33.0.a
		trigger_event = magic_ev.34
	}
}
#Arithmetic, gains, losses...
magic_ev.34 = {
	title = ev30.0.title

	desc = ev34.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		#Can you give me gold?
		name = ev34.0.a
		trigger_event = magic_ev.35
	}
	option = {
		#Show me future
		name = ev34.0.b
		trigger = {
			learning > 16
		}
		skill = learning
		add_character_modifier = {
			modifier = looked_to_the_future
			years = 8
		}
		trigger_event = magic_ev.18
	}
}

#I have a tons of gold bars, coins, jewelry. Do you want some?
magic_ev.35 = {
	title = ev30.0.title

	desc = ev35.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		#sure
		name = ev35.0.a
		trigger_event = magic_ev.18
		add_gold = demon_gold_value

		#hidden_effect = {
		#	if = {
		#		limit = {
		#			NOT = { any_character_artifact = { has_variable = magic_ring } }
		#		}
		#		add_character_modifier = {
		#			modifier = cursed_gold_modifier
		#			years = 3
		#		}
		#	}
		#}
	}

	option = {
		#sure wealth!
		name = ev35.0.c
		trigger = {
			has_trait = greedy
		}
		trait = greedy
		trigger_event = magic_ev.18
		add_gold = greedy_gold_value

		#hidden_effect = {
		#	if = {
		#		limit = {
		#			NOT = { any_character_artifact = { has_variable = magic_ring } }
		#		}
		#		add_character_modifier = {
		#			modifier = cursed_gold_modifier
		#			years = 6
		#		}
		#	}
		#}
	}

	option = {
		#teach me
		name = ev35.0.b
		if = {
			limit = {
				NOT = {
					has_character_modifier = financial_knowledge_modifier
				}
			}
			add_character_modifier = {
				modifier = financial_knowledge_modifier
				years = 8
			}
		}
		else = {
			add_stewardship_skill = 3
		}
		trigger_event = magic_ev.18
		
	}
}


#you are not sure...
magic_ev.36 = {
	title = ev30.0.title

	desc = ev36.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		#I release you.
		name = ev36.0.a
		trigger_event = magic_ev.37
		ai_chance = {
			base = 1
		}
	}
	option = {
		#Nice try.
		name = ev36.0.b
		trigger_event = magic_ev.38
		ai_chance = {
			base = 100
		}
	}

}

#you fool...
magic_ev.37 = {
	title = ev37.0.title

	desc = ev37.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		#noooo!
		name = ev37.0.a
		trigger = {
			NOT = {
				has_trait = archmage
			}
		}
		death = {
			death_reason = death_murder
			killer = scope:demon
		}
		hidden_effect = {
			scope:demon = {
				death = natural
			}
		}
	}
	option = {
		#Are you sure you want to mess with a mage?
		name = ev2.11.f
		trigger = {
			has_trait = archmage
		}
		custom_tooltip = start_duel_ct
		configure_start_mage_duel_effect = {
			MD_ATTACKER = root
			MD_DEFENDER = scope:demon
		}
	}
}

#what do you want, mage?
magic_ev.38 = {
	title = ev30.0.title

	desc = ev38.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		#my potential
		name = ev38.0.a
		trigger = {
			NOT = { has_trait = intellect_good_3 }
		}
		if = {
			limit = {
				has_trait = intellect_good_2
			}
			hidden_effect = {
				remove_trait = intellect_good_2
			}
			add_trait_force_tooltip = intellect_good_3
		}
		else_if = {
			limit = {
				has_trait = intellect_good_1
			}
			hidden_effect = {
				remove_trait = intellect_good_1
			}
			add_trait_force_tooltip = intellect_good_3
		}
		else = {
			add_trait_force_tooltip = intellect_good_2
		}
		trigger_event = magic_ev.18
		#hidden_effect = {
		#	if = {
		#		limit = {
		#			NOT = { has_trait = lunatic_1 }
		#			NOT = { any_character_artifact = { has_variable = magic_ring } }
		#		}
		#		add_trait = lunatic_1
		#	}
		#}
	}
	option = {
		#knowledge
		name = ev38.0.b
		trigger_event = magic_ev.18
		trigger = {
			NOT = { has_character_modifier = mammons_knowledge_modifier }
		}
		#add_learning_skill = 2
		#gain_source_ps_effect = yes
		gain_sc_xp2_effect = yes
		add_character_modifier = {
			modifier = mammons_knowledge_modifier
			years = 12
		}
		
		#hidden_effect = {
		#	if = {
		#		limit = {
		#			NOT = { has_trait = possessed_1 }
		#			NOT = { any_character_artifact = { has_variable = magic_ring } }
		#			NOT = {	has_character_modifier = amp_modifier	}
		#		}
		#		add_trait = possessed_1
		#	}
		#}
	}
	option = {
		#wealth
		name = ev38.0.c
		
		add_gold = demon_gold_value
		#hidden_effect = {
		#	if = {
		#		limit = {
		#			NOT = { any_character_artifact = { has_variable = magic_ring } }
		#			NOT = {	has_character_modifier = amp_modifier	}
		#		}
		#		add_character_modifier = {
		#			modifier = cursed_gold_modifier
		#			years = 3
		#		}
		#	}
		#	
		#}
		trigger_event = magic_ev.18
	}

	option = {
		#wealth++
		name = ev38.0.d
		trigger = {
			has_trait = greedy
		}
		
		add_gold = greedy_gold_value
		#add_gold = monumental_gold_value
		#hidden_effect = {
		#	if = {
		#		limit = {
		#			NOT = { any_character_artifact = { has_variable = magic_ring } }
		#		}
		#		add_character_modifier = {
		#			modifier = cursed_gold_modifier
		#			years = 6
		#		}
		#	}
		#	
		#}
		trigger_event = magic_ev.18
	}
	option = {
		#protection
		name = ev38.0.e
		trigger = {
			NOT = {
				has_character_modifier = amp_modifier
			}
			has_trait = craven
		}
		trait = craven
		add_character_modifier = {
			modifier = amp_modifier
			years = 20
		}
		stress_impact = {
			craven = medium_stress_loss
			paranoid = medium_stress_loss
		}
		trigger_event = magic_ev.18
	}
}

#Lilith introduction
magic_ev.39 = {
	title = ev39.0.title

	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					is_male = yes
				}
				desc = ev39.0.desc
			}
			desc = ev39.1.desc
		}
	}
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		name = ev39.0.a
		trigger_event = magic_ev.40
	}
}

#Lilith 2
magic_ev.40 = {
	title = ev39.0.title

	desc = ev40.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		name = ev40.0.a
		trigger_event = magic_ev.41
	}
}

# Lilith seduction
magic_ev.41 = {
	title = ev39.0.title

	desc = ev41.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = this0
	}

	option = {
		#yes
		name = ev41.0.a
		trigger_event = magic_ev.42
		ai_chance = {
			base = 1
		}
	}

	option = {
		#no
		name = ev41.0.b
		add_stress = minor_stress_gain
		trigger = {
			diplomacy > 16
		}
		skill = diplomacy
		trigger_event = magic_ev.43
		ai_chance = {
			base = 100
		}
	}

	option = {
		#no - chaste
		name = ev41.0.b
		add_stress = minor_stress_gain
		trigger = {
			diplomacy < 17
			has_trait = chaste
		}
		trait = chaste
		trigger_event = magic_ev.43
		ai_chance = {
			base = 100
		}
	}
}

#...succeded
magic_ev.42 = {
	title = ev39.0.title

	desc = ev42.0.desc
	theme = witchcraft
	override_background = { reference = bedchamber }
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = owner
		scope:demon = {
			save_scope_as = target
		}
		#owner_seduce_outcome_sex_effect = yes
	}

	option = {
		name = ev42.0.a
		#trigger_event = magic_ev.42
		#had_sex_with_effect = {
		#	CHARACTER = scope:demon
		#}
		
		#owner_seduce_outcome_become_lovers_option_effects = yes
		#set_relation_lover_through_seduction_effect = {
		#	CHARACTER = scope:target
		#}
		#hidden_effect = {
		#	set_relation_lover = scope:demon
		#}
		if = {
			limit = {
				OR = {
					AND = {
						is_male = no
						has_sexuality = heterosexual
					}
					AND = {
						is_male = yes
						has_sexuality = homosexual
					}
				}
			}
			set_sexuality = bisexual
		}
		had_sex_with_effect = {
				CHARACTER = scope:target
				PREGNANCY_CHANCE = seduce_pregnancy_chance
		}
		
		add_character_modifier = joy_with_lilith_modifier
		set_relation_lover = scope:target
		#set_random_lover_reason = { TARGET = scope:target }
		trigger_event = {
			id = magic_ev.45
			days = { 10 20 }
		}
	}
}

#what do yo desire?
magic_ev.43 = {
	title = ev39.0.title

	desc = ev43.0.desc
	theme = witchcraft
	left_portrait = root
	right_portrait = scope:demon
	immediate = {
		save_scope_as = owner
		scope:demon = {
			save_scope_as = target
		}
		
	}

	option = {
		name = ev43.0.a
		
		#had_sex_with_effect = {
		#	CHARACTER = scope:demon
		#}
		#owner_seduce_outcome_sex_effect = yes
		#owner_seduce_outcome_just_sex_effects = yes
		had_sex_with_effect = {
			CHARACTER = scope:target
			PREGNANCY_CHANCE = seduce_pregnancy_chance
		}
		add_character_modifier = {
			modifier = joy_with_lilith_modifier
			years = 10
		}
		trigger_event = magic_ev.18
	}
	option = {
		name = ev43.0.b
		if = {
			limit = {
				has_character_modifier = lilith_blessing
			}
			add_diplomacy_skill = 4
		}
		else = {
			add_character_modifier = {
				modifier = lilith_blessing
				years = 10
			}
		}
		trigger_event = magic_ev.18
	}
	option = {
		name = ev43.0.c
		if = {
			limit = {
				has_character_modifier = mind_reader_modifier
			}
			add_intrigue_skill = 4
		}
		else = {
			add_character_modifier = {
				modifier = mind_reader_modifier
				years = 5
			}
		}
		trigger_event = magic_ev.18

	}
	option = {
		name = ev43.0.d
		trigger = {
			NOT = { has_trait = beauty_good_3 }
		}
		if = {
			limit = {
				has_trait = beauty_good_2
			}
			hidden_effect = {
				remove_trait = beauty_good_2
			}
			add_trait_force_tooltip = beauty_good_3
		}
		else_if = {
			limit = {
				has_trait = beauty_good_1
			}
			hidden_effect = {
				remove_trait = beauty_good_1
			}
			add_trait_force_tooltip = beauty_good_3
		}
		else = {
			add_trait_force_tooltip = beauty_good_2
		}
		trigger_event = magic_ev.18
	}
	option = {
		name = ev43.0.e
		trigger = {
			NOT = {
				has_character_modifier = long_life_modifier
			}
		}
		add_character_modifier = long_life_modifier
		trigger_event = magic_ev.18
	}
}

#Lilith on the board
magic_ev.45 = {
	hidden = yes
	#type = empty
	scope=none
	trigger = {
		scope:target = {
			is_alive = yes
		}
	}
	immediate = {
		scope:target = {
					set_immortal_age = 18
					if = { limit = { has_trait = disfigured }
						remove_trait = disfigured
					}
					if = { limit = { has_trait = inbred }
						remove_trait = inbred
					}
					if = { limit = { has_trait = impotent }
						remove_trait = impotent
					}
					if = { limit = { has_trait = bleeder }
						remove_trait = bleeder
					}
					if = { limit = { has_trait = wheezing }
						remove_trait = wheezing
					}
					if = { limit = { has_trait = infertile }
						remove_trait = infertile
					}
					if = { limit = { has_trait = one_legged }
						remove_trait = one_legged
					}
					if = { limit = { has_trait = one_eyed }
						remove_trait = one_eyed
					}
					if = { limit = { has_trait = lunatic_genetic }
						remove_trait = lunatic_genetic
					}
					if = { limit = { has_trait = lunatic_1 }
						remove_trait = lunatic_1
					}
					if = { limit = { has_trait = ill }
						remove_trait = ill
					}
					if = { limit = { has_trait = pneumonic }
						remove_trait = pneumonic
					}
					if = { limit = { has_trait = great_pox }
						remove_trait = great_pox
					}
					if = { limit = { has_trait = early_great_pox }
						remove_trait = early_great_pox
					}
					if = { limit = { has_trait = lovers_pox }
						remove_trait = lovers_pox
					}
					if = { limit = { has_trait = leper }
						remove_trait = leper
					}
					if = { limit = { has_trait = wounded_1 }
						remove_trait = wounded_1
					}
					if = { limit = { has_trait = wounded_2 }
						remove_trait = wounded_2
					}
					if = { limit = { has_trait = wounded_3 }
						remove_trait = wounded_3
					}
					if = { limit = { has_trait = maimed }
						remove_trait = maimed
					}
					if = { limit = { has_trait = infirm }
						remove_trait = infirm
					}
					if = { limit = { has_trait = incapable }
						remove_trait = incapable
					}
					if = { limit = { has_trait = gout_ridden }
						remove_trait = gout_ridden
					}
					if = { limit = { has_trait = consumption }
						remove_trait = consumption
					}
					if = { limit = { has_trait = cancer }
						remove_trait = cancer
					}
					if = { limit = { has_trait = typhus }
						remove_trait = typhus
					}
					if = { limit = { has_trait = bubonic_plague }
						remove_trait = bubonic_plague
					}
					if = { limit = { has_trait = smallpox }
						remove_trait = smallpox
					}
					if = { limit = { has_trait = sickly }
						remove_trait = sickly
					}
					if = { limit = { has_trait = blind }
						remove_trait = blind
					}
			if = {
				limit = {
					is_imprisoned = yes
				}
				scope:target = {
					death = natural
				}
				clear_saved_scope = owner
				clear_saved_scope = target
				clear_saved_scope = towner
				#scope:target.imprisoner = {
				#	save_scope_as = imprisoner
				#}
				#trigger_event = prison.9001
				#trigger_event = {
				#	id = magic_ev.45
				#	months = { 2 4 }
				#}
			}
			else_if = {
				limit = {
					OR = {
						AND = {
							any_relation ={
								is_landed = yes
								type = lover
								count = 0
							}
							any_relation ={
								is_landed = yes
								type = soulmate
								count = 0
							}
						}
						scope:owner = {
							is_alive = no
						}
						scope:owner = {
							is_landed = no
						}
						scope:owner = {
							AND = {
								is_alive = yes
								NOR = {
									has_relation_lover = scope:target
									has_relation_soulmate = scope:target
								}
							}
							
						}
					}
				}
				if = {
					limit = {
						scope:owner = {
							is_alive = yes
							is_imprisoned = no
							NOR = {
								has_relation_lover = scope:target
								has_relation_soulmate = scope:target
							}
						}
					}
					scope:target = {
						start_scheme = {
							type = murder
							target = scope:owner
						}
					}
				}
				clear_saved_scope = owner
				random_ruler = {
					limit = {
						is_attracted_to_women = yes
						is_imprisoned = no
						is_landed = yes
					}
					add_courtier = scope:target
					save_scope_as = owner
				}
				every_living_character = {
					limit = {
						has_character_modifier = joy_with_lilith_modifier
					}
					remove_character_modifier = joy_with_lilith_modifier
				}
				start_scheme = {
					type = seduce
					target = scope:owner
				}
				trigger_event = {
					id = magic_ev.45
					months = { 18 20 }
				}
			}
			else_if = {
				limit = {
					exists = scope:owner
				}
				scope:owner = {
					if = {
						limit = {
							NOR = {
								has_relation_lover = scope:target
								has_relation_soulmate = scope:target
							}
						}
						trigger_event = {
							id = magic_ev.45
							months = { 18 20 }
						}
					}
					else = {
						if = {
							limit = {
								is_imprisoned = yes
							}
							remove_relation_lover = scope:target
							if = {
								limit = { has_character_modifier = joy_with_lilith_modifier }
								remove_character_modifier = joy_with_lilith_modifier
							}
							
						}
						else = {
							if = {
								limit = {
									exists = scope:target
									scope:target = {
										NOT = {
											is_courtier_of = scope:owner
										}
									}
								}
								add_courtier = scope:target
							}
							
							if = {
								limit = { NOT = { has_character_modifier = joy_with_lilith_modifier } }
								add_character_modifier = joy_with_lilith_modifier
							}
							random_list = {
								15 = {
									trigger = {
										#is_ai = no
										NOT = { has_character_flag = feast4lilith }
										exists = involved_activity
										#involved_activity = {
										#	NOT = {	exists = THIS	}
										#}
									}
									#feast please!
									trigger_event = magic_ev.46
								}
								10 = {
									trigger = {
										OR = {
											any_relation ={
												is_ruler = yes
												NOT = { has_trait = demon }
												type = rival
											}
											any_relation ={
												is_ruler = yes
												NOT = { has_trait = demon }
												type = nemesis
											}
										}
									}
									#I will spy 4u
									trigger_event = magic_ev.48
								}
								5 = {
									trigger = {
										is_male = yes
										NOR = {
											is_consort_of = scope:target
											is_spouse_of = scope:target
										}
										any_spouse = {
											count > 0
										}
										scope:target = {
											is_married = no
										}
									}
									#I wanna be your queen
									trigger_event = magic_ev.54
								}
								#5 = {
								#	trigger = {
								#		OR = {
								#			is_consort_of = scope:target
								#			is_spouse_of = scope:target
								#		}
								#	}
								#	scope:target = {
								#		start_scheme = {
								#			type = murder
								#			target = scope:owner
								#		}
								#	}
								#	#Im bored so I'll kill you...
								#	trigger_event = {
								#		id = magic_ev.45
								#		months = { 18 28 }
								#	}
								#}
								8 = {
									#I'll kill my husband
									trigger = {
										scope:target = {
											is_married = yes
										}
									}
									scope:target = {
										start_scheme = {
											type = murder
											target = scope:target.primary_partner
										}
									}
									trigger_event = {
										id = magic_ev.45
										months = { 18 20 }
									}
								}
								5 = {
									#I'll seduce someone
									trigger = {
										scope:target = {
											any_scheme = {
												scheme_type = seduce
												count = 0
											}
										}
									}
									random_relation = {
										type = rival
										limit = {
											NOR = {
												has_relation_lover = scope:target
												has_relation_soulmate = scope:target
											}
											is_attracted_to_gender_of = scope:target
											#type = rival
											is_adult = yes
										}
										add_to_list = potential_targs
									}
									random_relation = {
										type = friend
										limit = {
											#type = friend
											NOR = {
												has_relation_lover = scope:target
												has_relation_soulmate = scope:target
											}
											is_attracted_to_gender_of = scope:target
											is_adult = yes
										}
										add_to_list = potential_targs
									}
									random_neighboring_realm_same_rank_owner = {
										limit = {
											NOR = {
												has_relation_lover = scope:target
												has_relation_soulmate = scope:target
											}
											is_attracted_to_gender_of = scope:target
											is_adult = yes
										}
										add_to_list = potential_targs
										
									}
									random_vassal = {
										limit = {
											NOR = {
												has_relation_lover = scope:target
												has_relation_soulmate = scope:target
											}
											is_powerful_vassal = yes
											is_attracted_to_gender_of = scope:target
											is_adult = yes
										}
										add_to_list = potential_targs
									}
									liege = {
										if = {
											limit = {
												NOT = { this = scope:owner }
												NOR = {
													has_relation_lover = scope:target
													has_relation_soulmate = scope:target
												}
												is_attracted_to_gender_of = scope:target
												is_adult = yes
											}
											add_to_list = potential_targs
										}
									}
									random_in_list = {
										list = potential_targs
										save_scope_as = potential_targ
									}
									scope:target = {
										start_scheme = {
											type = seduce
											target = scope:potential_targ
										}
									}
									trigger_event = {
										id = magic_ev.45
										months = { 18 22 }
									}
								}
								5 = {
									#I kill your councilor...
									trigger = {
										scope:owner = {
											any_councillor = {
												count > 3
											}
										}
									}
									trigger_event = magic_ev.55
								}
								5 = {
									#give me some money
									#trigger = {
									#	gold > 100
									#}
									trigger_event = magic_ev.56
								}
								1 = {
									#I do nothing except killing you
									scope:target = {
										if = {
											limit = {
												opinion = {
													target = scope:owner
													value < 0
												}
											}
											start_scheme = {
												type = murder
												target = scope:owner
											}
										}
									}
									trigger_event = {
										id = magic_ev.45
										months = { 24 28 }
									}
								}
							}
						}
					}
				}
			}
			else = {
				trigger_event = {
					id = magic_ev.45
					months = { 22 28 }
				}
			}	
		}
	}
}

#feast please! / Lilith
magic_ev.46 = {
	title = ev46.0.title
	desc = ev46.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:owner
	right_portrait = scope:target
	#immediate = {
	#	
	#}

	option = {
		name = ev46.0.a
		add_character_flag = {
			flag = feast4lilith
			years = 3
		}
		#hidden_effect = {
		#	remove_decision_cooldown = host_feast_decision
		#}
		#execute_decision = host_feast_decision
		
		trigger_event = {
			id = magic_ev.47
			months = { 3 4 }
		}
	}
	option = {
		name = ev46.0.b
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		scope:target = {
			add_opinion = {
				modifier = lover_let_me_down_opinion
				target = scope:owner
			}
			hidden_effect = {
				random = {
					chance = 50
					start_scheme = {
						type = murder
						target = scope:owner
					}
				}
			}
		}
		#add_stress = minor_stress_gain
		if = {
			limit = { has_character_modifier = joy_with_lilith_modifier }
			remove_character_modifier = joy_with_lilith_modifier
		}
	}
	option = {
		name = ev46.0.c
		trigger = {
			has_trait = lustful
		}
		trait = lustful
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		had_sex_with_effect = {
			CHARACTER = scope:target
			PREGNANCY_CHANCE = pregnancy_chance
		}
	}
	option = {
		name = ev46.0.c
		trigger = {
			NOT = { has_trait = lustful }
			has_trait = rakish
		}
		trait = rakish
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		had_sex_with_effect = {
			CHARACTER = scope:target
			PREGNANCY_CHANCE = pregnancy_chance
		}
	}
	
}

#break promises / Lilith
magic_ev.47 = {
	hidden = yes
	immediate = {
		if = {
			limit = {
				scope:owner.involved_activity = {
					#NOT = { in_activity_type = activity_feast }
					NOT = {	exists = THIS	}
				}
			}
			scope:target = {
				start_scheme = {
					type = murder
					target = scope:owner
				}
			}
			
			trigger_event = {
				id = magic_ev.45
				months = { 20 25 }
			}
		}
		else = {
			trigger_event = {
				id = magic_ev.45
				months = { 15 25 }
			}
		}
	}	
}

#Lilith as spy
magic_ev.48 = {
	title = ev48.0.title
	desc = ev48.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:owner
	right_portrait = {
		character = scope:target
		animation = scheme
	}
	lower_center_portrait = scope:riv
	immediate = {
		random_relation ={
			limit = { is_ruler = yes NOT = { has_trait = demon } }
			type = rival
			add_to_list = rivs
		}
		random_relation ={
			limit = { is_ruler = yes NOT = { has_trait = demon } }
			type = nemesis
			add_to_list = rivs
		}
		random_in_list = {
			list = rivs
			save_scope_as = riv
		}
	}

	option = {
		name = ev48.0.a
		save_scope_as = towner
		scope:riv = {
			hidden_effect = {
				add_courtier = scope:target
			}
			
			trigger_event = {
				id = magic_ev.49
				days = { 5 10 }
			}
		}
	}
	option = {
		name = ev48.0.b
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		add_opinion = {
			modifier = lover_let_me_down_opinion
			years = 2
			target = scope:target
		}
		hidden_effect = {
			random = {
				chance = 50
				scope:target = {
					start_scheme = {
						type = murder
						target = scope:owner
					}
				}
			}
		}
		#add_stress = minor_stress_gain
		if = {
			limit = { has_character_modifier = joy_with_lilith_modifier }
			remove_character_modifier = joy_with_lilith_modifier
		}
	}
	option = {
		name = ev48.0.c
		trigger = {
			has_trait = lustful
		}
		trait = lustful
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		had_sex_with_effect = {
			CHARACTER = scope:target
			PREGNANCY_CHANCE = pregnancy_chance
		}
	}
	option = {
		name = ev48.0.c
		trigger = {
			NOT = { has_trait = lustful }
			has_trait = rakish
		}
		trait = rakish
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		had_sex_with_effect = {
			CHARACTER = scope:target
			PREGNANCY_CHANCE = pregnancy_chance
		}
	}
	
}


#Lilith as spy perform
magic_ev.49 = {
	title = ev49.0.title
	desc = ev49.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:riv
	right_portrait = {
		character = scope:target
		animation = flirtation
	}

	immediate = {
		clear_saved_scope = owner
		save_scope_as = owner
		
	}

	option = {
		name = ev49.0.a
		if = {
			limit = {
				OR = {
					AND = {
						is_male = no
						has_sexuality = heterosexual
					}
					AND = {
						is_male = yes
						has_sexuality = homosexual
					}
				}
			}
			set_sexuality = bisexual
		}
		
		random_list = {
			20 = {
				had_sex_with_effect = {
					CHARACTER = scope:target
					PREGNANCY_CHANCE = seduce_pregnancy_chance
				}
				hidden_effect = {
					scope:towner = {
						add_courtier = scope:target
						trigger_event = magic_ev.52
					}
				}
				
				
			}
			5 = {
				modifier = {
					add = 5
					OR = {
						has_trait = beauty_good_3
						has_trait = beauty_good_2
						has_trait = beauty_good_1
					}
				}
				modifier = {
					add = 5
					has_trait = lustful
				}
				modifier = {
					add = 5
					has_trait = fickle
				}
				modifier = {
					add = 5
					has_trait = seducer
				}
				modifier = {
					add = 5
					has_trait = archmage
				}
				modifier = {
					add = 5
					has_trait = true_witch
				}
				modifier = {
					add = 50
					has_trait = demon
				}
				
				had_sex_with_effect = {
					CHARACTER = scope:target
					PREGNANCY_CHANCE = seduce_pregnancy_chance
				}
				set_relation_lover = scope:target
				#set_random_lover_reason = { TARGET = scope:target }
				add_character_modifier = joy_with_lilith_modifier
				hidden_effect = {
					scope:towner = {
						trigger_event = magic_ev.53
					}
				}
			}
		}
		ai_chance = {
			base = 10
			modifier = {
				add = 10
				has_trait = lustful
			}
			modifier = {
				add = 10
				has_trait = rakish
			}
			modifier = {
				add = 10
				has_trait = seducer
			}
			modifier = {
				add = 10
				has_focus = intrigue_temptation_focus
			}
		}
	}
	option = {
		name = ev49.0.b
		trigger_event = magic_ev.50
		add_stress = minor_stress_gain
		ai_chance = {
			base = 10
			modifier = {
				add = 30
				has_trait = chaste
			}
			modifier = {
				add = 10
				any_relation = {
					type = lover
				}
			}
			modifier = {
				add = 10
				any_relation = {
					type = soulmate
				}
			}
		}
	}
}


#Lilith make mess
magic_ev.50 = {
	title = ev49.0.title
	desc = ev50.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:riv
	right_portrait = {
		character = scope:target
		animation = anger
	}

	immediate = {
		death = {
			death_reason = death_murder
			killer = scope:target
		}
	}

	option = {
		name = ev50.0.a
		hidden_effect = {
			scope:target = {
				add_secret = {
					type = secret_murder
					target = scope:target
				}
			}
			scope:towner = {
				add_courtier = scope:target
				trigger_event = magic_ev.51
			}
		}

	}
}




#Lilith explanation
magic_ev.51 = {
	title = ev51.0.title
	desc = ev51.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:towner
	right_portrait = {
		character = scope:target
		animation = shame
	}

	immediate = {
		clear_saved_scope = owner
		save_scope_as = owner
		clear_saved_scope = towner
		show_as_tooltip = {
			scope:riv = {
				death = {
					death_reason = death_murder
					killer = scope:target
				}
			}
		}
	}

	option = {
		name = ev51.0.a
		add_stress = minor_stress_loss
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
	}
}

#Lilith explanation success
magic_ev.52 = {
	title = ev51.0.title
	desc = ev52.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:towner
	right_portrait = {
		character = scope:target
		animation = love
	}

	#immediate = {
	#	
	#	
	#}

	option = {
		name = ev51.0.a
		scope:owner = {
			if = {
				limit = {
					any_secret = {
						count > 0
					}
				}
				every_secret = {
					reveal_to = root
					reveal_to = scope:target
				}
			}
			else_if = {
				limit = {
					any_scheme = {
						hostile_scheme_trigger = yes
						count > 0
					}
				}
				every_scheme = {
					expose_scheme = yes
				}
			}
			else = {
				root = {
					add_hook = {
						type = minor_crime_accomplice_hook
						target = scope:owner
					}
				}
			}
		}
		clear_saved_scope = owner
		save_scope_as = owner
		clear_saved_scope = towner
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
	}
	#after = {
	#	
	#}
}


#Lilith break up
magic_ev.53 = {
	title = ev51.0.title
	desc = ev53.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:towner
	right_portrait = scope:target

	immediate = {
		if = {
			limit = {
				has_relation_lover = scope:target
			}
			remove_relation_lover = scope:target
		}
		if = {
			limit = {
				has_relation_soulmate = scope:target
			}
			remove_relation_soulmate = scope:target
		}
		add_stress = minor_stress_gain
		if = {
			limit = { has_character_modifier = joy_with_lilith_modifier }
			remove_character_modifier = joy_with_lilith_modifier
		}
		if = {
			limit = {
				OR = {
				is_consort_of = scope:target
				is_spouse_of = scope:target
				}
			}
			divorce = scope:target
		}
		
	}

	option = {
		name = ev53.0.a
		clear_saved_scope = towner
		#scope:target = {
		#	set_relation_lover = scope:owner
		#}
		scope:owner = {
			
			show_as_tooltip = {
				set_relation_lover = scope:target
				#set_random_lover_reason = { TARGET = scope:target }
			}
			trigger_event = {
				id = magic_ev.45
				months = { 15 20 }
			}
		}
		scope:target = {
			every_secret = {
				limit = {
					secret_type = secret_lover
					secret_target = scope:owner
				}
				reveal_to = root
			}
		}
	}
	#after = {
	#	
	#}
}

#Lilith want to be a queen
magic_ev.54 = {
	title = ev54.0.title
	desc = ev54.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:owner
	right_portrait = scope:target


	option = {
		name = ev54.0.a
		root.primary_spouse = {
			death = {
				death_reason = death_murder
				killer = scope:target
			}
			
		}
		hidden_effect = {
			scope:target = {
				add_secret = {
					type = secret_murder
					target = root.primary_spouse
				}
			}
		}
		#show_as_tooltip = {
		#	set_primary_spouse = scope:target
		#}
		#trigger_event = magic_ev.55
		marry = scope:target
		trigger_event = {
			id = magic_ev.45
			months = { 22 25 }
		}
	}
	option = {
		name = ev54.0.b
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		scope:target = {
			add_opinion = {
				modifier = lover_let_me_down_opinion
				target = scope:owner
			}
			hidden_effect = {
				random = {
					chance = 50
					start_scheme = {
						type = murder
						target = scope:owner
					}
				}
			}
		}
		
		#add_stress = minor_stress_gain
		if = {
			limit = { has_character_modifier = joy_with_lilith_modifier }
			remove_character_modifier = joy_with_lilith_modifier
		}
	}
	option = {
		name = ev54.0.c
		trigger = {
			has_trait = lustful
		}
		trait = lustful
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		had_sex_with_effect = {
			CHARACTER = scope:target
			PREGNANCY_CHANCE = pregnancy_chance
		}
	}
	option = {
		name = ev54.0.c
		trigger = {
			NOT = { has_trait = lustful }
			has_trait = rakish
		}
		trait = rakish
		trigger_event = {
			id = magic_ev.45
			months = { 15 20 }
		}
		had_sex_with_effect = {
			CHARACTER = scope:target
			PREGNANCY_CHANCE = pregnancy_chance
		}
	}

}

#Lilith kills councilor
magic_ev.55 = {
	title = ev55.0.title
	desc = ev55.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:owner
	right_portrait = scope:target
	lower_right_portrait = scope:victim0

	trigger = {
		any_councillor = {
			count > 2
		}
	}
	immediate = {
		random_councillor = {
			limit = {
				NOT = { this = scope:target }
				NOT = { this = scope:owner.primary_spouse }
				is_ai = yes
			}
			save_scope_as = victim0
			death = {
				death_reason = death_murder
				killer = scope:target
			}
		}
		scope:target = {
			add_secret = {
				type = secret_murder
				target = scope:victim0
			}
			every_secret = {
				limit = {
					secret_type = secret_murder
					secret_target = scope:victim0
				}
				reveal_to = scope:owner
			}
		}
		
	}

	option = {
		name = ev55.0.a
		trigger = {
			NOT = { has_trait = sadistic }
		}
		add_stress = minor_stress_gain
		trigger_event = {
			id = magic_ev.45
			months = { 15 25 }
		}
	}
	option = {
		name = ev55.0.a
		trigger = {
			has_trait = sadistic
		}
		trait = sadistic
		trigger_event = {
			id = magic_ev.45
			months = { 15 25 }
		}
	}
	option = {
		name = ev55.0.b
		scope:target = {
			add_opinion = {
				modifier = lover_let_me_down_opinion
				target = scope:owner
			}
			hidden_effect = {
				random = {
					chance = 50
					start_scheme = {
						type = murder
						target = scope:owner
					}
				}
			}
		}
		if = {
			limit = { has_character_modifier = joy_with_lilith_modifier }
			remove_character_modifier = joy_with_lilith_modifier
		}
		trigger_event = {
			id = magic_ev.45
			months = { 15 25 }
		}
	}
}

#Lilith needs money
magic_ev.56 = {
	title = ev46.0.title
	desc = ev56.0.desc
	theme =  mental_health
	override_background = { reference = bedchamber }
	left_portrait = scope:owner
	right_portrait = scope:target

	#immediate = {
	#	
	#}

	option = {
		name = ev56.0.a
		pay_short_term_gold = {
			target = scope:target
			gold = 200
		}
		trigger_event = {
			id = magic_ev.45
			months = { 15 30 }
		}
	}
	option = {
		name = ev56.0.b
		scope:target = {
			add_opinion = {
				modifier = lover_let_me_down_opinion
				target = scope:owner
			}
			hidden_effect = {
				random = {
					chance = 50
					start_scheme = {
						type = murder
						target = scope:owner
					}
				}
			}
		}
		if = {
			limit = { has_character_modifier = joy_with_lilith_modifier }
			remove_character_modifier = joy_with_lilith_modifier
		}
		trigger_event = {
			id = magic_ev.45
			months = { 15 30 }
		}
	}
}

magic_ev.57 = {
	hidden = yes
	#type = empty
	scope=none
	immediate = {
		create_true_witch_effect = yes
	}
}

magic_ev.89 = {
	hidden = yes
	#type = empty
	scope=none
	immediate = {
		#create_true_witch_effect = yes
	}
}

#test event
#magic_ev.90 = {
#	hidden = yes
#	#type = empty
#	scope = none
#
#	immediate = {
#		#debug_log=dddebug
#		random_ruler = {
#				limit = {
#					is_ai = no
#				}
#			trigger_event = magic_ev.1
#		}
#	}
#}