clear_personality_effect = {
	if = { limit = { has_trait = education_intrigue_1 } remove_trait = education_intrigue_1 }
	if = { limit = { has_trait = education_intrigue_2 } remove_trait = education_intrigue_2 }
	if = { limit = { has_trait = education_intrigue_3 } remove_trait = education_intrigue_3 }
	if = { limit = { has_trait = education_intrigue_4 } remove_trait = education_intrigue_4 }
	if = { limit = { has_trait = education_intrigue_5 } remove_trait = education_intrigue_5 }
	if = { limit = { has_trait = education_diplomacy_1 } remove_trait = education_diplomacy_1 }
	if = { limit = { has_trait = education_diplomacy_2 } remove_trait = education_diplomacy_2 }
	if = { limit = { has_trait = education_diplomacy_3 } remove_trait = education_diplomacy_3 }
	if = { limit = { has_trait = education_diplomacy_4 } remove_trait = education_diplomacy_4 }
	if = { limit = { has_trait = education_diplomacy_5 } remove_trait = education_diplomacy_5 }
	if = { limit = { has_trait = education_stewardship_1 } remove_trait = education_stewardship_1 }
	if = { limit = { has_trait = education_stewardship_2 } remove_trait = education_stewardship_2 }
	if = { limit = { has_trait = education_stewardship_3 } remove_trait = education_stewardship_3 }
	if = { limit = { has_trait = education_stewardship_4 } remove_trait = education_stewardship_4 }
	if = { limit = { has_trait = education_stewardship_5 } remove_trait = education_stewardship_5 }
	if = { limit = { has_trait = education_martial_1 } remove_trait = education_martial_1 }
	if = { limit = { has_trait = education_martial_2 } remove_trait = education_martial_2 }
	if = { limit = { has_trait = education_martial_3 } remove_trait = education_martial_3 }
	if = { limit = { has_trait = education_martial_4 } remove_trait = education_martial_4 }
	if = { limit = { has_trait = education_martial_5 } remove_trait = education_martial_5 }
	if = { limit = { has_trait = education_learning_1 } remove_trait = education_learning_1 }
	if = { limit = { has_trait = education_learning_2 } remove_trait = education_learning_2 }
	if = { limit = { has_trait = education_learning_3 } remove_trait = education_learning_3 }
	if = { limit = { has_trait = education_learning_4 } remove_trait = education_learning_4 }
	if = { limit = { has_trait = education_learning_5 } remove_trait = education_learning_5 }
	if = { limit = { has_trait = diplomat } remove_trait = diplomat }
	if = { limit = { has_trait = family_first } remove_trait = family_first }
	if = { limit = { has_trait = august } remove_trait = august }
	if = { limit = { has_trait = lifestyle_reveler } remove_trait = lifestyle_reveler }
	if = { limit = { has_trait = lifestyle_blademaster } remove_trait = lifestyle_blademaster }
	if = { limit = { has_trait = lifestyle_hunter } remove_trait = lifestyle_hunter }
	if = { limit = { has_trait = strategist } remove_trait = strategist }
	if = { limit = { has_trait = overseer } remove_trait = overseer }
	if = { limit = { has_trait = gallant } remove_trait = gallant }
	if = { limit = { has_trait = architect } remove_trait = architect }
	if = { limit = { has_trait = administrator } remove_trait = administrator }
	if = { limit = { has_trait = avaricious } remove_trait = avaricious }
	if = { limit = { has_trait = schemer } remove_trait = schemer }
	if = { limit = { has_trait = seducer } remove_trait = seducer }
	if = { limit = { has_trait = torturer } remove_trait = torturer }
	if = { limit = { has_trait = whole_of_body } remove_trait = whole_of_body }
	if = { limit = { has_trait = scholar } remove_trait = scholar }
	if = { limit = { has_trait = theologian } remove_trait = theologian }
	if = { limit = { has_trait = lifestyle_mystic } remove_trait = lifestyle_mystic }
	if = { limit = { has_trait = lifestyle_physician } remove_trait = lifestyle_physician }
	if = { limit = { has_trait = lifestyle_herbalist } remove_trait = lifestyle_herbalist }
	if = { limit = { has_trait = lifestyle_gardener } remove_trait = lifestyle_gardener }
	if = { limit = { has_trait = lustful } remove_trait = lustful }
	if = { limit = { has_trait = chaste } remove_trait = chaste }
	if = { limit = { has_trait = gluttonous } remove_trait = gluttonous }
	if = { limit = { has_trait = temperate } remove_trait = temperate }
	if = { limit = { has_trait = greedy } remove_trait = greedy }
	if = { limit = { has_trait = generous } remove_trait = generous }
	if = { limit = { has_trait = lazy } remove_trait = lazy }
	if = { limit = { has_trait = diligent } remove_trait = diligent }
	if = { limit = { has_trait = wrathful } remove_trait = wrathful }
	if = { limit = { has_trait = calm } remove_trait = calm }
	if = { limit = { has_trait = patient } remove_trait = patient }
	if = { limit = { has_trait = impatient } remove_trait = impatient }
	if = { limit = { has_trait = arrogant } remove_trait = arrogant }
	if = { limit = { has_trait = humble } remove_trait = humble }
	if = { limit = { has_trait = deceitful } remove_trait = deceitful }
	if = { limit = { has_trait = honest } remove_trait = honest }
	if = { limit = { has_trait = craven } remove_trait = craven }
	if = { limit = { has_trait = brave } remove_trait = brave }
	if = { limit = { has_trait = shy } remove_trait = shy }
	if = { limit = { has_trait = gregarious } remove_trait = gregarious }
	if = { limit = { has_trait = ambitious } remove_trait = ambitious }
	if = { limit = { has_trait = content } remove_trait = content }
	if = { limit = { has_trait = arbitrary } remove_trait = arbitrary }
	if = { limit = { has_trait = just } remove_trait = just }
	if = { limit = { has_trait = cynical } remove_trait = cynical }
	if = { limit = { has_trait = zealous } remove_trait = zealous }
	if = { limit = { has_trait = paranoid } remove_trait = paranoid }
	if = { limit = { has_trait = trusting } remove_trait = trusting }
	if = { limit = { has_trait = compassionate } remove_trait = compassionate }
	if = { limit = { has_trait = callous } remove_trait = callous }
	if = { limit = { has_trait = sadistic } remove_trait = sadistic }
	if = { limit = { has_trait = stubborn } remove_trait = stubborn }
	if = { limit = { has_trait = fickle } remove_trait = fickle }
	if = { limit = { has_trait = eccentric } remove_trait = eccentric }
	if = { limit = { has_trait = vengeful } remove_trait = vengeful }
	if = { limit = { has_trait = forgiving } remove_trait = forgiving }
}
transfer_personality_to_recipient_effect = {
	if = { limit = { has_trait = education_intrigue_1 } scope:recipient = { add_trait = education_intrigue_1 } }
	if = { limit = { has_trait = education_intrigue_2 } scope:recipient = { add_trait = education_intrigue_2 } }
	if = { limit = { has_trait = education_intrigue_3 } scope:recipient = { add_trait = education_intrigue_3 } }
	if = { limit = { has_trait = education_intrigue_4 } scope:recipient = { add_trait = education_intrigue_4 } }
	if = { limit = { has_trait = education_intrigue_5 } scope:recipient = { add_trait = education_intrigue_5 } }
	if = { limit = { has_trait = education_diplomacy_1 } scope:recipient = { add_trait = education_diplomacy_1 } }
	if = { limit = { has_trait = education_diplomacy_2 } scope:recipient = { add_trait = education_diplomacy_2 } }
	if = { limit = { has_trait = education_diplomacy_3 } scope:recipient = { add_trait = education_diplomacy_3 } }
	if = { limit = { has_trait = education_diplomacy_4 } scope:recipient = { add_trait = education_diplomacy_4 } }
	if = { limit = { has_trait = education_diplomacy_5 } scope:recipient = { add_trait = education_diplomacy_5 } }
	if = { limit = { has_trait = education_stewardship_1 } scope:recipient = { add_trait = education_stewardship_1 } }
	if = { limit = { has_trait = education_stewardship_2 } scope:recipient = { add_trait = education_stewardship_2 } }
	if = { limit = { has_trait = education_stewardship_3 } scope:recipient = { add_trait = education_stewardship_3 } }
	if = { limit = { has_trait = education_stewardship_4 } scope:recipient = { add_trait = education_stewardship_4 } }
	if = { limit = { has_trait = education_stewardship_5 } scope:recipient = { add_trait = education_stewardship_5 } }
	if = { limit = { has_trait = education_martial_1 } scope:recipient = { add_trait = education_martial_1 } }
	if = { limit = { has_trait = education_martial_2 } scope:recipient = { add_trait = education_martial_2 } }
	if = { limit = { has_trait = education_martial_3 } scope:recipient = { add_trait = education_martial_3 } }
	if = { limit = { has_trait = education_martial_4 } scope:recipient = { add_trait = education_martial_4 } }
	if = { limit = { has_trait = education_martial_5 } scope:recipient = { add_trait = education_martial_5 } }
	if = { limit = { has_trait = education_learning_1 } scope:recipient = { add_trait = education_learning_1 } }
	if = { limit = { has_trait = education_learning_2 } scope:recipient = { add_trait = education_learning_2 } }
	if = { limit = { has_trait = education_learning_3 } scope:recipient = { add_trait = education_learning_3 } }
	if = { limit = { has_trait = education_learning_4 } scope:recipient = { add_trait = education_learning_4 } }
	if = { limit = { has_trait = education_learning_5 } scope:recipient = { add_trait = education_learning_5 } }
	if = { limit = { has_trait = diplomat } scope:recipient = { add_trait = diplomat } }
	if = { limit = { has_trait = family_first } scope:recipient = { add_trait = family_first } }
	if = { limit = { has_trait = august } scope:recipient = { add_trait = august } }
	if = { limit = { has_trait = lifestyle_reveler } scope:recipient = { add_trait = lifestyle_reveler } }
	if = { limit = { has_trait = lifestyle_blademaster } scope:recipient = { add_trait = lifestyle_blademaster } }
	if = { limit = { has_trait = lifestyle_hunter } scope:recipient = { add_trait = lifestyle_hunter } }
	if = { limit = { has_trait = strategist } scope:recipient = { add_trait = strategist } }
	if = { limit = { has_trait = overseer } scope:recipient = { add_trait = overseer } }
	if = { limit = { has_trait = gallant } scope:recipient = { add_trait = gallant } }
	if = { limit = { has_trait = architect } scope:recipient = { add_trait = architect } }
	if = { limit = { has_trait = administrator } scope:recipient = { add_trait = administrator } }
	if = { limit = { has_trait = avaricious } scope:recipient = { add_trait = avaricious } }
	if = { limit = { has_trait = schemer } scope:recipient = { add_trait = schemer } }
	if = { limit = { has_trait = seducer } scope:recipient = { add_trait = seducer } }
	if = { limit = { has_trait = torturer } scope:recipient = { add_trait = torturer } }
	if = { limit = { has_trait = whole_of_body } scope:recipient = { add_trait = whole_of_body } }
	if = { limit = { has_trait = scholar } scope:recipient = { add_trait = scholar } }
	if = { limit = { has_trait = theologian } scope:recipient = { add_trait = theologian } }
	if = { limit = { has_trait = lifestyle_mystic } scope:recipient = { add_trait = lifestyle_mystic } }
	if = { limit = { has_trait = lifestyle_physician } scope:recipient = { add_trait = lifestyle_physician } }
	if = { limit = { has_trait = lifestyle_herbalist } scope:recipient = { add_trait = lifestyle_herbalist } }
	if = { limit = { has_trait = lifestyle_gardener } scope:recipient = { add_trait = lifestyle_gardener } }
	if = { limit = { has_trait = lustful } scope:recipient = { add_trait = lustful } }
	if = { limit = { has_trait = chaste } scope:recipient = { add_trait = chaste } }
	if = { limit = { has_trait = gluttonous } scope:recipient = { add_trait = gluttonous } }
	if = { limit = { has_trait = temperate } scope:recipient = { add_trait = temperate } }
	if = { limit = { has_trait = greedy } scope:recipient = { add_trait = greedy } }
	if = { limit = { has_trait = generous } scope:recipient = { add_trait = generous } }
	if = { limit = { has_trait = lazy } scope:recipient = { add_trait = lazy } }
	if = { limit = { has_trait = diligent } scope:recipient = { add_trait = diligent } }
	if = { limit = { has_trait = wrathful } scope:recipient = { add_trait = wrathful } }
	if = { limit = { has_trait = calm } scope:recipient = { add_trait = calm } }
	if = { limit = { has_trait = patient } scope:recipient = { add_trait = patient } }
	if = { limit = { has_trait = impatient } scope:recipient = { add_trait = impatient } }
	if = { limit = { has_trait = arrogant } scope:recipient = { add_trait = arrogant } }
	if = { limit = { has_trait = humble } scope:recipient = { add_trait = humble } }
	if = { limit = { has_trait = deceitful } scope:recipient = { add_trait = deceitful } }
	if = { limit = { has_trait = honest } scope:recipient = { add_trait = honest } }
	if = { limit = { has_trait = craven } scope:recipient = { add_trait = craven } }
	if = { limit = { has_trait = brave } scope:recipient = { add_trait = brave } }
	if = { limit = { has_trait = shy } scope:recipient = { add_trait = shy } }
	if = { limit = { has_trait = gregarious } scope:recipient = { add_trait = gregarious } }
	if = { limit = { has_trait = ambitious } scope:recipient = { add_trait = ambitious } }
	if = { limit = { has_trait = content } scope:recipient = { add_trait = content } }
	if = { limit = { has_trait = arbitrary } scope:recipient = { add_trait = arbitrary } }
	if = { limit = { has_trait = just } scope:recipient = { add_trait = just } }
	if = { limit = { has_trait = cynical } scope:recipient = { add_trait = cynical } }
	if = { limit = { has_trait = zealous } scope:recipient = { add_trait = zealous } }
	if = { limit = { has_trait = paranoid } scope:recipient = { add_trait = paranoid } }
	if = { limit = { has_trait = trusting } scope:recipient = { add_trait = trusting } }
	if = { limit = { has_trait = compassionate } scope:recipient = { add_trait = compassionate } }
	if = { limit = { has_trait = callous } scope:recipient = { add_trait = callous } }
	if = { limit = { has_trait = sadistic } scope:recipient = { add_trait = sadistic } }
	if = { limit = { has_trait = stubborn } scope:recipient = { add_trait = stubborn } }
	if = { limit = { has_trait = fickle } scope:recipient = { add_trait = fickle } }
	if = { limit = { has_trait = eccentric } scope:recipient = { add_trait = eccentric } }
	if = { limit = { has_trait = vengeful } scope:recipient = { add_trait = vengeful } }
	if = { limit = { has_trait = forgiving } scope:recipient = { add_trait = forgiving } }
}
clear_perks_effect = {
	if = { limit = { has_perk = thoughtful_perk } remove_perk = thoughtful_perk }
	if = { limit = { has_perk = ducal_conquest_perk } remove_perk = ducal_conquest_perk }
	if = { limit = { has_perk = forced_vassalage_perk } remove_perk = forced_vassalage_perk }
	if = { limit = { has_perk = adaptive_traditions_perk } remove_perk = adaptive_traditions_perk }
	if = { limit = { has_perk = flexible_truces_perk } remove_perk = flexible_truces_perk }
	if = { limit = { has_perk = defensive_negotiations_perk } remove_perk = defensive_negotiations_perk }
	if = { limit = { has_perk = embassies_perk } remove_perk = embassies_perk }
	if = { limit = { has_perk = accomplished_forger_perk } remove_perk = accomplished_forger_perk }
	if = { limit = { has_perk = diplomat_perk } remove_perk = diplomat_perk }
	if = { limit = { has_perk = benevolent_intent_perk } remove_perk = benevolent_intent_perk }
	if = { limit = { has_perk = inspiring_rule_perk } remove_perk = inspiring_rule_perk }
	if = { limit = { has_perk = firm_hand_perk } remove_perk = firm_hand_perk }
	if = { limit = { has_perk = praetorian_guard_perk } remove_perk = praetorian_guard_perk }
	if = { limit = { has_perk = true_ruler_perk } remove_perk = true_ruler_perk }
	if = { limit = { has_perk = writing_history_perk } remove_perk = writing_history_perk }
	if = { limit = { has_perk = a_life_of_glory_perk } remove_perk = a_life_of_glory_perk }
	if = { limit = { has_perk = dignitas_perk } remove_perk = dignitas_perk }
	if = { limit = { has_perk = august_perk } remove_perk = august_perk }
	if = { limit = { has_perk = befriend_perk } remove_perk = befriend_perk }
	if = { limit = { has_perk = confidants_perk } remove_perk = confidants_perk }
	if = { limit = { has_perk = flatterer_perk } remove_perk = flatterer_perk }
	if = { limit = { has_perk = groomed_to_rule_perk } remove_perk = groomed_to_rule_perk }
	if = { limit = { has_perk = familial_familiar_perk } remove_perk = familial_familiar_perk }
	if = { limit = { has_perk = thicker_than_water_perk } remove_perk = thicker_than_water_perk }
	if = { limit = { has_perk = friendly_counsel_perk } remove_perk = friendly_counsel_perk }
	if = { limit = { has_perk = sound_foundations_perk } remove_perk = sound_foundations_perk }
	if = { limit = { has_perk = family_man_perk } remove_perk = family_man_perk }
	if = { limit = { has_perk = truth_is_relative_perk } remove_perk = truth_is_relative_perk }
	if = { limit = { has_perk = digging_for_dirt_perk } remove_perk = digging_for_dirt_perk }
	if = { limit = { has_perk = kidnapper_perk } remove_perk = kidnapper_perk }
	if = { limit = { has_perk = court_of_shadows_perk } remove_perk = court_of_shadows_perk }
	if = { limit = { has_perk = prepared_for_anything_perk } remove_perk = prepared_for_anything_perk }
	if = { limit = { has_perk = swift_execution_perk } remove_perk = swift_execution_perk }
	if = { limit = { has_perk = a_job_done_right_perk } remove_perk = a_job_done_right_perk }
	if = { limit = { has_perk = twice_schemed_perk } remove_perk = twice_schemed_perk }
	if = { limit = { has_perk = schemer_perk } remove_perk = schemer_perk }
	if = { limit = { has_perk = like_weed_in_a_garden_perk } remove_perk = like_weed_in_a_garden_perk }
	if = { limit = { has_perk = unshackled_lust_perk } remove_perk = unshackled_lust_perk }
	if = { limit = { has_perk = subtle_desire_perk } remove_perk = subtle_desire_perk }
	if = { limit = { has_perk = mortal_adoration_perk } remove_perk = mortal_adoration_perk }
	if = { limit = { has_perk = enticing_opportunity_perk } remove_perk = enticing_opportunity_perk }
	if = { limit = { has_perk = home_advantage_perk } remove_perk = home_advantage_perk }
	if = { limit = { has_perk = graceful_recovery_perk } remove_perk = graceful_recovery_perk }
	if = { limit = { has_perk = smooth_operator_perk } remove_perk = smooth_operator_perk }
	if = { limit = { has_perk = seducer_perk } remove_perk = seducer_perk }
	if = { limit = { has_perk = dark_insights_perk } remove_perk = dark_insights_perk }
	if = { limit = { has_perk = divine_retribution_perk } remove_perk = divine_retribution_perk }
	if = { limit = { has_perk = dreadful_perk } remove_perk = dreadful_perk }
	if = { limit = { has_perk = thriving_in_chaos_perk } remove_perk = thriving_in_chaos_perk }
	if = { limit = { has_perk = malice_implicit_perk } remove_perk = malice_implicit_perk }
	if = { limit = { has_perk = fear_tax_perk } remove_perk = fear_tax_perk }
	if = { limit = { has_perk = forever_infamous_perk } remove_perk = forever_infamous_perk }
	if = { limit = { has_perk = prison_feudal_complex_perk } remove_perk = prison_feudal_complex_perk }
	if = { limit = { has_perk = torturer_perk } remove_perk = torturer_perk }
	if = { limit = { has_perk = anatomical_studies_perk } remove_perk = anatomical_studies_perk }
	if = { limit = { has_perk = carefree_perk } remove_perk = carefree_perk }
	if = { limit = { has_perk = mental_resilience_perk } remove_perk = mental_resilience_perk }
	if = { limit = { has_perk = restraint_perk } remove_perk = restraint_perk }
	if = { limit = { has_perk = know_thyself_perk } remove_perk = know_thyself_perk }
	if = { limit = { has_perk = wash_your_hands_perk } remove_perk = wash_your_hands_perk }
	if = { limit = { has_perk = iron_constitution_perk } remove_perk = iron_constitution_perk }
	if = { limit = { has_perk = healthy_perk } remove_perk = healthy_perk }
	if = { limit = { has_perk = whole_of_body_perk } remove_perk = whole_of_body_perk }
	if = { limit = { has_perk = pedagogy_perk } remove_perk = pedagogy_perk }
	if = { limit = { has_perk = open_minded_perk } remove_perk = open_minded_perk }
	if = { limit = { has_perk = apostate_perk } remove_perk = apostate_perk }
	if = { limit = { has_perk = scientific_perk } remove_perk = scientific_perk }
	if = { limit = { has_perk = planned_cultivation_perk } remove_perk = planned_cultivation_perk }
	if = { limit = { has_perk = scholarly_circles_perk } remove_perk = scholarly_circles_perk }
	if = { limit = { has_perk = learn_on_the_job_perk } remove_perk = learn_on_the_job_perk }
	if = { limit = { has_perk = sanctioned_loopholes_perk } remove_perk = sanctioned_loopholes_perk }
	if = { limit = { has_perk = scholar_perk } remove_perk = scholar_perk }
	if = { limit = { has_perk = faithful_perk } remove_perk = faithful_perk }
	if = { limit = { has_perk = zealous_proselytizer_perk } remove_perk = zealous_proselytizer_perk }
	if = { limit = { has_perk = religious_icon_perk } remove_perk = religious_icon_perk }
	if = { limit = { has_perk = prophet_perk } remove_perk = prophet_perk }
	if = { limit = { has_perk = clerical_justifications_perk } remove_perk = clerical_justifications_perk }
	if = { limit = { has_perk = church_and_state_perk } remove_perk = church_and_state_perk }
	if = { limit = { has_perk = radiant_perk } remove_perk = radiant_perk }
	if = { limit = { has_perk = defender_of_the_faith_perk } remove_perk = defender_of_the_faith_perk }
	if = { limit = { has_perk = theologian_perk } remove_perk = theologian_perk }
	if = { limit = { has_perk = bellum_justum_perk } remove_perk = bellum_justum_perk }
	if = { limit = { has_perk = parthian_tactics_perk } remove_perk = parthian_tactics_perk }
	if = { limit = { has_perk = envelopment_perk } remove_perk = envelopment_perk }
	if = { limit = { has_perk = organized_retreat_perk } remove_perk = organized_retreat_perk }
	if = { limit = { has_perk = hit_and_run_perk } remove_perk = hit_and_run_perk }
	if = { limit = { has_perk = engineered_for_destruction_perk } remove_perk = engineered_for_destruction_perk }
	if = { limit = { has_perk = living_off_the_land_perk } remove_perk = living_off_the_land_perk }
	if = { limit = { has_perk = sappers_perk } remove_perk = sappers_perk }
	if = { limit = { has_perk = strategist_perk } remove_perk = strategist_perk }
	if = { limit = { has_perk = serve_the_crown_perk } remove_perk = serve_the_crown_perk }
	if = { limit = { has_perk = a_mans_home_perk } remove_perk = a_mans_home_perk }
	if = { limit = { has_perk = enduring_hardships_perk } remove_perk = enduring_hardships_perk }
	if = { limit = { has_perk = prepared_conscription_perk } remove_perk = prepared_conscription_perk }
	if = { limit = { has_perk = strict_organization_perk } remove_perk = strict_organization_perk }
	if = { limit = { has_perk = hard_rule_perk } remove_perk = hard_rule_perk }
	if = { limit = { has_perk = soldiers_of_lesser_fortune_perk } remove_perk = soldiers_of_lesser_fortune_perk }
	if = { limit = { has_perk = absolute_control_perk } remove_perk = absolute_control_perk }
	if = { limit = { has_perk = overseer_perk } remove_perk = overseer_perk }
	if = { limit = { has_perk = stalwart_leader_perk } remove_perk = stalwart_leader_perk }
	if = { limit = { has_perk = courtship_perk } remove_perk = courtship_perk }
	if = { limit = { has_perk = promising_prospects_perk } remove_perk = promising_prospects_perk }
	if = { limit = { has_perk = loyalty_and_respect_perk } remove_perk = loyalty_and_respect_perk }
	if = { limit = { has_perk = chivalric_dominance_perk } remove_perk = chivalric_dominance_perk }
	if = { limit = { has_perk = never_back_down_perk } remove_perk = never_back_down_perk }
	if = { limit = { has_perk = kingsguard_perk } remove_perk = kingsguard_perk }
	if = { limit = { has_perk = peacemaker_perk } remove_perk = peacemaker_perk }
	if = { limit = { has_perk = gallant_perk } remove_perk = gallant_perk }
	if = { limit = { has_perk = golden_obligations_perk } remove_perk = golden_obligations_perk }
	if = { limit = { has_perk = heregeld_perk } remove_perk = heregeld_perk }
	if = { limit = { has_perk = detailed_ledgers_perk } remove_perk = detailed_ledgers_perk }
	if = { limit = { has_perk = war_profiteer_perk } remove_perk = war_profiteer_perk }
	if = { limit = { has_perk = fearful_troops_perk } remove_perk = fearful_troops_perk }
	if = { limit = { has_perk = it_is_my_domain_perk } remove_perk = it_is_my_domain_perk }
	if = { limit = { has_perk = golden_aplomb_perk } remove_perk = golden_aplomb_perk }
	if = { limit = { has_perk = at_any_cost_perk } remove_perk = at_any_cost_perk }
	if = { limit = { has_perk = avaricious_perk } remove_perk = avaricious_perk }
	if = { limit = { has_perk = tax_man_perk } remove_perk = tax_man_perk }
	if = { limit = { has_perk = defensive_measures_perk } remove_perk = defensive_measures_perk }
	if = { limit = { has_perk = organized_muster_rolls_perk } remove_perk = organized_muster_rolls_perk }
	if = { limit = { has_perk = cutting_corners_perk } remove_perk = cutting_corners_perk }
	if = { limit = { has_perk = professional_workforce_perk } remove_perk = professional_workforce_perk }
	if = { limit = { has_perk = centralization_perk } remove_perk = centralization_perk }
	if = { limit = { has_perk = popular_figurehead_perk } remove_perk = popular_figurehead_perk }
	if = { limit = { has_perk = divided_attention_perk } remove_perk = divided_attention_perk }
	if = { limit = { has_perk = architect_perk } remove_perk = architect_perk }
	if = { limit = { has_perk = meritocracy_perk } remove_perk = meritocracy_perk }
	if = { limit = { has_perk = chains_of_loyalty_perk } remove_perk = chains_of_loyalty_perk }
	if = { limit = { has_perk = likable_perk } remove_perk = likable_perk }
	if = { limit = { has_perk = positions_of_power_perk } remove_perk = positions_of_power_perk }
	if = { limit = { has_perk = large_levies_perk } remove_perk = large_levies_perk }
	if = { limit = { has_perk = soon_forgiven_perk } remove_perk = soon_forgiven_perk }
	if = { limit = { has_perk = toe_the_line_perk } remove_perk = toe_the_line_perk }
	if = { limit = { has_perk = honored_to_serve_perk } remove_perk = honored_to_serve_perk }
	if = { limit = { has_perk = administrator_perk } remove_perk = administrator_perk }
	if = { limit = { has_perk = protective_runes_perk } remove_perk = protective_runes_perk }
	if = { limit = { has_perk = witch_familiar_perk } remove_perk = witch_familiar_perk }
	if = { limit = { has_perk = oneiromancy_perk } remove_perk = oneiromancy_perk }
	if = { limit = { has_perk = wisdom_of_nature_perk } remove_perk = wisdom_of_nature_perk }
	if = { limit = { has_perk = love_potions_perk } remove_perk = love_potions_perk }
	if = { limit = { has_perk = mistical_insight_perk } remove_perk = mistical_insight_perk }
	if = { limit = { has_perk = evil_eye_perk } remove_perk = evil_eye_perk }
	if = { limit = { has_perk = magical_senses_perk } remove_perk = magical_senses_perk }
	if = { limit = { has_perk = lifestealer_perk } remove_perk = lifestealer_perk }
	if = { limit = { has_perk = true_witch_perk } remove_perk = true_witch_perk }
	if = { limit = { has_perk = magical_experiments_p1_perk } remove_perk = magical_experiments_p1_perk }
	if = { limit = { has_perk = mage_tower_p2_perk } remove_perk = mage_tower_p2_perk }
	if = { limit = { has_perk = mind_control_p6_perk } remove_perk = mind_control_p6_perk }
	if = { limit = { has_perk = fate_weaver_p10_perk } remove_perk = fate_weaver_p10_perk }
	if = { limit = { has_perk = forbidden_ritual_p7_perk } remove_perk = forbidden_ritual_p7_perk }
	if = { limit = { has_perk = magic_triangulation_p5_perk } remove_perk = magic_triangulation_p5_perk }
	if = { limit = { has_perk = combat_spells_p3_perk } remove_perk = combat_spells_p3_perk }
	if = { limit = { has_perk = healer_p9_perk } remove_perk = healer_p9_perk }
	if = { limit = { has_perk = summoner_p8_perk } remove_perk = summoner_p8_perk }
	if = { limit = { has_perk = mage_p4_perk } remove_perk = mage_p4_perk }
}
transfer_perks_to_recipient_effect = {
	if = { limit = { has_perk = thoughtful_perk } scope:recipient = { add_perk = thoughtful_perk } }
	if = { limit = { has_perk = ducal_conquest_perk } scope:recipient = { add_perk = ducal_conquest_perk } }
	if = { limit = { has_perk = forced_vassalage_perk } scope:recipient = { add_perk = forced_vassalage_perk } }
	if = { limit = { has_perk = adaptive_traditions_perk } scope:recipient = { add_perk = adaptive_traditions_perk } }
	if = { limit = { has_perk = flexible_truces_perk } scope:recipient = { add_perk = flexible_truces_perk } }
	if = { limit = { has_perk = defensive_negotiations_perk } scope:recipient = { add_perk = defensive_negotiations_perk } }
	if = { limit = { has_perk = embassies_perk } scope:recipient = { add_perk = embassies_perk } }
	if = { limit = { has_perk = accomplished_forger_perk } scope:recipient = { add_perk = accomplished_forger_perk } }
	if = { limit = { has_perk = diplomat_perk } scope:recipient = { add_perk = diplomat_perk } }
	if = { limit = { has_perk = benevolent_intent_perk } scope:recipient = { add_perk = benevolent_intent_perk } }
	if = { limit = { has_perk = inspiring_rule_perk } scope:recipient = { add_perk = inspiring_rule_perk } }
	if = { limit = { has_perk = firm_hand_perk } scope:recipient = { add_perk = firm_hand_perk } }
	if = { limit = { has_perk = praetorian_guard_perk } scope:recipient = { add_perk = praetorian_guard_perk } }
	if = { limit = { has_perk = true_ruler_perk } scope:recipient = { add_perk = true_ruler_perk } }
	if = { limit = { has_perk = writing_history_perk } scope:recipient = { add_perk = writing_history_perk } }
	if = { limit = { has_perk = a_life_of_glory_perk } scope:recipient = { add_perk = a_life_of_glory_perk } }
	if = { limit = { has_perk = dignitas_perk } scope:recipient = { add_perk = dignitas_perk } }
	if = { limit = { has_perk = august_perk } scope:recipient = { add_perk = august_perk } }
	if = { limit = { has_perk = befriend_perk } scope:recipient = { add_perk = befriend_perk } }
	if = { limit = { has_perk = confidants_perk } scope:recipient = { add_perk = confidants_perk } }
	if = { limit = { has_perk = flatterer_perk } scope:recipient = { add_perk = flatterer_perk } }
	if = { limit = { has_perk = groomed_to_rule_perk } scope:recipient = { add_perk = groomed_to_rule_perk } }
	if = { limit = { has_perk = familial_familiar_perk } scope:recipient = { add_perk = familial_familiar_perk } }
	if = { limit = { has_perk = thicker_than_water_perk } scope:recipient = { add_perk = thicker_than_water_perk } }
	if = { limit = { has_perk = friendly_counsel_perk } scope:recipient = { add_perk = friendly_counsel_perk } }
	if = { limit = { has_perk = sound_foundations_perk } scope:recipient = { add_perk = sound_foundations_perk } }
	if = { limit = { has_perk = family_man_perk } scope:recipient = { add_perk = family_man_perk } }
	if = { limit = { has_perk = truth_is_relative_perk } scope:recipient = { add_perk = truth_is_relative_perk } }
	if = { limit = { has_perk = digging_for_dirt_perk } scope:recipient = { add_perk = digging_for_dirt_perk } }
	if = { limit = { has_perk = kidnapper_perk } scope:recipient = { add_perk = kidnapper_perk } }
	if = { limit = { has_perk = court_of_shadows_perk } scope:recipient = { add_perk = court_of_shadows_perk } }
	if = { limit = { has_perk = prepared_for_anything_perk } scope:recipient = { add_perk = prepared_for_anything_perk } }
	if = { limit = { has_perk = swift_execution_perk } scope:recipient = { add_perk = swift_execution_perk } }
	if = { limit = { has_perk = a_job_done_right_perk } scope:recipient = { add_perk = a_job_done_right_perk } }
	if = { limit = { has_perk = twice_schemed_perk } scope:recipient = { add_perk = twice_schemed_perk } }
	if = { limit = { has_perk = schemer_perk } scope:recipient = { add_perk = schemer_perk } }
	if = { limit = { has_perk = like_weed_in_a_garden_perk } scope:recipient = { add_perk = like_weed_in_a_garden_perk } }
	if = { limit = { has_perk = unshackled_lust_perk } scope:recipient = { add_perk = unshackled_lust_perk } }
	if = { limit = { has_perk = subtle_desire_perk } scope:recipient = { add_perk = subtle_desire_perk } }
	if = { limit = { has_perk = mortal_adoration_perk } scope:recipient = { add_perk = mortal_adoration_perk } }
	if = { limit = { has_perk = enticing_opportunity_perk } scope:recipient = { add_perk = enticing_opportunity_perk } }
	if = { limit = { has_perk = home_advantage_perk } scope:recipient = { add_perk = home_advantage_perk } }
	if = { limit = { has_perk = graceful_recovery_perk } scope:recipient = { add_perk = graceful_recovery_perk } }
	if = { limit = { has_perk = smooth_operator_perk } scope:recipient = { add_perk = smooth_operator_perk } }
	if = { limit = { has_perk = seducer_perk } scope:recipient = { add_perk = seducer_perk } }
	if = { limit = { has_perk = dark_insights_perk } scope:recipient = { add_perk = dark_insights_perk } }
	if = { limit = { has_perk = divine_retribution_perk } scope:recipient = { add_perk = divine_retribution_perk } }
	if = { limit = { has_perk = dreadful_perk } scope:recipient = { add_perk = dreadful_perk } }
	if = { limit = { has_perk = thriving_in_chaos_perk } scope:recipient = { add_perk = thriving_in_chaos_perk } }
	if = { limit = { has_perk = malice_implicit_perk } scope:recipient = { add_perk = malice_implicit_perk } }
	if = { limit = { has_perk = fear_tax_perk } scope:recipient = { add_perk = fear_tax_perk } }
	if = { limit = { has_perk = forever_infamous_perk } scope:recipient = { add_perk = forever_infamous_perk } }
	if = { limit = { has_perk = prison_feudal_complex_perk } scope:recipient = { add_perk = prison_feudal_complex_perk } }
	if = { limit = { has_perk = torturer_perk } scope:recipient = { add_perk = torturer_perk } }
	if = { limit = { has_perk = anatomical_studies_perk } scope:recipient = { add_perk = anatomical_studies_perk } }
	if = { limit = { has_perk = carefree_perk } scope:recipient = { add_perk = carefree_perk } }
	if = { limit = { has_perk = mental_resilience_perk } scope:recipient = { add_perk = mental_resilience_perk } }
	if = { limit = { has_perk = restraint_perk } scope:recipient = { add_perk = restraint_perk } }
	if = { limit = { has_perk = know_thyself_perk } scope:recipient = { add_perk = know_thyself_perk } }
	if = { limit = { has_perk = wash_your_hands_perk } scope:recipient = { add_perk = wash_your_hands_perk } }
	if = { limit = { has_perk = iron_constitution_perk } scope:recipient = { add_perk = iron_constitution_perk } }
	if = { limit = { has_perk = healthy_perk } scope:recipient = { add_perk = healthy_perk } }
	if = { limit = { has_perk = whole_of_body_perk } scope:recipient = { add_perk = whole_of_body_perk } }
	if = { limit = { has_perk = pedagogy_perk } scope:recipient = { add_perk = pedagogy_perk } }
	if = { limit = { has_perk = open_minded_perk } scope:recipient = { add_perk = open_minded_perk } }
	if = { limit = { has_perk = apostate_perk } scope:recipient = { add_perk = apostate_perk } }
	if = { limit = { has_perk = scientific_perk } scope:recipient = { add_perk = scientific_perk } }
	if = { limit = { has_perk = planned_cultivation_perk } scope:recipient = { add_perk = planned_cultivation_perk } }
	if = { limit = { has_perk = scholarly_circles_perk } scope:recipient = { add_perk = scholarly_circles_perk } }
	if = { limit = { has_perk = learn_on_the_job_perk } scope:recipient = { add_perk = learn_on_the_job_perk } }
	if = { limit = { has_perk = sanctioned_loopholes_perk } scope:recipient = { add_perk = sanctioned_loopholes_perk } }
	if = { limit = { has_perk = scholar_perk } scope:recipient = { add_perk = scholar_perk } }
	if = { limit = { has_perk = faithful_perk } scope:recipient = { add_perk = faithful_perk } }
	if = { limit = { has_perk = zealous_proselytizer_perk } scope:recipient = { add_perk = zealous_proselytizer_perk } }
	if = { limit = { has_perk = religious_icon_perk } scope:recipient = { add_perk = religious_icon_perk } }
	if = { limit = { has_perk = prophet_perk } scope:recipient = { add_perk = prophet_perk } }
	if = { limit = { has_perk = clerical_justifications_perk } scope:recipient = { add_perk = clerical_justifications_perk } }
	if = { limit = { has_perk = church_and_state_perk } scope:recipient = { add_perk = church_and_state_perk } }
	if = { limit = { has_perk = radiant_perk } scope:recipient = { add_perk = radiant_perk } }
	if = { limit = { has_perk = defender_of_the_faith_perk } scope:recipient = { add_perk = defender_of_the_faith_perk } }
	if = { limit = { has_perk = theologian_perk } scope:recipient = { add_perk = theologian_perk } }
	if = { limit = { has_perk = bellum_justum_perk } scope:recipient = { add_perk = bellum_justum_perk } }
	if = { limit = { has_perk = parthian_tactics_perk } scope:recipient = { add_perk = parthian_tactics_perk } }
	if = { limit = { has_perk = envelopment_perk } scope:recipient = { add_perk = envelopment_perk } }
	if = { limit = { has_perk = organized_retreat_perk } scope:recipient = { add_perk = organized_retreat_perk } }
	if = { limit = { has_perk = hit_and_run_perk } scope:recipient = { add_perk = hit_and_run_perk } }
	if = { limit = { has_perk = engineered_for_destruction_perk } scope:recipient = { add_perk = engineered_for_destruction_perk } }
	if = { limit = { has_perk = living_off_the_land_perk } scope:recipient = { add_perk = living_off_the_land_perk } }
	if = { limit = { has_perk = sappers_perk } scope:recipient = { add_perk = sappers_perk } }
	if = { limit = { has_perk = strategist_perk } scope:recipient = { add_perk = strategist_perk } }
	if = { limit = { has_perk = serve_the_crown_perk } scope:recipient = { add_perk = serve_the_crown_perk } }
	if = { limit = { has_perk = a_mans_home_perk } scope:recipient = { add_perk = a_mans_home_perk } }
	if = { limit = { has_perk = enduring_hardships_perk } scope:recipient = { add_perk = enduring_hardships_perk } }
	if = { limit = { has_perk = prepared_conscription_perk } scope:recipient = { add_perk = prepared_conscription_perk } }
	if = { limit = { has_perk = strict_organization_perk } scope:recipient = { add_perk = strict_organization_perk } }
	if = { limit = { has_perk = hard_rule_perk } scope:recipient = { add_perk = hard_rule_perk } }
	if = { limit = { has_perk = soldiers_of_lesser_fortune_perk } scope:recipient = { add_perk = soldiers_of_lesser_fortune_perk } }
	if = { limit = { has_perk = absolute_control_perk } scope:recipient = { add_perk = absolute_control_perk } }
	if = { limit = { has_perk = overseer_perk } scope:recipient = { add_perk = overseer_perk } }
	if = { limit = { has_perk = stalwart_leader_perk } scope:recipient = { add_perk = stalwart_leader_perk } }
	if = { limit = { has_perk = courtship_perk } scope:recipient = { add_perk = courtship_perk } }
	if = { limit = { has_perk = promising_prospects_perk } scope:recipient = { add_perk = promising_prospects_perk } }
	if = { limit = { has_perk = loyalty_and_respect_perk } scope:recipient = { add_perk = loyalty_and_respect_perk } }
	if = { limit = { has_perk = chivalric_dominance_perk } scope:recipient = { add_perk = chivalric_dominance_perk } }
	if = { limit = { has_perk = never_back_down_perk } scope:recipient = { add_perk = never_back_down_perk } }
	if = { limit = { has_perk = kingsguard_perk } scope:recipient = { add_perk = kingsguard_perk } }
	if = { limit = { has_perk = peacemaker_perk } scope:recipient = { add_perk = peacemaker_perk } }
	if = { limit = { has_perk = gallant_perk } scope:recipient = { add_perk = gallant_perk } }
	if = { limit = { has_perk = golden_obligations_perk } scope:recipient = { add_perk = golden_obligations_perk } }
	if = { limit = { has_perk = heregeld_perk } scope:recipient = { add_perk = heregeld_perk } }
	if = { limit = { has_perk = detailed_ledgers_perk } scope:recipient = { add_perk = detailed_ledgers_perk } }
	if = { limit = { has_perk = war_profiteer_perk } scope:recipient = { add_perk = war_profiteer_perk } }
	if = { limit = { has_perk = fearful_troops_perk } scope:recipient = { add_perk = fearful_troops_perk } }
	if = { limit = { has_perk = it_is_my_domain_perk } scope:recipient = { add_perk = it_is_my_domain_perk } }
	if = { limit = { has_perk = golden_aplomb_perk } scope:recipient = { add_perk = golden_aplomb_perk } }
	if = { limit = { has_perk = at_any_cost_perk } scope:recipient = { add_perk = at_any_cost_perk } }
	if = { limit = { has_perk = avaricious_perk } scope:recipient = { add_perk = avaricious_perk } }
	if = { limit = { has_perk = tax_man_perk } scope:recipient = { add_perk = tax_man_perk } }
	if = { limit = { has_perk = defensive_measures_perk } scope:recipient = { add_perk = defensive_measures_perk } }
	if = { limit = { has_perk = organized_muster_rolls_perk } scope:recipient = { add_perk = organized_muster_rolls_perk } }
	if = { limit = { has_perk = cutting_corners_perk } scope:recipient = { add_perk = cutting_corners_perk } }
	if = { limit = { has_perk = professional_workforce_perk } scope:recipient = { add_perk = professional_workforce_perk } }
	if = { limit = { has_perk = centralization_perk } scope:recipient = { add_perk = centralization_perk } }
	if = { limit = { has_perk = popular_figurehead_perk } scope:recipient = { add_perk = popular_figurehead_perk } }
	if = { limit = { has_perk = divided_attention_perk } scope:recipient = { add_perk = divided_attention_perk } }
	if = { limit = { has_perk = architect_perk } scope:recipient = { add_perk = architect_perk } }
	if = { limit = { has_perk = meritocracy_perk } scope:recipient = { add_perk = meritocracy_perk } }
	if = { limit = { has_perk = chains_of_loyalty_perk } scope:recipient = { add_perk = chains_of_loyalty_perk } }
	if = { limit = { has_perk = likable_perk } scope:recipient = { add_perk = likable_perk } }
	if = { limit = { has_perk = positions_of_power_perk } scope:recipient = { add_perk = positions_of_power_perk } }
	if = { limit = { has_perk = large_levies_perk } scope:recipient = { add_perk = large_levies_perk } }
	if = { limit = { has_perk = soon_forgiven_perk } scope:recipient = { add_perk = soon_forgiven_perk } }
	if = { limit = { has_perk = toe_the_line_perk } scope:recipient = { add_perk = toe_the_line_perk } }
	if = { limit = { has_perk = honored_to_serve_perk } scope:recipient = { add_perk = honored_to_serve_perk } }
	if = { limit = { has_perk = administrator_perk } scope:recipient = { add_perk = administrator_perk } }
	if = { limit = { has_perk = true_witch_perk } scope:recipient = { add_perk = true_witch_perk } }
	if = { limit = { has_perk = protective_runes_perk } scope:recipient = { add_perk = protective_runes_perk } }
	if = { limit = { has_perk = witch_familiar_perk } scope:recipient = { add_perk = witch_familiar_perk } }
	if = { limit = { has_perk = oneiromancy_perk } scope:recipient = { add_perk = oneiromancy_perk } }
	if = { limit = { has_perk = wisdom_of_nature_perk } scope:recipient = { add_perk = wisdom_of_nature_perk } }
	if = { limit = { has_perk = love_potions_perk } scope:recipient = { add_perk = love_potions_perk } }
	if = { limit = { has_perk = mistical_insight_perk } scope:recipient = { add_perk = mistical_insight_perk } }
	if = { limit = { has_perk = evil_eye_perk } scope:recipient = { add_perk = evil_eye_perk } }
	if = { limit = { has_perk = magical_senses_perk } scope:recipient = { add_perk = magical_senses_perk } }
	if = { limit = { has_perk = lifestealer_perk } scope:recipient = { add_perk = lifestealer_perk } }
	if = { limit = { has_perk = mage_p4_perk } scope:recipient = { add_perk = mage_p4_perk } }
	if = { limit = { has_perk = magical_experiments_p1_perk } scope:recipient = { add_perk = magical_experiments_p1_perk } }
	if = { limit = { has_perk = mage_tower_p2_perk } scope:recipient = { add_perk = mage_tower_p2_perk } }
	if = { limit = { has_perk = mind_control_p6_perk } scope:recipient = { add_perk = mind_control_p6_perk } }
	if = { limit = { has_perk = fate_weaver_p10_perk } scope:recipient = { add_perk = fate_weaver_p10_perk } }
	if = { limit = { has_perk = forbidden_ritual_p7_perk } scope:recipient = { add_perk = forbidden_ritual_p7_perk } }
	if = { limit = { has_perk = magic_triangulation_p5_perk } scope:recipient = { add_perk = magic_triangulation_p5_perk } }
	if = { limit = { has_perk = combat_spells_p3_perk } scope:recipient = { add_perk = combat_spells_p3_perk } }
	if = { limit = { has_perk = healer_p9_perk } scope:recipient = { add_perk = healer_p9_perk } }
	if = { limit = { has_perk = summoner_p8_perk } scope:recipient = { add_perk = summoner_p8_perk } }
	
}
transfer_mage_xp_effect = {
	scope:recipient = {
		add_trait_xp = {
			trait = archmage
			track = secret_knowledge
			value = 100
		}
	}
	if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = demonology
				value > 99
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = demonology
				value = 100
			}
		}
	}
	else_if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = demonology
				value >= 80
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = demonology
				value = 80
			}
		}
	}
	else_if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = demonology
				value >= 60
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = demonology
				value = 60
			}
		}
	}
	else_if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = demonology
				value >= 40
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = demonology
				value = 40
			}
		}
	}
	else_if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = demonology
				value >= 20
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = demonology
				value = 20
			}
		}
	}
	if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = combat_magic
				value > 99
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = combat_magic
				value = 100
			}
		}
	}
	else_if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = combat_magic
				value >= 80
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = combat_magic
				value = 80
			}
		}
	}
	else_if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = combat_magic
				value >= 60
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = combat_magic
				value = 60
			}
		}
	}
	else_if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = combat_magic
				value >= 40
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = combat_magic
				value = 40
			}
		}
	}
	else_if = {
		limit = {
			has_trait_xp = {
				trait = archmage
				track = combat_magic
				value >= 20
			}
		}
		scope:recipient = {
			add_trait_xp = {
				trait = archmage
				track = combat_magic
				value = 20
			}
		}
	}
}
clear_valid_magic_flags_effect = {
	if = { limit = { has_character_flag = me_soul_project_done } remove_character_flag = me_soul_project_done }
	if = { limit = { has_character_flag = me_soul_project } remove_character_flag = me_soul_project }
	if = { limit = { has_character_flag = me_sing_project } remove_character_flag = me_sing_project }
	if = { limit = { has_character_flag = me_castle_project } remove_character_flag = me_castle_project }
	if = { limit = { has_character_flag = me_ascendency_project } remove_character_flag = me_ascendency_project }
	if = { limit = { has_character_flag = me_immortality_project } remove_character_flag = me_immortality_project }
	if = { limit = { has_character_flag = me_death_project } remove_character_flag = me_death_project }
	if = { limit = { has_character_flag = me_golem_project } remove_character_flag = me_golem_project }
	if = { limit = { has_character_modifier = mind_reader_modifier } remove_character_modifier = mind_reader_modifier }
	if = { limit = { has_character_flag = mana_siphon_flag } remove_character_flag = mana_siphon_flag }
	if = { limit = { has_character_flag = firestorm_spell_flag } remove_character_flag = firestorm_spell_flag }
	if = { limit = { has_character_flag = hipercognition_flag } remove_character_flag = hipercognition_flag }
	if = { limit = { has_character_flag = plague_spell_flag } remove_character_flag = plague_spell_flag }
	if = { limit = { has_character_flag = shadowstep_flag } remove_character_flag = shadowstep_flag }
	if = { limit = { has_character_flag = bless_land_flag } remove_character_flag = bless_land_flag }
	if = { limit = { has_character_flag = death_wish } remove_character_flag = death_wish }
	if = { limit = { has_character_flag = banish_spell_flag } remove_character_flag = banish_spell_flag }
	if = { limit = { has_character_flag = healing_spell_flag } remove_character_flag = healing_spell_flag }
	if = { limit = { has_character_flag = better_domination_spell } remove_character_flag = better_domination_spell }
	if = { limit = { has_character_flag = good_one_magic_flag } remove_character_flag = good_one_magic_flag }
	if = { limit = { has_character_flag = sing_end } remove_character_flag = sing_end }
	if = { limit = { has_character_flag = magic_transmutation } remove_character_flag = magic_transmutation }
	if = { limit = { has_character_flag = protection_ritual } remove_character_flag = protection_ritual }
	if = { limit = { has_character_flag = blorg_flag } remove_character_flag = blorg_flag }
	if = { limit = { has_character_modifier = demonic_charm_modifier } remove_character_modifier = demonic_charm_modifier }
	if = { limit = { has_character_modifier = master_psionic_modifier } remove_character_modifier = master_psionic_modifier }
	if = { limit = { has_character_modifier = belial_blessing_modifier } remove_character_modifier = belial_blessing_modifier }
	if = { limit = { has_character_modifier = nyx_blessing_modifier } remove_character_modifier = nyx_blessing_modifier }
	if = { limit = { has_character_modifier = long_life_modifier } remove_character_modifier = long_life_modifier }
	if = { limit = { has_character_modifier = fucked_by_demon_modifier } remove_character_modifier = fucked_by_demon_modifier }
	if = { limit = { has_character_modifier = master_alteration_modifier } remove_character_modifier = master_alteration_modifier }
	if = { limit = { has_character_modifier = master_necromancer_modifier } remove_character_modifier = master_necromancer_modifier }
	if = { limit = { has_character_modifier = master_metamagic_modifier } remove_character_modifier = master_metamagic_modifier }
	if = { limit = { has_character_modifier = contact_other_worlds_modifier } remove_character_modifier = contact_other_worlds_modifier }
	if = { limit = { has_character_modifier = lifestealer_modifier } remove_character_modifier = lifestealer_modifier }
	if = { limit = { has_character_modifier = master_magic_modifier } remove_character_modifier = master_magic_modifier }
	if = { limit = { has_character_flag = skeleton_warriors } remove_character_flag = skeleton_warriors }
}
transfer_valid_magic_flags_effect = {
	if = { limit = { has_character_flag = me_soul_project_done } scope:recipient = { add_character_flag = me_soul_project_done } }
	if = { limit = { has_character_flag = me_soul_project } scope:recipient = { add_character_flag = me_soul_project } }
	if = { limit = { has_character_flag = me_sing_project } scope:recipient = { add_character_flag = me_sing_project } }
	if = { limit = { has_character_flag = me_castle_project } scope:recipient = { add_character_flag = me_castle_project } }
	if = { limit = { has_character_flag = me_ascendency_project } scope:recipient = { add_character_flag = me_ascendency_project } }
	if = { limit = { has_character_flag = me_immortality_project } scope:recipient = { add_character_flag = me_immortality_project } }
	if = { limit = { has_character_flag = me_death_project } scope:recipient = { add_character_flag = me_death_project } }
	if = { limit = { has_character_flag = me_golem_project } scope:recipient = { add_character_flag = me_golem_project } }
	if = { limit = { has_character_modifier = mind_reader_modifier } scope:recipient = { add_character_modifier = mind_reader_modifier } }
	if = { limit = { has_character_flag = mana_siphon_flag } scope:recipient = { add_character_flag = mana_siphon_flag } }
	if = { limit = { has_character_flag = firestorm_spell_flag } scope:recipient = { add_character_flag = firestorm_spell_flag } }
	if = { limit = { has_character_flag = hipercognition_flag } scope:recipient = { add_character_flag = hipercognition_flag } }
	if = { limit = { has_character_flag = plague_spell_flag } scope:recipient = { add_character_flag = plague_spell_flag } }
	if = { limit = { has_character_flag = shadowstep_flag } scope:recipient = { add_character_flag = shadowstep_flag } }
	if = { limit = { has_character_flag = bless_land_flag } scope:recipient = { add_character_flag = bless_land_flag } }
	if = { limit = { has_character_flag = death_wish } scope:recipient = { add_character_flag = death_wish } }
	if = { limit = { has_character_flag = banish_spell_flag } scope:recipient = { add_character_flag = banish_spell_flag } }
	if = { limit = { has_character_flag = healing_spell_flag } scope:recipient = { add_character_flag = healing_spell_flag } }
	if = { limit = { has_character_flag = better_domination_spell } scope:recipient = { add_character_flag = better_domination_spell } }
	if = { limit = { has_character_flag = good_one_magic_flag } scope:recipient = { add_character_flag = good_one_magic_flag } }
	if = { limit = { has_character_flag = sing_end } scope:recipient = { add_character_flag = sing_end } }
	if = { limit = { has_character_flag = magic_transmutation } scope:recipient = { add_character_flag = magic_transmutation } }
	if = { limit = { has_character_flag = protection_ritual } scope:recipient = { add_character_flag = protection_ritual } }
	if = { limit = { has_character_flag = blorg_flag } scope:recipient = { add_character_flag = blorg_flag } }
	if = { limit = { has_character_modifier = demonic_charm_modifier } scope:recipient = { add_character_modifier = demonic_charm_modifier } }
	if = { limit = { has_character_modifier = master_psionic_modifier } scope:recipient = { add_character_modifier = master_psionic_modifier } }
	if = { limit = { has_character_modifier = belial_blessing_modifier } scope:recipient = { add_character_modifier = belial_blessing_modifier } }
	if = { limit = { has_character_modifier = nyx_blessing_modifier } scope:recipient = { add_character_modifier = nyx_blessing_modifier } }
	if = { limit = { has_character_modifier = long_life_modifier } scope:recipient = { add_character_modifier = long_life_modifier } }
	if = { limit = { has_character_modifier = fucked_by_demon_modifier } scope:recipient = { add_character_modifier = fucked_by_demon_modifier } }
	if = { limit = { has_character_modifier = master_alteration_modifier } scope:recipient = { add_character_modifier = master_alteration_modifier } }
	if = { limit = { has_character_modifier = master_necromancer_modifier } scope:recipient = { add_character_modifier = master_necromancer_modifier } }
	if = { limit = { has_character_modifier = master_metamagic_modifier } scope:recipient = { add_character_modifier = master_metamagic_modifier } }
	if = { limit = { has_character_modifier = contact_other_worlds_modifier } scope:recipient = { add_character_modifier = contact_other_worlds_modifier } }
	if = { limit = { has_character_modifier = lifestealer_modifier } scope:recipient = { add_character_modifier = lifestealer_modifier } }
	if = { limit = { has_character_modifier = master_magic_modifier } scope:recipient = { add_character_modifier = master_magic_modifier } }
	if = { limit = { has_character_flag = skeleton_warriors } scope:recipient = { add_character_flag = skeleton_warriors } }
	if = { limit = { has_character_flag = nyx_no_more_flag } scope:recipient = { add_character_flag = nyx_no_more_flag } }
	if = { limit = { has_character_flag = uses_additional_knowledge_flag } scope:recipient = { add_character_flag = uses_additional_knowledge_flag } }
	if = {
		limit = {
			exists = dynasty
			dynasty = {
				has_variable = ev1used
			}
		}
		if = {
			limit = {
				scope:recipient = {
					exists = dynasty
					dynasty = {
						NOT = {
							has_variable = ev1used
						}
					}
				}
			}
			scope:recipient = {
				dynasty = {
					set_variable = ev1used
				}
			}
		}
	}
	if = {
		limit = {
			exists = dynasty
			dynasty = {
				has_variable = legion
			}
		}
		if = {
			limit = {
				scope:recipient = {
					exists = dynasty
					dynasty = {
						NOT = {
							has_variable = legion
						}
					}
				}
			}
			scope:recipient = {
				dynasty = {
					set_variable = legion
				}
			}
		}
	}
	if = {
		limit = {
			exists = dynasty
			dynasty = {
				has_variable = legion2
			}
		}
		if = {
			limit = {
				scope:recipient = {
					exists = dynasty
					dynasty = {
						NOT = {
							has_variable = legion2
						}
					}
				}
			}
			scope:recipient = {
				dynasty = {
					set_variable = legion2
				}
			}
		}
	}
}

full_healing_effect = {
					if = { limit = { has_trait = ill }
						remove_trait = ill
					}
					if = { limit = { has_trait = pneumonic }
						remove_trait = pneumonic
					}
					if = { limit = { has_trait = great_pox }
						remove_trait = great_pox
					}
					if = { limit = { has_trait = early_great_pox }
						remove_trait = early_great_pox
					}
					if = { limit = { has_trait = lovers_pox }
						remove_trait = lovers_pox
					}
					if = { limit = { has_trait = leper }
						remove_trait = leper
					}
					if = { limit = { has_trait = wounded_1 }
						remove_trait = wounded_1
					}
					if = { limit = { has_trait = wounded_2 }
						remove_trait = wounded_2
					}
					if = { limit = { has_trait = wounded_3 }
						remove_trait = wounded_3
					}
					if = { limit = { has_trait = maimed }
						remove_trait = maimed
					}
					if = { limit = { has_trait = infirm }
						remove_trait = infirm
					}
					if = { limit = { has_trait = incapable }
						remove_trait = incapable
					}
					if = { limit = { has_trait = gout_ridden }
						remove_trait = gout_ridden
					}
					if = { limit = { has_trait = consumption }
						remove_trait = consumption
					}
					if = { limit = { has_trait = cancer }
						remove_trait = cancer
					}
					if = { limit = { has_trait = typhus }
						remove_trait = typhus
					}
					if = { limit = { has_trait = bubonic_plague }
						remove_trait = bubonic_plague
					}
					if = { limit = { has_trait = smallpox }
						remove_trait = smallpox
					}
					if = { limit = { has_trait = sickly }
						remove_trait = sickly
					}
					if = { limit = { has_trait = blind }
						remove_trait = blind
					}
					if = {	limit = {	has_trait = disfigured	}
						remove_trait = disfigured
					}
					if = {	limit = {	has_character_modifier = chronic_headaches_modifier	}
						remove_character_modifier = chronic_headaches_modifier
					}
					if = {	limit = {	has_character_modifier = infected_wound_modifier	}
						remove_character_modifier = infected_wound_modifier
					}
					if = {	limit = {	has_character_modifier = gangrene_modifier	}
						remove_character_modifier = gangrene_modifier
					}
					if = {	limit = {	has_trait = measles	}
						remove_trait = measles
					}
					if = {	limit = {	has_trait = dysentery	}
						remove_trait = dysentery
					}
					if = {	limit = {	has_trait = ergotism	}
						remove_trait = ergotism
					}
}